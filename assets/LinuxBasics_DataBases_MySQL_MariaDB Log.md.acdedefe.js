import{_ as s,o as a,c as n,a as l}from"./app.1e6146c3.js";const d=JSON.parse('{"title":"MariaDB Log","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u67E5\u8BE2\u65E5\u5FD7","slug":"\u67E5\u8BE2\u65E5\u5FD7"},{"level":3,"title":"\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539","slug":"\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539"},{"level":2,"title":"\u6162\u67E5\u8BE2\u65E5\u5FD7","slug":"\u6162\u67E5\u8BE2\u65E5\u5FD7"},{"level":3,"title":"\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539","slug":"\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539"},{"level":3,"title":"\u4F7F\u7528 mysqldumpslow \u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7","slug":"\u4F7F\u7528-mysqldumpslow-\u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7"},{"level":2,"title":"\u9519\u8BEF\u65E5\u5FD7","slug":"\u9519\u8BEF\u65E5\u5FD7"},{"level":2,"title":"\u4E8C\u8FDB\u5236\u65E5\u5FD7","slug":"\u4E8C\u8FDB\u5236\u65E5\u5FD7"},{"level":3,"title":"\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F","slug":"\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F"},{"level":3,"title":"\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539","slug":"\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539"},{"level":3,"title":"\u5E38\u7528 binlog \u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4","slug":"\u5E38\u7528-binlog-\u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4"},{"level":3,"title":"\u67E5\u770B binlog \u65E5\u5FD7\u5185\u5BB9","slug":"\u67E5\u770B-binlog-\u65E5\u5FD7\u5185\u5BB9"},{"level":3,"title":"\u5220\u9664 binlog \u65E5\u5FD7","slug":"\u5220\u9664-binlog-\u65E5\u5FD7"},{"level":2,"title":"\u53C2\u8003\u94FE\u63A5","slug":"\u53C2\u8003\u94FE\u63A5"}],"relativePath":"LinuxBasics/DataBases/MySQL/MariaDB Log.md","lastUpdated":1657272051000}'),p={name:"LinuxBasics/DataBases/MySQL/MariaDB Log.md"},o=l(`<h1 id="mariadb-log" tabindex="-1">MariaDB Log <a class="header-anchor" href="#mariadb-log" aria-hidden="true">#</a></h1><nav class="table-of-contents"><ul><li><a href="#\u67E5\u8BE2\u65E5\u5FD7">\u67E5\u8BE2\u65E5\u5FD7</a><ul><li><a href="#\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539">\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539</a></li></ul></li><li><a href="#\u6162\u67E5\u8BE2\u65E5\u5FD7">\u6162\u67E5\u8BE2\u65E5\u5FD7</a><ul><li><a href="#\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539">\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539</a></li><li><a href="#\u4F7F\u7528-mysqldumpslow-\u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7">\u4F7F\u7528 mysqldumpslow \u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7</a></li></ul></li><li><a href="#\u9519\u8BEF\u65E5\u5FD7">\u9519\u8BEF\u65E5\u5FD7</a></li><li><a href="#\u4E8C\u8FDB\u5236\u65E5\u5FD7">\u4E8C\u8FDB\u5236\u65E5\u5FD7</a><ul><li><a href="#\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F">\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F</a><ul></ul></li><li><a href="#\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539">\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539</a></li><li><a href="#\u5E38\u7528-binlog-\u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4">\u5E38\u7528 binlog \u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4</a></li><li><a href="#\u67E5\u770B-binlog-\u65E5\u5FD7\u5185\u5BB9">\u67E5\u770B binlog \u65E5\u5FD7\u5185\u5BB9</a><ul></ul></li><li><a href="#\u5220\u9664-binlog-\u65E5\u5FD7">\u5220\u9664 binlog \u65E5\u5FD7</a><ul></ul></li></ul></li><li><a href="#\u53C2\u8003\u94FE\u63A5">\u53C2\u8003\u94FE\u63A5</a></li></ul></nav><h2 id="\u67E5\u8BE2\u65E5\u5FD7" tabindex="-1">\u67E5\u8BE2\u65E5\u5FD7 <a class="header-anchor" href="#\u67E5\u8BE2\u65E5\u5FD7" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2\u65E5\u5FD7\u4E5F\u79F0\u4E3A <em>general log\uFF08\u901A\u7528\u65E5\u5FD7\uFF09</em>\uFF0C<strong>\u67E5\u8BE2\u65E5\u5FD7\u8BB0\u5F55\u4E86\u6570\u636E\u5E93\u6267\u884C\u7684\u6240\u6709\u547D\u4EE4</strong>\uFF0C\u7531\u4E8E\u6570\u636E\u5E93\u64CD\u4F5C\u547D\u4EE4\u6709\u53EF\u80FD\u975E\u5E38\u591A\u800C\u4E14\u6267\u884C\u6BD4\u8F83\u9891\u7E41\uFF0C\u6240\u4EE5\u5F53\u5F00\u542F\u4E86\u67E5\u8BE2\u65E5\u5FD7\u4EE5\u540E\uFF0C\u6570\u636E\u5E93\u53EF\u80FD\u9700\u8981\u4E0D\u505C\u7684\u5199\u5165\u67E5\u8BE2\u65E5\u5FD7\uFF0C\u8FD9\u6837\u4F1A\u589E\u5927\u670D\u52A1\u5668\u7684IO\u538B\u529B\uFF0C\u589E\u52A0\u5F88\u591A\u7CFB\u7EDF\u5F00\u9500\uFF0C\u6240\u4EE5\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Cmysql\u7684\u67E5\u8BE2\u65E5\u5FD7\u662F\u6CA1\u6709\u5F00\u542F\u7684\u3002</p><p>\u5F00\u542F\u67E5\u8BE2\u65E5\u5FD7\u53EF\u4EE5\u5E2E\u52A9\u5206\u6790\u54EA\u4E9B_\u8BED\u53E5\u6267\u884C\u9891\u7387_\uFF0C\u4EE5\u53CA\u5BF9\u5E94\u8BED\u53E5\u7684\u6570\u636E\u662F\u5426\u80FD\u591F\u88AB\u7F13\u5B58\uFF0C\u6240\u4EE5\uFF0C\u53EF\u4EE5\u6839\u636E\u5B9E\u9645\u60C5\u51B5\u51B3\u5B9A\u662F\u5426\u5F00\u542F\u67E5\u8BE2\u65E5\u5FD7\u3002</p><p>\u5F00\u542F\u67E5\u8BE2\u65E5\u5FD7\u540E\uFF0C\u6709\u4E09\u79CD\u65B9\u5F0F\u6765\u5B58\u653E\u65E5\u5FD7\uFF1A</p><ol><li>\u5B58\u653E\u4E8E\u6307\u5B9A\u7684\u65E5\u5FD7\u6587\u4EF6\u4E2D\u3002</li><li>\u5B58\u653E\u4E8Emysql.general_log\u8868\u4E2D\u3002</li><li>\u540C\u65F6\u5B58\u653E\u5728\u6307\u5B9A\u7684\u65E5\u5FD7\u6587\u4EF6\u4E0Emysql\u5E93\u7684general_log\u8868\u4E2D\u3002</li></ol><p>\u67E5\u770B\u67E5\u8BE2\u65E5\u5FD7\u7684\u76F8\u5173\u53C2\u6570\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show variables </span><span style="color:#4D9375;">where</span><span style="color:#DBD7CA;"> variable_name </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;%general_log%&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">or</span><span style="color:#DBD7CA;"> variable_name</span><span style="color:#CB7676;">=</span><span style="color:#C98A7D;">&quot;log_output&quot;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Variable_name    | </span><span style="color:#4D9375;">Value</span><span style="color:#DBD7CA;">    |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| general_log      | </span><span style="color:#4D9375;">OFF</span><span style="color:#DBD7CA;">      |</span></span>
<span class="line"><span style="color:#DBD7CA;">| general_log_file | </span><span style="color:#D4976C;">Dave</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">log</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#DBD7CA;">| log_output       | </span><span style="color:#4D9375;">FILE</span><span style="color:#DBD7CA;">     |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+----------+</span></span>
<span class="line"><span style="color:#6394BF;">3</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">rows</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">01</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show variables </span><span style="color:#1C6B48;">where</span><span style="color:#393A34;"> variable_name </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;%general_log%&quot;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">or</span><span style="color:#393A34;"> variable_name</span><span style="color:#AB5959;">=</span><span style="color:#B56959;">&quot;log_output&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+----------+</span></span>
<span class="line"><span style="color:#393A34;">| Variable_name    | </span><span style="color:#1C6B48;">Value</span><span style="color:#393A34;">    |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+----------+</span></span>
<span class="line"><span style="color:#393A34;">| general_log      | </span><span style="color:#1C6B48;">OFF</span><span style="color:#393A34;">      |</span></span>
<span class="line"><span style="color:#393A34;">| general_log_file | </span><span style="color:#A65E2B;">Dave</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">log</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#393A34;">| log_output       | </span><span style="color:#1C6B48;">FILE</span><span style="color:#393A34;">     |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+----------+</span></span>
<span class="line"><span style="color:#296AA3;">3</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">rows</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">01</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span></code></pre></div><p><code>log_output:</code> \u8868\u793A\u67E5\u8BE2\u65E5\u5FD7\u5F00\u542F\u540E\uFF0C\u4EE5\u54EA\u79CD\u65B9\u5F0F\u5B58\u653E\uFF0Clog_output\u53EF\u4EE5\u8BBE\u7F6E\u4E3A4\u79CD\u503C\uFF0C\u201DFILE\u201D\u3001\u201DTABLE\u201D\u3001\u201DFILE,TABLE\u201D\u3001\u201DNONE\u201D\u3002</p><p><code>general_log_file:</code>\u8868\u793A\u5F53log_output\u7684\u503C\u8BBE\u7F6E\u4E3A\u201DFILE\u201D\u6216\u8005\u201DFILE,TABLE\u201D\u65F6\uFF0C\u5C06\u67E5\u8BE2\u65E5\u5FD7\u5B58\u653E\u4E8E\u54EA\u4E2A\u65E5\u5FD7\u6587\u4EF6\u4E2D\uFF0C\u5373\u901A\u8FC7\u6B64\u53C2\u6570\u6307\u5B9A\u67E5\u8BE2\u65E5\u5FD7\u7684\u6587\u4EF6\uFF0C\u9ED8\u8BA4\u6587\u4EF6\u540D\u662F<code>host_name.log</code>\uFF0C\u800C\u4E14\u4F7F\u7528\u4E86\u76F8\u5BF9\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u4F4D\u7F6E\u4E3ADATADIR\u53D8\u91CF\u6240\u5BF9\u5E94\u7684\u76EE\u5F55\u4F4D\u7F6E\u3002</p><h3 id="\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539" tabindex="-1">\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539 <a class="header-anchor" href="#\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539" aria-hidden="true">#</a></h3><p>\u53EF\u4EE5\u76F4\u63A5\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6<code>/etc/my.cnf</code>\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">general_log = {ON</span><span style="color:#CB7676;">|</span><span style="color:#DBD7CA;">OFF} </span></span>
<span class="line"><span style="color:#DBD7CA;">general_log_file = /data/mysql/mysql.log </span></span>
<span class="line"><span style="color:#DBD7CA;">log_output = {TABLE</span><span style="color:#CB7676;">|</span><span style="color:#DBD7CA;">FILE</span><span style="color:#CB7676;">|</span><span style="color:#DBD7CA;">NONE}</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">general_log = {ON</span><span style="color:#AB5959;">|</span><span style="color:#393A34;">OFF} </span></span>
<span class="line"><span style="color:#393A34;">general_log_file = /data/mysql/mysql.log </span></span>
<span class="line"><span style="color:#393A34;">log_output = {TABLE</span><span style="color:#AB5959;">|</span><span style="color:#393A34;">FILE</span><span style="color:#AB5959;">|</span><span style="color:#393A34;">NONE}</span></span>
<span class="line"></span></code></pre></div><p>\u4E34\u65F6\u4FEE\u6539\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\uFF08\u91CD\u542F\u670D\u52A1\u540E\u5931\u6548\uFF09\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> general_log</span><span style="color:#CB7676;">=</span><span style="color:#4D9375;">on</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> log_output</span><span style="color:#CB7676;">=</span><span style="color:#C98A7D;">&#39;file,table&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> general_log</span><span style="color:#AB5959;">=</span><span style="color:#1C6B48;">on</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> log_output</span><span style="color:#AB5959;">=</span><span style="color:#B56959;">&#39;file,table&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"></span></code></pre></div><p>\u6D4B\u8BD5\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">create</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">database</span><span style="color:#DBD7CA;"> test;</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">create</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">table</span><span style="color:#DBD7CA;"> </span><span style="color:#D4976C;">test</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">test_table</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;"># </span><span style="color:#D4976C;">\u67E5\u8BE2mysql</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">general_log\u8868</span><span style="color:#DBD7CA;">\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">select</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#D4976C;">mysql</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">general_log</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;"># \u4E5F\u53EF\u4EE5\u8FDB\u5165\u6587\u4EF6\u76F4\u63A5\u67E5\u770B</span></span>
<span class="line"><span style="color:#DBD7CA;">cat </span><span style="color:#CB7676;">/</span><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">/</span><span style="color:#4D9375;">data</span><span style="color:#CB7676;">/</span><span style="color:#D4976C;">Dave</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">log</span><span style="color:#DBD7CA;"> |more</span></span>
<span class="line"><span style="color:#DBD7CA;">...</span></span>
<span class="line"><span style="color:#6394BF;">180131</span><span style="color:#DBD7CA;">  </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">:</span><span style="color:#6394BF;">16</span><span style="color:#DBD7CA;">:</span><span style="color:#6394BF;">45</span><span style="color:#DBD7CA;">       </span><span style="color:#6394BF;">11</span><span style="color:#DBD7CA;"> Query    </span><span style="color:#4D9375;">create</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">database</span><span style="color:#DBD7CA;"> test;</span></span>
<span class="line"><span style="color:#6394BF;">180131</span><span style="color:#DBD7CA;">  </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">:</span><span style="color:#6394BF;">16</span><span style="color:#DBD7CA;">:</span><span style="color:#6394BF;">52</span><span style="color:#DBD7CA;">       </span><span style="color:#6394BF;">11</span><span style="color:#DBD7CA;"> Query    </span><span style="color:#4D9375;">create</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">table</span><span style="color:#DBD7CA;"> </span><span style="color:#D4976C;">test</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">test_table</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">...</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">create</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">database</span><span style="color:#393A34;"> test;</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">create</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">table</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">test</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">test_table</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;"># </span><span style="color:#A65E2B;">\u67E5\u8BE2mysql</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">general_log\u8868</span><span style="color:#393A34;">\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">select</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">*</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">mysql</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">general_log</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"># \u4E5F\u53EF\u4EE5\u8FDB\u5165\u6587\u4EF6\u76F4\u63A5\u67E5\u770B</span></span>
<span class="line"><span style="color:#393A34;">cat </span><span style="color:#AB5959;">/</span><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">/</span><span style="color:#1C6B48;">data</span><span style="color:#AB5959;">/</span><span style="color:#A65E2B;">Dave</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">log</span><span style="color:#393A34;"> |more</span></span>
<span class="line"><span style="color:#393A34;">...</span></span>
<span class="line"><span style="color:#296AA3;">180131</span><span style="color:#393A34;">  </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">:</span><span style="color:#296AA3;">16</span><span style="color:#393A34;">:</span><span style="color:#296AA3;">45</span><span style="color:#393A34;">       </span><span style="color:#296AA3;">11</span><span style="color:#393A34;"> Query    </span><span style="color:#1C6B48;">create</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">database</span><span style="color:#393A34;"> test;</span></span>
<span class="line"><span style="color:#296AA3;">180131</span><span style="color:#393A34;">  </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">:</span><span style="color:#296AA3;">16</span><span style="color:#393A34;">:</span><span style="color:#296AA3;">52</span><span style="color:#393A34;">       </span><span style="color:#296AA3;">11</span><span style="color:#393A34;"> Query    </span><span style="color:#1C6B48;">create</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">table</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">test</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">test_table</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">...</span></span>
<span class="line"></span></code></pre></div><h2 id="\u6162\u67E5\u8BE2\u65E5\u5FD7" tabindex="-1">\u6162\u67E5\u8BE2\u65E5\u5FD7 <a class="header-anchor" href="#\u6162\u67E5\u8BE2\u65E5\u5FD7" aria-hidden="true">#</a></h2><p>MariaDB\u7684\u6162\u67E5\u8BE2\u65E5\u5FD7<strong>\u7528\u6765\u8BB0\u5F55\u6570\u636E\u5E93\u4E2D\u54CD\u5E94\u65F6\u95F4\u8D85\u8FC7\u9600\u503C\u7684\u8BED\u53E5</strong>\uFF0C\u5177\u4F53\u6307\u8FD0\u884C\u65F6\u95F4\u8D85\u8FC7<code>long_query_time</code>\u503C\u7684SQL\uFF0C\u4F1A\u88AB\u8BB0\u5F55\u5230\u6162\u67E5\u8BE2\u65E5\u5FD7\u4E2D\u3002<code>long_query_time</code>\u7684\u9ED8\u8BA4\u503C\u4E3A10\uFF0C\u5355\u4F4D\u662F\u79D2\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CMariaDB\u6570\u636E\u5E93\u5E76\u4E0D\u542F\u52A8\u6162\u67E5\u8BE2\u65E5\u5FD7\uFF0C\u5F00\u542F\u6162\u67E5\u8BE2\u65E5\u5FD7\u4F1A\u5E26\u6765\u4E00\u5B9A\u7684\u6027\u80FD\u5F71\u54CD\u3002\u6162\u67E5\u8BE2\u65E5\u5FD7\u652F\u6301\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5199\u5165\u6587\u4EF6\uFF0C\u4E5F\u652F\u6301\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5199\u5165\u6570\u636E\u5E93\u8868\u3002</p><h3 id="\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539" tabindex="-1">\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539 <a class="header-anchor" href="#\u6162\u67E5\u8BE2\u65E5\u5FD7\u53C2\u6570\u4FEE\u6539" aria-hidden="true">#</a></h3><p>\u5728<code>my.cnf </code>\u4E2D\u7684<code>[mysqld]</code>\u90E8\u5206\u6DFB\u52A0\u5982\u4E0B\u5185\u5BB9\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">slow_query_log=on  </span></span>
<span class="line"><span style="color:#DBD7CA;">long_query_time=1  </span></span>
<span class="line"><span style="color:#758575;"># \u8BB0\u5F55\u4E0B\u6765\u6CA1\u6709\u4F7F\u7528\u7D22\u5F15\u7684\u67E5\u8BE2</span></span>
<span class="line"><span style="color:#DBD7CA;">log_queries_not_using_indexes=1</span></span>
<span class="line"><span style="color:#758575;"># \u6267\u884C\u901F\u5EA6\u8F83\u6162\u7684\u7BA1\u7406\u547D\u4EE4\u4E5F\u4F1A\u88AB\u8BB0\u5F55</span></span>
<span class="line"><span style="color:#DBD7CA;">log_slow_admin_statements=1</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">slow_query_log=on  </span></span>
<span class="line"><span style="color:#393A34;">long_query_time=1  </span></span>
<span class="line"><span style="color:#A0ADA0;"># \u8BB0\u5F55\u4E0B\u6765\u6CA1\u6709\u4F7F\u7528\u7D22\u5F15\u7684\u67E5\u8BE2</span></span>
<span class="line"><span style="color:#393A34;">log_queries_not_using_indexes=1</span></span>
<span class="line"><span style="color:#A0ADA0;"># \u6267\u884C\u901F\u5EA6\u8F83\u6162\u7684\u7BA1\u7406\u547D\u4EE4\u4E5F\u4F1A\u88AB\u8BB0\u5F55</span></span>
<span class="line"><span style="color:#393A34;">log_slow_admin_statements=1</span></span>
<span class="line"></span></code></pre></div><p>\u4E34\u65F6\u542F\u7528\u6162\u67E5\u8BE2\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;">-- \u8BBE\u7F6Elong_query_time\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">  show variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;%long_query%&quot;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Variable_name   | </span><span style="color:#4D9375;">Value</span><span style="color:#DBD7CA;">     |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| long_query_time | </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">000000</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">row</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> long_query_time</span><span style="color:#CB7676;">=</span><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, </span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">rows</span><span style="color:#DBD7CA;"> affected (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575;">-- \u8BBE\u7F6E\uFF1Aslow_query_log</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;slow_query_log&quot;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">----------------+-------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Variable_name  | </span><span style="color:#4D9375;">Value</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">----------------+-------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| slow_query_log | </span><span style="color:#4D9375;">OFF</span><span style="color:#DBD7CA;">   |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">----------------+-------+</span></span>
<span class="line"><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">row</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> slow_query_log</span><span style="color:#CB7676;">=</span><span style="color:#C98A7D;">&#39;ON&#39;</span><span style="color:#DBD7CA;">; </span></span>
<span class="line"><span style="color:#DBD7CA;">...</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">-- \u8BBE\u7F6Elong_query_time\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">  show variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;%long_query%&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#393A34;">| Variable_name   | </span><span style="color:#1C6B48;">Value</span><span style="color:#393A34;">     |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#393A34;">| long_query_time | </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">000000</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">-----------------+-----------+</span></span>
<span class="line"><span style="color:#296AA3;">1</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">row</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> long_query_time</span><span style="color:#AB5959;">=</span><span style="color:#296AA3;">1</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, </span><span style="color:#296AA3;">0</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">rows</span><span style="color:#393A34;"> affected (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;">-- \u8BBE\u7F6E\uFF1Aslow_query_log</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;slow_query_log&quot;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">----------------+-------+</span></span>
<span class="line"><span style="color:#393A34;">| Variable_name  | </span><span style="color:#1C6B48;">Value</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">----------------+-------+</span></span>
<span class="line"><span style="color:#393A34;">| slow_query_log | </span><span style="color:#1C6B48;">OFF</span><span style="color:#393A34;">   |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">----------------+-------+</span></span>
<span class="line"><span style="color:#296AA3;">1</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">row</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> slow_query_log</span><span style="color:#AB5959;">=</span><span style="color:#B56959;">&#39;ON&#39;</span><span style="color:#393A34;">; </span></span>
<span class="line"><span style="color:#393A34;">...</span></span>
<span class="line"></span></code></pre></div><p>\u6162\u67E5\u8BE2\u65E5\u5FD7\u8F93\u51FA\u4F4D\u7F6E\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u662F\u8F93\u51FA\u5230File\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">  show variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;log_output&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+------------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Variable_name | </span><span style="color:#4D9375;">Value</span><span style="color:#DBD7CA;">      |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+------------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| log_output    | </span><span style="color:#4D9375;">FILE</span><span style="color:#DBD7CA;">,</span><span style="color:#4D9375;">TABLE</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+------------+</span></span>
<span class="line"><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">row</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">  show variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;log_output&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+------------+</span></span>
<span class="line"><span style="color:#393A34;">| Variable_name | </span><span style="color:#1C6B48;">Value</span><span style="color:#393A34;">      |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+------------+</span></span>
<span class="line"><span style="color:#393A34;">| log_output    | </span><span style="color:#1C6B48;">FILE</span><span style="color:#393A34;">,</span><span style="color:#1C6B48;">TABLE</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+------------+</span></span>
<span class="line"><span style="color:#296AA3;">1</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">row</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span></code></pre></div><p>\u6D4B\u8BD5\u67E5\u770B\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">select</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#D4976C;">mysql</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">slow_log</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;"># \u76F4\u63A5\u67E5\u770B\u65E5\u5FD7\u8F93\u51FA\u6587\u4EF6\u5185\u5BB9</span></span>
<span class="line"><span style="color:#DBD7CA;">cat </span><span style="color:#CB7676;">/</span><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">/</span><span style="color:#4D9375;">data</span><span style="color:#CB7676;">/</span><span style="color:#DBD7CA;">Dave</span><span style="color:#CB7676;">-</span><span style="color:#D4976C;">slow</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">log</span><span style="color:#DBD7CA;"> | more</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">select</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">*</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">mysql</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">slow_log</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;"># \u76F4\u63A5\u67E5\u770B\u65E5\u5FD7\u8F93\u51FA\u6587\u4EF6\u5185\u5BB9</span></span>
<span class="line"><span style="color:#393A34;">cat </span><span style="color:#AB5959;">/</span><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">/</span><span style="color:#1C6B48;">data</span><span style="color:#AB5959;">/</span><span style="color:#393A34;">Dave</span><span style="color:#AB5959;">-</span><span style="color:#A65E2B;">slow</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">log</span><span style="color:#393A34;"> | more</span></span>
<span class="line"></span></code></pre></div><h3 id="\u4F7F\u7528-mysqldumpslow-\u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7" tabindex="-1">\u4F7F\u7528 mysqldumpslow \u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7 <a class="header-anchor" href="#\u4F7F\u7528-mysqldumpslow-\u5DE5\u5177\u5206\u6790\u6162\u67E5\u8BE2\u65E5\u5FD7" aria-hidden="true">#</a></h3><p>\u4F7F\u7528\u8BE5\u5DE5\u5177\u53EF\u4EE5\u67E5\u8BE2\u51FA\u6765\u90A3\u4E9Bsql\u8BED\u53E5\u662F\u6027\u80FD\u7684\u74F6\u9888\uFF0C\u8FDB\u884C\u4F18\u5316</p><p>\u4F7F\u7528\u793A\u4F8B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># \u8BBF\u95EE\u6B21\u6570\u6700\u591A\u768420\u4E2Asql\u8BED\u53E5</span></span>
<span class="line"><span style="color:#DBD7CA;">mysqldumpslow -s c -t 20 Dave-slow.log</span></span>
<span class="line"><span style="color:#758575;"># \u8FD4\u56DE\u8BB0\u5F55\u96C6\u6700\u591A\u768420\u4E2Asql\u8BED\u53E5</span></span>
<span class="line"><span style="color:#DBD7CA;">mysqldumpslow -s r -t 20 Dave-slow.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575;"># \u8FD9\u4E2A\u662F\u6309\u7167\u65F6\u95F4\u8FD4\u56DE\u524D10\u6761\u91CC\u9762\u542B\u6709\u5DE6\u8FDE\u63A5\u7684sql\u8BED\u53E5\u3002</span></span>
<span class="line"><span style="color:#DBD7CA;">mysqldumpslow -t 10 -s t -g \u201Cleft join\u201D Dave-slow.log</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># \u8BBF\u95EE\u6B21\u6570\u6700\u591A\u768420\u4E2Asql\u8BED\u53E5</span></span>
<span class="line"><span style="color:#393A34;">mysqldumpslow -s c -t 20 Dave-slow.log</span></span>
<span class="line"><span style="color:#A0ADA0;"># \u8FD4\u56DE\u8BB0\u5F55\u96C6\u6700\u591A\u768420\u4E2Asql\u8BED\u53E5</span></span>
<span class="line"><span style="color:#393A34;">mysqldumpslow -s r -t 20 Dave-slow.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># \u8FD9\u4E2A\u662F\u6309\u7167\u65F6\u95F4\u8FD4\u56DE\u524D10\u6761\u91CC\u9762\u542B\u6709\u5DE6\u8FDE\u63A5\u7684sql\u8BED\u53E5\u3002</span></span>
<span class="line"><span style="color:#393A34;">mysqldumpslow -t 10 -s t -g \u201Cleft join\u201D Dave-slow.log</span></span>
<span class="line"></span></code></pre></div><h2 id="\u9519\u8BEF\u65E5\u5FD7" tabindex="-1">\u9519\u8BEF\u65E5\u5FD7 <a class="header-anchor" href="#\u9519\u8BEF\u65E5\u5FD7" aria-hidden="true">#</a></h2><p>\u9519\u8BEF\u65E5\u5FD7\u6587\u4EF6\u8BB0\u5F55\u4E86\u9519\u8BEF\u4FE1\u606F\uFF0C\u4EE5\u53CAmysqld\u8FDB\u7A0B\u7684\u5173\u95ED\u548C\u542F\u52A8\u7684\u4FE1\u606F\uFF0C\u8FD9\u90E8\u5206\u4FE1\u606F\u5E76\u4E0D\u662F\u5168\u90E8\u8BB0\u5F55\u800C\u53EA\u662F\u8BB0\u5F55mysqld\u8FDB\u7A0B\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u53D1\u751F\u7684\u5173\u952E\u6027\u9519\u8BEF\u3002</p><p>\u9519\u8BEF\u65E5\u5FD7\u9ED8\u8BA4\u4F4D\u7F6E\u6570\u636E\u76EE\u5F55<code>DATADIR </code>\u6307\u5B9A\u7684\u76EE\u5F55\u4E2D\uFF0C\u53EF\u4EE5\u5728\u542F\u52A8mysqld\u8FDB\u7A0B\u65F6\uFF0C\u901A\u8FC7log-error\u9009\u9879\u6765\u6307\u5B9A\u9519\u8BEF\u65E5\u5FD7\u6587\u4EF6\u540D\u548C\u5B58\u653E\u4F4D\u7F6E\uFF0C\u6216\u8005<code>my.ini</code>\u914D\u7F6E\u6587\u4EF6\u4E2D\u914D\u7F6E<code>log-error</code>\u53C2\u6570\uFF0C\u5982\u679C\u6CA1\u6709\u6307\u5B9A\u6587\u4EF6\u540D\u7684\u8BDD\uFF0C\u4F1A\u81EA\u52A8\u751F\u6210\u4E00\u4E2A<code>[hostname].err</code>\u6587\u4EF6\u4FDD\u5B58\u5728<code>{datadir}</code>\u6587\u4EF6\u5939\u4E0B\u3002</p><p>\u67E5\u770B\u9519\u8BEF\u65E5\u5FD7\u9ED8\u8BA4\u4F4D\u7F6E\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;log_error&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;"># \u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u67E5\u770B</span></span>
<span class="line"><span style="color:#DBD7CA;"> cat </span><span style="color:#CB7676;">/</span><span style="color:#DBD7CA;">etc</span><span style="color:#CB7676;">/</span><span style="color:#D4976C;">my</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">cnf</span><span style="color:#DBD7CA;"> |grep log_error</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;log_error&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"># \u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u67E5\u770B</span></span>
<span class="line"><span style="color:#393A34;"> cat </span><span style="color:#AB5959;">/</span><span style="color:#393A34;">etc</span><span style="color:#AB5959;">/</span><span style="color:#A65E2B;">my</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">cnf</span><span style="color:#393A34;"> |grep log_error</span></span>
<span class="line"></span></code></pre></div><h2 id="\u4E8C\u8FDB\u5236\u65E5\u5FD7" tabindex="-1">\u4E8C\u8FDB\u5236\u65E5\u5FD7 <a class="header-anchor" href="#\u4E8C\u8FDB\u5236\u65E5\u5FD7" aria-hidden="true">#</a></h2><p>MariaDB\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7(binlog)\u8BB0\u5F55\u4E86\u6240\u6709\u7684<code>DDL</code>\u548C<code>DML</code>(\u9664\u4E86\u6570\u636E\u67E5\u8BE2\u8BED\u53E5)\u8BED\u53E5\uFF0C\u4EE5\u4E8B\u4EF6\u5F62\u5F0F\u8BB0\u5F55\uFF0C\u8FD8\u5305\u542B\u8BED\u53E5\u6240\u6267\u884C\u7684\u6D88\u8017\u7684\u65F6\u95F4\uFF0CMariaDB\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u662F<strong>\u4E8B\u52A1\u5B89\u5168\u578B</strong>\u7684\u3002 \u4E8C\u8FDB\u5236\u65E5\u5FD7\u5305\u62EC\u4E24\u7C7B\u6587\u4EF6\uFF1A\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7D22\u5F15\u6587\u4EF6\uFF08\u6587\u4EF6\u540D\u540E\u7F00\u4E3A<code>.index</code>\uFF09\u7528\u4E8E\u8BB0\u5F55\u6240\u6709\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\uFF08\u6587\u4EF6\u540D\u540E\u7F00\u4E3A<code>.00000*</code>\uFF09\u8BB0\u5F55\u6570\u636E\u5E93\u6240\u6709\u7684<code>DDL</code>\u548C<code>DML</code>(\u9664\u4E86\u6570\u636E\u67E5\u8BE2\u8BED\u53E5)\u8BED\u53E5\u4E8B\u4EF6\u3002</p><blockquote><p>\u4E00\u822C\u6765\u8BF4\u5F00\u542F\u4E8C\u8FDB\u5236\u65E5\u5FD7\u5927\u6982\u4F1A\u67091%\u7684\u6027\u80FD\u635F\u8017\u3002\u4E8C\u8FDB\u5236\u6709\u4E24\u4E2A\u6700\u91CD\u8981\u7684\u4F7F\u7528\u573A\u666F: 1). MySQL Replication\u5728Master\u7AEF\u5F00\u542Fbinlog\uFF0CMster\u628A\u5B83\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u4F20\u9012\u7ED9slaves\u6765\u8FBE\u5230master-slave\u6570\u636E\u4E00\u81F4\u7684\u76EE\u7684\u3002 2). \u6570\u636E\u6062\u590D\uFF0C\u901A\u8FC7\u4F7F\u7528mysqlbinlog\u5DE5\u5177\u6765\u4F7F\u6062\u590D\u6570\u636E\u3002</p></blockquote><h3 id="\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F" tabindex="-1">\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F <a class="header-anchor" href="#\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4E09\u79CD\u6A21\u5F0F" aria-hidden="true">#</a></h3><h4 id="row-level" tabindex="-1">Row Level <a class="header-anchor" href="#row-level" aria-hidden="true">#</a></h4><p>\u65E5\u5FD7\u4E2D\u4F1A\u8BB0\u5F55\u6210\u6BCF\u4E00\u884C\u6570\u636E\u88AB\u4FEE\u6539\u7684\u5F62\u5F0F\uFF0C\u7136\u540E\u5728slave\u7AEF\u518D\u5BF9\u76F8\u540C\u7684\u6570\u636E\u8FDB\u884C\u4FEE\u6539\u3002</p><h4 id="statement-level" tabindex="-1">Statement Level <a class="header-anchor" href="#statement-level" aria-hidden="true">#</a></h4><p>\u6BCF\u4E00\u6761\u4F1A\u4FEE\u6539\u6570\u636E\u7684sql\u90FD\u4F1A\u8BB0\u5F55\u5230 master\u7684bin-log\u4E2D\u3002slave\u5728\u590D\u5236\u7684\u65F6\u5019sql\u8FDB\u7A0B\u4F1A\u89E3\u6790\u6210\u548C\u539F\u6765master\u7AEF\u6267\u884C\u8FC7\u7684\u76F8\u540C\u7684sql\u6765\u518D\u6B21\u6267\u884C\u3002</p><h4 id="mixed-level" tabindex="-1">Mixed Level <a class="header-anchor" href="#mixed-level" aria-hidden="true">#</a></h4><p>\u662F\u524D\u4E24\u79CD\u6A21\u5F0F\u7684\u7ED3\u5408\u3002\u5728Mixed\u6A21\u5F0F\u4E0B\uFF0CMySQL\u4F1A\u6839\u636E\u6267\u884C\u7684\u6BCF\u4E00\u6761\u5177\u4F53\u7684sql\u8BED\u53E5\u6765\u533A\u5206\u5BF9\u5F85\u8BB0\u5F55\u7684\u65E5\u5FD7\u5F62\u5F0F\uFF0C\u4E5F\u5C31\u662F\u5728Statement\u548CRow\u4E4B\u95F4\u9009\u62E9\u4E00\u79CD\u3002</p><h3 id="\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539" tabindex="-1">\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539 <a class="header-anchor" href="#\u65E5\u5FD7\u6A21\u5F0F\u4FEE\u6539" aria-hidden="true">#</a></h3><p>\u5F00\u542F binlog\uFF0C\u53EF\u4EE5\u76F4\u63A5\u4FEE\u6539<code>my.cnf </code>\u914D\u7F6E\u6587\u4EF6\uFF0C\u4E5F\u53EF\u4EE5\u7528\u547D\u4EE4\u4FEE\u6539\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#DBD7CA;">binlog_format=\u201DSTATEMENT\u201D</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#393A34;">binlog_format=\u201DSTATEMENT\u201D</span></span>
<span class="line"></span></code></pre></div><p>\u8FD0\u884C\u65F6\u5728\u7EBF\u4FEE\u6539\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> binlog_format</span><span style="color:#CB7676;">=</span><span style="color:#C98A7D;">&#39;mixed&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, </span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">rows</span><span style="color:#DBD7CA;"> affected (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;binlog_format&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+-------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Variable_name | </span><span style="color:#4D9375;">Value</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+-------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| binlog_format | </span><span style="color:#4D9375;">MIXED</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">---------------+-------+</span></span>
<span class="line"><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">row</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> binlog_format</span><span style="color:#AB5959;">=</span><span style="color:#B56959;">&#39;mixed&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, </span><span style="color:#296AA3;">0</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">rows</span><span style="color:#393A34;"> affected (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;binlog_format&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+-------+</span></span>
<span class="line"><span style="color:#393A34;">| Variable_name | </span><span style="color:#1C6B48;">Value</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+-------+</span></span>
<span class="line"><span style="color:#393A34;">| binlog_format | </span><span style="color:#1C6B48;">MIXED</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">---------------+-------+</span></span>
<span class="line"><span style="color:#296AA3;">1</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">row</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span></code></pre></div><h3 id="\u5E38\u7528-binlog-\u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4" tabindex="-1">\u5E38\u7528 binlog \u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4 <a class="header-anchor" href="#\u5E38\u7528-binlog-\u65E5\u5FD7\u64CD\u4F5C\u547D\u4EE4" aria-hidden="true">#</a></h3><p><strong>\u67E5\u770B\u6240\u6709 binlog \u65E5\u5FD7\u5217\u8868\uFF1A</strong></p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;"> logs;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;"> logs;</span></span>
<span class="line"></span></code></pre></div><p><strong>\u67E5\u770B master \u72B6\u6001\uFF1A</strong></p><p>\u5373\u6700\u540E(\u6700\u65B0)\u4E00\u4E2Abinlog\u65E5\u5FD7\u7684\u7F16\u53F7\u540D\u79F0\uFF0C\u53CA\u5176\u6700\u540E\u4E00\u4E2A\u64CD\u4F5C\u4E8B\u4EF6pos\u7ED3\u675F\u70B9(Position)\u503C</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">status</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">status</span><span style="color:#393A34;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>\u5237\u65B0 log \u65E5\u5FD7\uFF1A</strong></p><p>\u81EA\u6B64\u523B\u5F00\u59CB\u7ACB\u5373\u4EA7\u751F\u4E00\u4E2A\u65B0\u7F16\u53F7\u7684binlog\u65E5\u5FD7\u6587\u4EF6</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> flush logs;</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;"> logs;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> flush logs;</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;"> logs;</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\uFF1A\u6BCF\u5F53mysqld\u670D\u52A1\u91CD\u542F\u65F6\uFF0C\u4F1A\u81EA\u52A8\u6267\u884C\u6B64\u547D\u4EE4\uFF0C\u5237\u65B0binlog\u65E5\u5FD7\uFF1B\u5728<code>mysqldump</code>\u5907\u4EFD\u6570\u636E\u65F6\u52A0<code>-F</code>\u9009\u9879\u4E5F\u4F1A\u5237\u65B0binlog\u65E5\u5FD7\uFF1B</p><h3 id="\u67E5\u770B-binlog-\u65E5\u5FD7\u5185\u5BB9" tabindex="-1">\u67E5\u770B binlog \u65E5\u5FD7\u5185\u5BB9 <a class="header-anchor" href="#\u67E5\u770B-binlog-\u65E5\u5FD7\u5185\u5BB9" aria-hidden="true">#</a></h3><h4 id="\u4F7F\u7528-mysqlbinlog-\u547D\u4EE4\u67E5\u770B" tabindex="-1">\u4F7F\u7528 mysqlbinlog \u547D\u4EE4\u67E5\u770B <a class="header-anchor" href="#\u4F7F\u7528-mysqlbinlog-\u547D\u4EE4\u67E5\u770B" aria-hidden="true">#</a></h4><p>binlog\u662F\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u666E\u901A\u6587\u4EF6\u67E5\u770B\u5668cat more vi\u7B49\u90FD\u65E0\u6CD5\u6253\u5F00\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5E26\u7684 <code>mysqlbinlog </code>\u547D\u4EE4\u67E5\u770B\u3002</p><p>\u67E5\u770B\u67D0\u4E2A binlog \u7684\u5185\u5BB9\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysqlbinlog --no-defaults /mysql/data/mysql-bin.000020</span></span>
<span class="line"><span style="color:#758575;"># ------------------</span></span>
<span class="line"><span style="color:#858585;">(</span><span style="color:#CB7676;">*</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;"> \u6587\u4EF6\u5185\u5BB9\u8BF4\u660E\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">    server id 1 \u6570\u636E\u5E93\u4E3B\u673A\u7684\u670D\u52A1\u53F7\uFF1B</span></span>
<span class="line"><span style="color:#DBD7CA;">    at 663 \u8868\u793A\u5F00\u59CB\u7684pos\u70B9</span></span>
<span class="line"><span style="color:#DBD7CA;">    end_log_pos 663 \u8868\u793A\u7ED3\u675F\u7684pos\u70B9</span></span>
<span class="line"><span style="color:#DBD7CA;">    thread_id=10 \u7EBF\u7A0B\u53F7</span></span>
<span class="line"><span style="color:#758575;"># ------------------</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysqlbinlog --no-defaults /mysql/data/mysql-bin.000020</span></span>
<span class="line"><span style="color:#A0ADA0;"># ------------------</span></span>
<span class="line"><span style="color:#8E8F8B;">(</span><span style="color:#AB5959;">*</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;"> \u6587\u4EF6\u5185\u5BB9\u8BF4\u660E\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">    server id 1 \u6570\u636E\u5E93\u4E3B\u673A\u7684\u670D\u52A1\u53F7\uFF1B</span></span>
<span class="line"><span style="color:#393A34;">    at 663 \u8868\u793A\u5F00\u59CB\u7684pos\u70B9</span></span>
<span class="line"><span style="color:#393A34;">    end_log_pos 663 \u8868\u793A\u7ED3\u675F\u7684pos\u70B9</span></span>
<span class="line"><span style="color:#393A34;">    thread_id=10 \u7EBF\u7A0B\u53F7</span></span>
<span class="line"><span style="color:#A0ADA0;"># ------------------</span></span>
<span class="line"></span></code></pre></div><p>\u6309\u4F4D\u7F6E\u8FC7\u6EE4\u67E5\u770B binlog \u5185\u5BB9\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;"> mysqlbinlog --no-defaults --start-position=560 --stop-position=663 </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;"> mysqlbinlog --no-defaults --start-position=560 --stop-position=663 </span></span>
<span class="line"></span></code></pre></div><p>\u6309\u65F6\u95F4\u8FC7\u6EE4\u67E5\u770B binlog \u5185\u5BB9\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysqlbinlog --no-defaults --start-datetime=</span><span style="color:#C98A7D;">&#39;2020-05-10 15:42:29&#39;</span><span style="color:#DBD7CA;"> --stop-datetime=</span><span style="color:#C98A7D;">&#39;2020-05-10 17:42:37&#39;</span><span style="color:#DBD7CA;"> /mysql/data/mysql-bin.000032</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysqlbinlog --no-defaults --start-datetime=</span><span style="color:#B56959;">&#39;2020-05-10 15:42:29&#39;</span><span style="color:#393A34;"> --stop-datetime=</span><span style="color:#B56959;">&#39;2020-05-10 17:42:37&#39;</span><span style="color:#393A34;"> /mysql/data/mysql-bin.000032</span></span>
<span class="line"></span></code></pre></div><h4 id="\u76F4\u63A5\u5728\u6570\u636E\u5E93\u4E2D\u8FDB\u884C\u67E5\u770B" tabindex="-1">\u76F4\u63A5\u5728\u6570\u636E\u5E93\u4E2D\u8FDB\u884C\u67E5\u770B <a class="header-anchor" href="#\u76F4\u63A5\u5728\u6570\u636E\u5E93\u4E2D\u8FDB\u884C\u67E5\u770B" aria-hidden="true">#</a></h4><p>\u4F7F\u7528 mysqlbinlog \u7684\u529E\u6CD5\u8BFB\u53D6\u51FA binlog \u65E5\u5FD7\u7684\u5168\u6587\u5185\u5BB9\u8F83\u591A\uFF0C\u4E0D\u5BB9\u6613\u5206\u8FA8\u67E5\u770B pos \u70B9\u4FE1\u606F\uFF0C\u53EF\u4EE5\u5728\u6570\u636E\u5E93\u4E2D\u76F4\u63A5\u4F7F\u7528\u547D\u4EE4\u66F4\u65B9\u4FBF\u7684\u67E5\u8BE2\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show binlog events [IN &#39;log_name&#39;] [FROM pos] [LIMIT [offset,] row_count];</span></span>
<span class="line"><span style="color:#DBD7CA;"># </span><span style="color:#758575;">------------------</span></span>
<span class="line"><span style="color:#DBD7CA;">(</span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;">) \u9009\u9879\u89E3\u6790\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;">. </span><span style="color:#4D9375;">IN</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;log_name&#39;</span><span style="color:#DBD7CA;">   \u6307\u5B9A\u8981\u67E5\u8BE2\u7684binlog\u6587\u4EF6\u540D(\u4E0D\u6307\u5B9A\u5C31\u662F\u7B2C\u4E00\u4E2Abinlog\u6587\u4EF6)</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#6394BF;">2</span><span style="color:#DBD7CA;">. </span><span style="color:#4D9375;">FROM</span><span style="color:#DBD7CA;"> pos        \u6307\u5B9A\u4ECE\u54EA\u4E2Apos\u8D77\u59CB\u70B9\u5F00\u59CB\u67E5\u8D77(\u4E0D\u6307\u5B9A\u5C31\u662F\u4ECE\u6574\u4E2A\u6587\u4EF6\u9996\u4E2Apos\u70B9\u5F00\u59CB\u7B97)</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#6394BF;">3</span><span style="color:#DBD7CA;">. </span><span style="color:#4D9375;">LIMIT</span><span style="color:#DBD7CA;"> [offset,] \u504F\u79FB\u91CF(\u4E0D\u6307\u5B9A\u5C31\u662F0)</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#6394BF;">4</span><span style="color:#DBD7CA;">. row_count       \u67E5\u8BE2\u603B\u6761\u6570(\u4E0D\u6307\u5B9A\u5C31\u662F\u6240\u6709\u884C)</span></span>
<span class="line"><span style="color:#DBD7CA;"># </span><span style="color:#758575;">------------------</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;"> logs;</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show binlog events </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;mysql-bin.000020&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#758575;">-- \u6307\u5B9A\u67E5\u8BE2 mysql-bin.000021 \u8FD9\u4E2A\u6587\u4EF6\uFF0C\u4ECEpos\u70B9:8224\u5F00\u59CB\u67E5\u8D77\uFF0C\u504F\u79FB2\u884C\uFF0C\u67E5\u8BE210\u6761</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show binlog events </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;mysql-bin.000021&#39;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8224</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">limit</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">2</span><span style="color:#DBD7CA;">,</span><span style="color:#6394BF;">10</span><span style="color:#CB7676;">/</span><span style="color:#DBD7CA;">G;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show binlog events [IN &#39;log_name&#39;] [FROM pos] [LIMIT [offset,] row_count];</span></span>
<span class="line"><span style="color:#393A34;"># </span><span style="color:#A0ADA0;">------------------</span></span>
<span class="line"><span style="color:#393A34;">(</span><span style="color:#AB5959;">*</span><span style="color:#393A34;">) \u9009\u9879\u89E3\u6790\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#296AA3;">1</span><span style="color:#393A34;">. </span><span style="color:#1C6B48;">IN</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;log_name&#39;</span><span style="color:#393A34;">   \u6307\u5B9A\u8981\u67E5\u8BE2\u7684binlog\u6587\u4EF6\u540D(\u4E0D\u6307\u5B9A\u5C31\u662F\u7B2C\u4E00\u4E2Abinlog\u6587\u4EF6)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#296AA3;">2</span><span style="color:#393A34;">. </span><span style="color:#1C6B48;">FROM</span><span style="color:#393A34;"> pos        \u6307\u5B9A\u4ECE\u54EA\u4E2Apos\u8D77\u59CB\u70B9\u5F00\u59CB\u67E5\u8D77(\u4E0D\u6307\u5B9A\u5C31\u662F\u4ECE\u6574\u4E2A\u6587\u4EF6\u9996\u4E2Apos\u70B9\u5F00\u59CB\u7B97)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#296AA3;">3</span><span style="color:#393A34;">. </span><span style="color:#1C6B48;">LIMIT</span><span style="color:#393A34;"> [offset,] \u504F\u79FB\u91CF(\u4E0D\u6307\u5B9A\u5C31\u662F0)</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#296AA3;">4</span><span style="color:#393A34;">. row_count       \u67E5\u8BE2\u603B\u6761\u6570(\u4E0D\u6307\u5B9A\u5C31\u662F\u6240\u6709\u884C)</span></span>
<span class="line"><span style="color:#393A34;"># </span><span style="color:#A0ADA0;">------------------</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;"> logs;</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show binlog events </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;mysql-bin.000020&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#A0ADA0;">-- \u6307\u5B9A\u67E5\u8BE2 mysql-bin.000021 \u8FD9\u4E2A\u6587\u4EF6\uFF0C\u4ECEpos\u70B9:8224\u5F00\u59CB\u67E5\u8D77\uFF0C\u504F\u79FB2\u884C\uFF0C\u67E5\u8BE210\u6761</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show binlog events </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;mysql-bin.000021&#39;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8224</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">limit</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">2</span><span style="color:#393A34;">,</span><span style="color:#296AA3;">10</span><span style="color:#AB5959;">/</span><span style="color:#393A34;">G;</span></span>
<span class="line"></span></code></pre></div><h3 id="\u5220\u9664-binlog-\u65E5\u5FD7" tabindex="-1">\u5220\u9664 binlog \u65E5\u5FD7 <a class="header-anchor" href="#\u5220\u9664-binlog-\u65E5\u5FD7" aria-hidden="true">#</a></h3><p>\u5F53\u5F00\u542Fmysql\u6570\u636E\u5E93\u4E3B\u4ECE\u540E\uFF0C\u4F1A\u4EA7\u751F\u5927\u91CF\u5982mysql-bin.00000* log\u7684\u6587\u4EF6\uFF0C\u8FD9\u4F1A\u5927\u91CF\u8017\u8D39\u60A8\u7684\u786C\u76D8\u7A7A\u95F4\u3002\u6709\u4E09\u79CD\u89E3\u51B3\u65B9\u6CD5\uFF1A</p><ol><li>\u5173\u95EDmysql\u4E3B\u4ECE\uFF0C\u5173\u95EDbinlog\uFF1B</li><li>\u5F00\u542Fmysql\u4E3B\u4ECE\uFF0C\u8BBE\u7F6Eexpire_logs_days\uFF1B</li><li>\u624B\u52A8\u6E05\u9664binlog\u6587\u4EF6\uFF0C</li></ol><h4 id="\u65B9\u6CD51-purge-master-logs" tabindex="-1">\u65B9\u6CD51: PURGE MASTER LOGS <a class="header-anchor" href="#\u65B9\u6CD51-purge-master-logs" aria-hidden="true">#</a></h4><p>\u5220\u9664<code>mysql-bin.000002</code>\u4E4B\u524D\u7684\u65E5\u5FD7\uFF08\u4E0D\u5305\u62EC<code>mysql-bin.000002</code>\uFF09:</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> PURGE </span><span style="color:#4D9375;">BINARY</span><span style="color:#DBD7CA;"> LOGS </span><span style="color:#4D9375;">TO</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;mysql-bin.000002&#39;</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;"># \u5220\u96642018</span><span style="color:#CB7676;">-</span><span style="color:#6394BF;">02</span><span style="color:#CB7676;">-</span><span style="color:#6394BF;">07</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">11</span><span style="color:#DBD7CA;">:</span><span style="color:#6394BF;">53</span><span style="color:#DBD7CA;">:59\u65F6\u95F4\u70B9\u4E4B\u524D\u7684\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> PURGE </span><span style="color:#4D9375;">BINARY</span><span style="color:#DBD7CA;"> LOGS </span><span style="color:#4D9375;">BEFORE</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;2018-02-07 11:53:59&#39;</span><span style="color:#DBD7CA;">;  </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> PURGE </span><span style="color:#1C6B48;">BINARY</span><span style="color:#393A34;"> LOGS </span><span style="color:#1C6B48;">TO</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;mysql-bin.000002&#39;</span><span style="color:#393A34;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;"># \u5220\u96642018</span><span style="color:#AB5959;">-</span><span style="color:#296AA3;">02</span><span style="color:#AB5959;">-</span><span style="color:#296AA3;">07</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">11</span><span style="color:#393A34;">:</span><span style="color:#296AA3;">53</span><span style="color:#393A34;">:59\u65F6\u95F4\u70B9\u4E4B\u524D\u7684\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> PURGE </span><span style="color:#1C6B48;">BINARY</span><span style="color:#393A34;"> LOGS </span><span style="color:#1C6B48;">BEFORE</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;2018-02-07 11:53:59&#39;</span><span style="color:#393A34;">;  </span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u6CE8\u610F\u4E8B\u9879\uFF1A</p></blockquote><p>\u5728\u5220\u9664binlog\u65E5\u5FD7\u540C\u65F6\uFF0C\u4E5F\u4F1A\u6E05\u7406<code>mysql-bin.index</code>\u7684\u6587\u4EF6\u8BB0\u5F55\uFF0C\u6E05\u7406\u5B8C\u540E\u547D\u4EE4\u4E2D\u6307\u5B9A\u7684\u65E5\u5FD7\u6587\u4EF6\u6210\u4E3A\u7B2C\u4E00\u4E2A\u3002 \u4E3B\u4ECE\u67B6\u6784\u4E0B\uFF0C<strong>\u5982\u679C\u590D\u5236\u6B63\u5728\u8FDB\u884C\u4E2D\uFF0C\u6267\u884C\u8BE5\u547D\u4EE4\u662F\u5B89\u5168\u7684</strong>\uFF0C\u4F8B\u5982<code>slave</code>\u6B63\u5728\u8BFB\u53D6\u6211\u4EEC\u8981\u5220\u9664\u7684log\uFF0C\u8BE5\u8BED\u53E5\u5C06\u4EC0\u4E48\u4E5F\u4E0D\u4F1A\u505A\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u9519\u8BEF\uFF1B\u5982\u679C\u590D\u5236\u662F\u505C\u6B62\u7684\uFF0C\u6211\u4EEC\u5220\u9664\u4E86\u4E00\u4E2A<code>slave</code>\u8FD8\u672A\u8BFB\u53D6\u7684\u65E5\u5FD7\uFF0C\u5219<strong>\u590D\u5236\u91CD\u65B0\u5EFA\u7ACB\u8FDE\u63A5\u65F6\u5C06\u4F1A\u5931\u8D25</strong>\u3002</p><blockquote><p>\u5EFA\u8BAE\u64CD\u4F5C\u6B65\u9AA4\uFF1A</p><ol><li>\u5728\u6BCF\u4E2A\u4ECE\u5C5E\u670D\u52A1\u5668\u4E0A\uFF0C\u4F7F\u7528<code>SHOW SLAVE STATUS</code>\u6765\u68C0\u67E5\u5B83\u6B63\u5728\u8BFB\u53D6\u54EA\u4E2A\u65E5\u5FD7\u3002</li><li>\u4F7F\u7528<code>SHOW MASTER LOGS</code>\u83B7\u5F97\u4E3B\u670D\u52A1\u5668\u4E0A\u7684\u4E00\u7CFB\u5217\u65E5\u5FD7\u3002</li><li>\u5728\u6240\u6709\u7684\u4ECE\u5C5E\u670D\u52A1\u5668\u4E2D\u5224\u5B9A\u6700\u65E9\u7684\u65E5\u5FD7\u3002\u8FD9\u4E2A\u662F\u76EE\u6807\u65E5\u5FD7\u3002\u5982\u679C\u6240\u6709\u7684\u4ECE\u5C5E\u670D\u52A1\u5668\u662F\u6700\u65B0\u7684\uFF0C\u8FD9\u662F\u6E05\u5355\u4E0A\u7684\u6700\u540E\u4E00\u4E2A\u65E5\u5FD7\u3002</li><li>\u5907\u4EFD\u60A8\u5C06\u8981\u5220\u9664\u7684\u6240\u6709\u65E5\u5FD7\u3002\uFF08\u8FD9\u4E2A\u6B65\u9AA4\u662F\u81EA\u9009\u7684\uFF0C\u4F46\u662F\u5EFA\u8BAE\u91C7\u7528\u3002\uFF09</li><li>\u6E05\u7406\u9664\u76EE\u6807\u65E5\u5FD7\u4E4B\u5916\u7684\u6240\u6709\u65E5\u5FD7\u3002</li></ol></blockquote><h4 id="\u65B9\u6CD52-\u624B\u52A8\u5220\u9664binlog\u65E5\u5FD7\u6587\u4EF6" tabindex="-1">\u65B9\u6CD52: \u624B\u52A8\u5220\u9664binlog\u65E5\u5FD7\u6587\u4EF6 <a class="header-anchor" href="#\u65B9\u6CD52-\u624B\u52A8\u5220\u9664binlog\u65E5\u5FD7\u6587\u4EF6" aria-hidden="true">#</a></h4><p>\u624B\u52A8\u5220\u9664binlog\u65E5\u5FD7\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">rm -rf mysql-bin.00009</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">rm -rf mysql-bin.00009</span></span>
<span class="line"></span></code></pre></div><p>\u66F4\u65B0\u7D22\u5F15\u6587\u4EF6\u4E2D\u7684\u8BB0\u5F55\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">vim mysql-bin.index </span></span>
<span class="line"><span style="color:#758575;"># \u5220\u9664mysql-bin.00009\u884C\u5373\u53EF</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">vim mysql-bin.index </span></span>
<span class="line"><span style="color:#A0ADA0;"># \u5220\u9664mysql-bin.00009\u884C\u5373\u53EF</span></span>
<span class="line"></span></code></pre></div><h4 id="\u65B9\u6CD53-\u6307\u5B9A\u8FC7\u671F\u5929\u6570\uFF08expire-logs-days\uFF09" tabindex="-1">\u65B9\u6CD53: \u6307\u5B9A\u8FC7\u671F\u5929\u6570\uFF08expire_logs_days\uFF09 <a class="header-anchor" href="#\u65B9\u6CD53-\u6307\u5B9A\u8FC7\u671F\u5929\u6570\uFF08expire-logs-days\uFF09" aria-hidden="true">#</a></h4><p>\u67E5\u770B\u8FC7\u671F\u5929\u6570\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show variables </span><span style="color:#4D9375;">like</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;expire_logs_days&#39;</span><span style="color:#DBD7CA;">; </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show variables </span><span style="color:#1C6B48;">like</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;expire_logs_days&#39;</span><span style="color:#393A34;">; </span></span>
<span class="line"></span></code></pre></div><p>\u6C38\u4E45\u4FEE\u6539\u8FC7\u671F\u5929\u6570\uFF0C\u5728<code>/etc/my.cnf</code>\u914D\u7F6E\u6587\u4EF6\u4E2D\u589E\u52A0\u4EE5\u4E0B\u5185\u5BB9\uFF1A</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">expire_logs_days=10</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">expire_logs_days=10</span></span>
<span class="line"></span></code></pre></div><p>\u4E34\u65F6\u4FEE\u6539\u8FC7\u671F\u65F6\u95F4\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">global</span><span style="color:#DBD7CA;"> expire_logs_days </span><span style="color:#CB7676;">=</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">global</span><span style="color:#393A34;"> expire_logs_days </span><span style="color:#AB5959;">=</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">;</span></span>
<span class="line"></span></code></pre></div><p>\u5237\u65B0\u65E5\u5FD7\uFF0C\u89E6\u53D1\u65E5\u5FD7\u6E05\u9664\uFF1A</p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> flush logs;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> flush logs;</span></span>
<span class="line"></span></code></pre></div><p>\u26A0\uFE0F \u6CE8\u610F\u4E8B\u9879\uFF1A\u5728\u4E3B\u4ECE\u590D\u5236\u73AF\u5883\u4E0B\uFF0C\u5E94\u786E\u4FDD\u8FC7\u671F\u5929\u6570\u4E0D\u5E94\u5C0F\u4E8E\u4ECE\u673A\u8FFD\u8D76\u4E3B\u673A binlog \u65E5\u5FD7\u7684\u65F6\u95F4\u3002</p><h4 id="\u65B9\u6CD54-reset-master" tabindex="-1">\u65B9\u6CD54: RESET MASTER <a class="header-anchor" href="#\u65B9\u6CD54-reset-master" aria-hidden="true">#</a></h4><p>\u8BE5\u65B9\u6CD5\u53EF\u4EE5\u5220\u9664\u5217\u4E8E\u7D22\u5F15\u6587\u4EF6\u4E2D\u7684\u6240\u6709\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF0C\u628A\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7D22\u5F15\u6587\u4EF6<strong>\u91CD\u65B0\u8BBE\u7F6E\u4E3A\u7A7A</strong>\uFF0C\u5E76\u521B\u5EFA\u4E00\u4E2A\u4EE5<code>.000001</code>\u4E3A\u540E\u7F00\u65B0\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u3002\u8BE5\u8BED\u6CD5\u4E00\u822C\u53EA\u7528\u5728\u4E3B\u4ECE\u73AF\u5883\u4E0B<strong>\u521D\u6B21\u5EFA\u7ACB\u590D\u5236</strong>\u65F6\u3002<strong>\u5728\u4E3B\u4ECE\u590D\u5236\u8FDB\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u8BE5\u8BED\u53E5\u662F\u65E0\u6548\u7684\u3002</strong></p><div class="language-sql"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">reset</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, </span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">rows</span><span style="color:#DBD7CA;"> affected, </span><span style="color:#6394BF;">3</span><span style="color:#DBD7CA;"> warnings (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> show </span><span style="color:#4D9375;">master</span><span style="color:#DBD7CA;"> logs;</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+-----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| Log_name         | File_size |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+-----------+</span></span>
<span class="line"><span style="color:#DBD7CA;">| mysql</span><span style="color:#CB7676;">-</span><span style="color:#D4976C;">bin</span><span style="color:#DBD7CA;">.</span><span style="color:#D4976C;">000001</span><span style="color:#DBD7CA;"> |       </span><span style="color:#6394BF;">328</span><span style="color:#DBD7CA;"> |</span></span>
<span class="line"><span style="color:#CB7676;">+</span><span style="color:#758575;">------------------+-----------+</span></span>
<span class="line"><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">row</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">set</span><span style="color:#DBD7CA;"> (</span><span style="color:#6394BF;">0</span><span style="color:#DBD7CA;">.</span><span style="color:#6394BF;">00</span><span style="color:#DBD7CA;"> sec)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">reset</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, </span><span style="color:#296AA3;">0</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">rows</span><span style="color:#393A34;"> affected, </span><span style="color:#296AA3;">3</span><span style="color:#393A34;"> warnings (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> show </span><span style="color:#1C6B48;">master</span><span style="color:#393A34;"> logs;</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+-----------+</span></span>
<span class="line"><span style="color:#393A34;">| Log_name         | File_size |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+-----------+</span></span>
<span class="line"><span style="color:#393A34;">| mysql</span><span style="color:#AB5959;">-</span><span style="color:#A65E2B;">bin</span><span style="color:#393A34;">.</span><span style="color:#A65E2B;">000001</span><span style="color:#393A34;"> |       </span><span style="color:#296AA3;">328</span><span style="color:#393A34;"> |</span></span>
<span class="line"><span style="color:#AB5959;">+</span><span style="color:#A0ADA0;">------------------+-----------+</span></span>
<span class="line"><span style="color:#296AA3;">1</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">row</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">set</span><span style="color:#393A34;"> (</span><span style="color:#296AA3;">0</span><span style="color:#393A34;">.</span><span style="color:#296AA3;">00</span><span style="color:#393A34;"> sec)</span></span>
<span class="line"></span></code></pre></div><h2 id="\u53C2\u8003\u94FE\u63A5" tabindex="-1">\u53C2\u8003\u94FE\u63A5 <a class="header-anchor" href="#\u53C2\u8003\u94FE\u63A5" aria-hidden="true">#</a></h2><ul><li><a href="https://blog.51cto.com/arm2012/1980771" target="_blank" rel="noopener noreferrer">https://blog.51cto.com/arm2012/1980771</a> AND <a href="https://www.cndba.cn/dave/article/2646" target="_blank" rel="noopener noreferrer">https://www.cndba.cn/dave/article/2646</a></li><li>mariadb \u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF1A<a href="https://www.cndba.cn/dave/article/2645" target="_blank" rel="noopener noreferrer">https://www.cndba.cn/dave/article/2645</a></li><li>mariadb \u4E00\u822C\u67E5\u8BE2\u65E5\u5FD7: <a href="https://mariadb.com/kb/zh-cn/general-query-log/" target="_blank" rel="noopener noreferrer">https://mariadb.com/kb/zh-cn/general-query-log/</a></li><li>mariadb \u9519\u8BEF\u65E5\u5FD7: <a href="https://mariadb.com/kb/zh-cn/error-log/" target="_blank" rel="noopener noreferrer">https://mariadb.com/kb/zh-cn/error-log/</a></li></ul>`,104),e=[o];function c(r,t,y,A,i,D){return a(),n("div",null,e)}var C=s(p,[["render",c]]);export{d as __pageData,C as default};
