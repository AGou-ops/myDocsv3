import{_ as s,o as n,c as a,a as l}from"./app.1e6146c3.js";const D=JSON.parse('{"title":"nginx+tomcat+redis\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u548Csession\u5171\u4EAB","description":"","frontmatter":{},"headers":[{"level":2,"title":"1\u3001\u5B9E\u9A8C\u73AF\u5883","slug":"_1\u3001\u5B9E\u9A8C\u73AF\u5883"},{"level":2,"title":"2\u3001\u5B9E\u9A8C\u62D3\u6251","slug":"_2\u3001\u5B9E\u9A8C\u62D3\u6251"},{"level":2,"title":"3\u3001nginx\u5B89\u88C5\u914D\u7F6E","slug":"_3\u3001nginx\u5B89\u88C5\u914D\u7F6E"},{"level":2,"title":"4\u3001\u5B89\u88C5\u90E8\u7F72tomcat\u5E94\u7528\u7A0B\u5E8F\u670D\u52A1\u5668","slug":"_4\u3001\u5B89\u88C5\u90E8\u7F72tomcat\u5E94\u7528\u7A0B\u5E8F\u670D\u52A1\u5668"},{"level":2,"title":"5\u3001\u5B89\u88C5redis","slug":"_5\u3001\u5B89\u88C5redis"},{"level":2,"title":"6\u3001\u914D\u7F6Etomcat session redis\u540C\u6B65","slug":"_6\u3001\u914D\u7F6Etomcat-session-redis\u540C\u6B65"}],"relativePath":"LinuxBasics/Web Servers/Jvm - Tomcat/Tomcat Session\uFF08Redis with Nginx\uFF09.md","lastUpdated":1657272051000}'),p={name:"LinuxBasics/Web Servers/Jvm - Tomcat/Tomcat Session\uFF08Redis with Nginx\uFF09.md"},o=l(`<h1 id="nginx-tomcat-redis\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u548Csession\u5171\u4EAB" tabindex="-1">nginx+tomcat+redis\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u548Csession\u5171\u4EAB <a class="header-anchor" href="#nginx-tomcat-redis\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u548Csession\u5171\u4EAB" aria-hidden="true">#</a></h1><h2 id="_1\u3001\u5B9E\u9A8C\u73AF\u5883" tabindex="-1">1\u3001\u5B9E\u9A8C\u73AF\u5883 <a class="header-anchor" href="#_1\u3001\u5B9E\u9A8C\u73AF\u5883" aria-hidden="true">#</a></h2><table><thead><tr><th style="text-align:left;">\u4E3B\u673A</th><th style="text-align:left;">IP\u5730\u5740</th></tr></thead><tbody><tr><td style="text-align:left;">Nginx</td><td style="text-align:left;">192.168.6.240</td></tr><tr><td style="text-align:left;">Tomcat-1</td><td style="text-align:left;">192.168.6.241</td></tr><tr><td style="text-align:left;">Tomcat-2</td><td style="text-align:left;">192.168.6.242</td></tr><tr><td style="text-align:left;">redis</td><td style="text-align:left;">192.168.6.244</td></tr><tr><td style="text-align:left;">mysql</td><td style="text-align:left;">192.168.6.244</td></tr></tbody></table><h2 id="_2\u3001\u5B9E\u9A8C\u62D3\u6251" tabindex="-1">2\u3001\u5B9E\u9A8C\u62D3\u6251 <a class="header-anchor" href="#_2\u3001\u5B9E\u9A8C\u62D3\u6251" aria-hidden="true">#</a></h2><p><img src="http://bak.agou-ops.top/uploads/wybl/images/m_f828a8195593973a1b8e5ef51fed7bf0_r.png" alt="null"></p><p>\u5728\u8FD9\u4E2A\u56FE\u4E2D\uFF0Cnginx\u505A\u4E3A\u53CD\u5411\u4EE3\u7406\uFF0C\u5B9E\u73B0\u9759\u52A8\u5206\u79BB\uFF0C\u5C06\u5BA2\u6237\u52A8\u6001\u8BF7\u6C42\u6839\u636E\u6743\u91CD\u968F\u673A\u5206\u914D\u7ED9\u4E24\u53F0tomcat\u670D\u52A1\u5668\uFF0Credis\u505A\u4E3A\u4E24\u53F0tomcat\u7684\u5171\u4EABsession\u6570\u636E\u670D\u52A1\u5668\uFF0Cmysql\u505A\u4E3A\u4E24\u53F0tomcat\u7684\u540E\u7AEF\u6570\u636E\u5E93\u3002</p><h2 id="_3\u3001nginx\u5B89\u88C5\u914D\u7F6E" tabindex="-1">3\u3001nginx\u5B89\u88C5\u914D\u7F6E <a class="header-anchor" href="#_3\u3001nginx\u5B89\u88C5\u914D\u7F6E" aria-hidden="true">#</a></h2><p>\u4F7F\u7528Nginx\u4F5C\u4E3ATomcat\u7684\u8D1F\u8F7D\u5E73\u8861\u5668\uFF0CTomcat\u7684\u4F1A\u8BDDSession\u6570\u636E\u5B58\u50A8\u5728Redis\uFF0C\u80FD\u591F\u5B9E\u73B0\u96F6\u5B95\u673A\u76847x24\u6548\u679C\u3002\u56E0\u4E3A\u5C06\u4F1A\u8BDD\u5B58\u50A8\u5728Redis\u4E2D\uFF0C\u56E0\u6B64Nginx\u5C31\u4E0D\u5FC5\u914D\u7F6E\u6210stick\u7C98\u8D34\u67D0\u4E2ATomcat\u65B9\u5F0F\uFF0C\u8FD9\u6837\u624D\u80FD\u771F\u6B63\u5B9E\u73B0\u540E\u53F0\u591A\u4E2ATomcat\u8D1F\u8F7D\u5E73\u8861\u3002</p><p>\u90E8\u7F72nginx\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">yum install pcre pcre-devel -y </span></span>
<span class="line"><span style="color:#DBD7CA;">yum install openssl openssl-devel -y</span></span>
<span class="line"><span style="color:#DBD7CA;">mkdir -p /home/oldboy/tools</span></span>
<span class="line"><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> /home/oldboy/tools/</span></span>
<span class="line"><span style="color:#DBD7CA;">wget -q http://nginx.org/download/nginx-1.6.2.tar.gz</span></span>
<span class="line"><span style="color:#DBD7CA;">useradd nginx -s /sbin/nologin -M</span></span>
<span class="line"><span style="color:#DBD7CA;">mkdir /application/</span></span>
<span class="line"><span style="color:#DBD7CA;">tar xf nginx-1.6.2.tar.gz </span></span>
<span class="line"><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> nginx-1.6.2</span></span>
<span class="line"><span style="color:#DBD7CA;">./configure --user=nginx --group=nginx --prefix=/application/nginx1.6.2 --with-http_stub_status_module --with-http_ssl_module --with-http_realip_module</span></span>
<span class="line"><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">?</span></span>
<span class="line"><span style="color:#DBD7CA;">make </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> make install</span></span>
<span class="line"><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">?</span></span>
<span class="line"><span style="color:#DBD7CA;">ln -s /application/nginx1.6.2/ /application/nginx</span></span>
<span class="line"><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> ../</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">yum install pcre pcre-devel -y </span></span>
<span class="line"><span style="color:#393A34;">yum install openssl openssl-devel -y</span></span>
<span class="line"><span style="color:#393A34;">mkdir -p /home/oldboy/tools</span></span>
<span class="line"><span style="color:#B58451;">cd</span><span style="color:#393A34;"> /home/oldboy/tools/</span></span>
<span class="line"><span style="color:#393A34;">wget -q http://nginx.org/download/nginx-1.6.2.tar.gz</span></span>
<span class="line"><span style="color:#393A34;">useradd nginx -s /sbin/nologin -M</span></span>
<span class="line"><span style="color:#393A34;">mkdir /application/</span></span>
<span class="line"><span style="color:#393A34;">tar xf nginx-1.6.2.tar.gz </span></span>
<span class="line"><span style="color:#B58451;">cd</span><span style="color:#393A34;"> nginx-1.6.2</span></span>
<span class="line"><span style="color:#393A34;">./configure --user=nginx --group=nginx --prefix=/application/nginx1.6.2 --with-http_stub_status_module --with-http_ssl_module --with-http_realip_module</span></span>
<span class="line"><span style="color:#B58451;">echo</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">?</span></span>
<span class="line"><span style="color:#393A34;">make </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> make install</span></span>
<span class="line"><span style="color:#B58451;">echo</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">?</span></span>
<span class="line"><span style="color:#393A34;">ln -s /application/nginx1.6.2/ /application/nginx</span></span>
<span class="line"><span style="color:#B58451;">cd</span><span style="color:#393A34;"> ../</span></span>
<span class="line"></span></code></pre></div><p>\u914D\u7F6Enginx\u53CD\u5411\u4EE3\u7406\uFF1A\u53CD\u5411\u4EE3\u7406+\u8D1F\u8F7D\u5747\u8861+\u5065\u5EB7\u63A2\u6D4B\uFF0Cnginx.conf\u6587\u4EF6\u5185\u5BB9\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cat /application/nginx/conf/nginx.conf</span></span>
<span class="line"><span style="color:#DBD7CA;">worker_processes  4</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">events </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">        worker_connections  1024</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">    http </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">        include       mime.types</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">        default_type  application/octet-stream</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">        sendfile        on</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">        keepalive_timeout  65</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">        log_format  main  </span><span style="color:#C98A7D;">&#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span></span>
<span class="line"><span style="color:#DBD7CA;">                        </span><span style="color:#C98A7D;">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span style="color:#DBD7CA;">                        </span><span style="color:#C98A7D;">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span><span style="color:#CB7676;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">    </span><span style="color:#758575;">#blog lb by oldboy at 201303</span></span>
<span class="line"><span style="color:#DBD7CA;">        upstream backend_tomcat </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#858585;">        </span><span style="color:#758575;">#ip_hash;</span></span>
<span class="line"><span style="color:#DBD7CA;">        server 192.168.6.241:8080   weight=1 max_fails=2 fail_timeout=10s</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">        server 192.168.6.242:8080   weight=1 max_fails=2 fail_timeout=10s</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#858585;">        </span><span style="color:#758575;">#server 192.168.6.243:8080   weight=1 max_fails=2 fail_timeout=10s;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">        server </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">            listen       80</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            server_name  www.98yz.cn</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            charset utf-8</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            location / </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">                root html</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">                index  index.jsp index.html index.html</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">                    </span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">            location </span><span style="color:#CB7676;">~*</span><span style="color:#DBD7CA;"> </span><span style="color:#D4976C;">\\.</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">jsp</span><span style="color:#CB7676;">|</span><span style="color:#DBD7CA;">do</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;">$ </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_pass  http://backend_tomcat</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_redirect off</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_set_header Host </span><span style="color:#858585;">$</span><span style="color:#B8A965;">host</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_set_header X-Real-IP </span><span style="color:#858585;">$</span><span style="color:#B8A965;">remote_addr</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_set_header X-Forwarded-For </span><span style="color:#858585;">$</span><span style="color:#B8A965;">proxy_add_x_forwarded_for</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">            proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">                </span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">}</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cat /application/nginx/conf/nginx.conf</span></span>
<span class="line"><span style="color:#393A34;">worker_processes  4</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">events </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">        worker_connections  1024</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">    http </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">        include       mime.types</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">        default_type  application/octet-stream</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">        sendfile        on</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">        keepalive_timeout  65</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">        log_format  main  </span><span style="color:#B56959;">&#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#B56959;">&#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span></span>
<span class="line"><span style="color:#393A34;">                        </span><span style="color:#B56959;">&#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;</span><span style="color:#AB5959;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">    </span><span style="color:#A0ADA0;">#blog lb by oldboy at 201303</span></span>
<span class="line"><span style="color:#393A34;">        upstream backend_tomcat </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#8E8F8B;">        </span><span style="color:#A0ADA0;">#ip_hash;</span></span>
<span class="line"><span style="color:#393A34;">        server 192.168.6.241:8080   weight=1 max_fails=2 fail_timeout=10s</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">        server 192.168.6.242:8080   weight=1 max_fails=2 fail_timeout=10s</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#8E8F8B;">        </span><span style="color:#A0ADA0;">#server 192.168.6.243:8080   weight=1 max_fails=2 fail_timeout=10s;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">        server </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">            listen       80</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            server_name  www.98yz.cn</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            charset utf-8</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            location / </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">                root html</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">                index  index.jsp index.html index.html</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">                    </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">            location </span><span style="color:#AB5959;">~*</span><span style="color:#393A34;"> </span><span style="color:#A65E2B;">\\.</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">jsp</span><span style="color:#AB5959;">|</span><span style="color:#393A34;">do</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;">$ </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">            proxy_pass  http://backend_tomcat</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            proxy_redirect off</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            proxy_set_header Host </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">host</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            proxy_set_header X-Real-IP </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">remote_addr</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            proxy_set_header X-Forwarded-For </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">proxy_add_x_forwarded_for</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">            proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="_4\u3001\u5B89\u88C5\u90E8\u7F72tomcat\u5E94\u7528\u7A0B\u5E8F\u670D\u52A1\u5668" tabindex="-1">4\u3001\u5B89\u88C5\u90E8\u7F72tomcat\u5E94\u7528\u7A0B\u5E8F\u670D\u52A1\u5668 <a class="header-anchor" href="#_4\u3001\u5B89\u88C5\u90E8\u7F72tomcat\u5E94\u7528\u7A0B\u5E8F\u670D\u52A1\u5668" aria-hidden="true">#</a></h2><p>\u5728tomcat-1\u548Ctomcat-2\u8282\u70B9\u4E0A\u5B89\u88C5JDK</p><p>\u5728\u5B89\u88C5tomcat\u4E4B\u524D\u5FC5\u987B\u5148\u5B89\u88C5JDK\uFF0CJDK\u7684\u5168\u79F0\u662Fjava development kit,\u662Fsun\u516C\u53F8\u514D\u8D39\u63D0\u4F9B\u7684java\u8BED\u8A00\u7684\u8F6F\u4EF6\u5F00\u53D1\u5DE5\u5177\u5305\uFF0C\u5176\u4E2D\u5305\u542Bjava\u865A\u62DF\u673A\uFF08JVM\uFF09\uFF0C\u7F16\u5199\u597D\u7684java\u6E90\u7A0B\u5E8F\u7ECF\u8FC7\u7F16\u8BD1\u53EF\u5F62\u6210java\u5B57\u8282\u7801\uFF0C\u53EA\u8981\u5B89\u88C5\u4E86JDK\uFF0C\u5C31\u53EF\u4EE5\u5229\u7528JVM\u89E3\u91CA\u8FD9\u4E9B\u5B57\u8282\u7801\u6587\u4EF6\uFF0C\u4ECE\u800C\u4FDD\u8BC1\u4E86java\u7684\u8DE8\u5E73\u53F0\u6027\u3002</p><p>\u5B89\u88C5JDK\uFF0CTomcat \u7A0B\u5E8F\uFF1A</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> yum install java -y</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> java -version</span></span>
<span class="line"><span style="color:#DBD7CA;">openjdk version </span><span style="color:#C98A7D;">&quot;1.8.0_201&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">OpenJDK Runtime Environment </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">build 1.8.0_201-b09</span><span style="color:#858585;">)</span></span>
<span class="line"><span style="color:#DBD7CA;">OpenJDK 64-Bit Server VM </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">build 25.201-b09, mixed mode</span><span style="color:#858585;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mkdir /soft/src -p</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> /soft/src</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> wget https://mirrors.aliyun.com/apache/tomcat/tomcat-9/v9.0.16/bin/apache-tomcat-9.0.16.tar.gz</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> tar xf apache-tomcat-9.0.16.tar.gz -C /soft</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> ..</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp -r apache-tomcat-9.0.16/ tomcat-8080</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 soft</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> tomcat-8080/</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> yum install java -y</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> java -version</span></span>
<span class="line"><span style="color:#393A34;">openjdk version </span><span style="color:#B56959;">&quot;1.8.0_201&quot;</span></span>
<span class="line"><span style="color:#393A34;">OpenJDK Runtime Environment </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">build 1.8.0_201-b09</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"><span style="color:#393A34;">OpenJDK 64-Bit Server VM </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">build 25.201-b09, mixed mode</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mkdir /soft/src -p</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> /soft/src</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> wget https://mirrors.aliyun.com/apache/tomcat/tomcat-9/v9.0.16/bin/apache-tomcat-9.0.16.tar.gz</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> tar xf apache-tomcat-9.0.16.tar.gz -C /soft</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> ..</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp -r apache-tomcat-9.0.16/ tomcat-8080</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 soft</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> tomcat-8080/</span></span>
<span class="line"></span></code></pre></div><p>\u6309\u7167\u76F8\u540C\u65B9\u6CD5\u5728tomcat-2\u4E5F\u5B89\u88C5</p><p>\u4E0B\u9762\u6211\u4EEC\u6765\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 tomcat-8080</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim conf/server.xml</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 tomcat-8080</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim conf/server.xml</span></span>
<span class="line"></span></code></pre></div><p>\u8BBE\u7F6E\u9ED8\u8BA4\u865A\u62DF\u4E3B\u673A\uFF0C\u5E76\u589E\u52A0jvmRoute</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Engine name=</span><span style="color:#C98A7D;">&quot;Catalina&quot;</span><span style="color:#DBD7CA;"> defaultHost=</span><span style="color:#C98A7D;">&quot;localhost&quot;</span><span style="color:#DBD7CA;"> jvmRoute=</span><span style="color:#C98A7D;">&quot;tomcat-1&quot;</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Engine name=</span><span style="color:#B56959;">&quot;Catalina&quot;</span><span style="color:#393A34;"> defaultHost=</span><span style="color:#B56959;">&quot;localhost&quot;</span><span style="color:#393A34;"> jvmRoute=</span><span style="color:#B56959;">&quot;tomcat-1&quot;</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u4FEE\u6539\u9ED8\u8BA4\u865A\u62DF\u4E3B\u673A\uFF0C\u5E76\u5C06\u7F51\u7AD9\u6587\u4EF6\u8DEF\u5F84\u6307\u5411/web/webapp1\uFF0C\u5728host\u6BB5\u589E\u52A0context\u6BB5</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Host name=</span><span style="color:#C98A7D;">&quot;localhost&quot;</span><span style="color:#DBD7CA;">  appBase=</span><span style="color:#C98A7D;">&quot;webapps&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">unpackWARs=</span><span style="color:#C98A7D;">&quot;true&quot;</span><span style="color:#DBD7CA;"> autoDeploy=</span><span style="color:#C98A7D;">&quot;true&quot;</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Context docBase=</span><span style="color:#C98A7D;">&quot;/web/webapp1&quot;</span><span style="color:#DBD7CA;"> path=</span><span style="color:#C98A7D;">&quot;&quot;</span><span style="color:#DBD7CA;"> reloadable=</span><span style="color:#C98A7D;">&quot;true&quot;</span><span style="color:#DBD7CA;">/</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/Host</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Host name=</span><span style="color:#B56959;">&quot;localhost&quot;</span><span style="color:#393A34;">  appBase=</span><span style="color:#B56959;">&quot;webapps&quot;</span></span>
<span class="line"><span style="color:#393A34;">unpackWARs=</span><span style="color:#B56959;">&quot;true&quot;</span><span style="color:#393A34;"> autoDeploy=</span><span style="color:#B56959;">&quot;true&quot;</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Context docBase=</span><span style="color:#B56959;">&quot;/web/webapp1&quot;</span><span style="color:#393A34;"> path=</span><span style="color:#B56959;">&quot;&quot;</span><span style="color:#393A34;"> reloadable=</span><span style="color:#B56959;">&quot;true&quot;</span><span style="color:#393A34;">/</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/Host</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u589E\u52A0\u6587\u6863\u76EE\u5F55\u4E0E\u6D4B\u8BD5\u6587\u4EF6</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mkdir -p /web/webapp1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> /web/webapp1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 webapp1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cat index.jsp </span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">%@page language=</span><span style="color:#C98A7D;">&quot;java&quot;</span><span style="color:#DBD7CA;"> import=</span><span style="color:#C98A7D;">&quot;java.util.*&quot;</span><span style="color:#DBD7CA;"> pageEncoding=</span><span style="color:#C98A7D;">&quot;UTF-8&quot;</span><span style="color:#DBD7CA;">%</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">html</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">head</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">title</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">tomcat-</span><span style="color:#CB7676;">1&lt;</span><span style="color:#DBD7CA;">/title</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/head</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">body</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">h1&gt;&lt;font color=</span><span style="color:#C98A7D;">&quot;red&quot;</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">Session serviced by tomcat</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/font&gt;&lt;/h</span><span style="color:#CB7676;">1&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">table aligh=</span><span style="color:#C98A7D;">&quot;center&quot;</span><span style="color:#DBD7CA;"> border=</span><span style="color:#C98A7D;">&quot;1&quot;</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">tr</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">td</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">Session ID</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/td</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">td&gt;&lt;%=session.getId</span><span style="color:#858585;">()</span><span style="color:#DBD7CA;"> %&gt;&lt;/td</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">                </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">% session.setAttribute</span><span style="color:#858585;">(</span><span style="color:#C98A7D;">&quot;abc&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;abc&quot;</span><span style="color:#858585;">)</span><span style="color:#CB7676;">;</span><span style="color:#DBD7CA;">%</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/tr</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">tr</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">td</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">Created on</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/td</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">td&gt;&lt;%= </span><span style="color:#A1B567;">session.getCreationTime</span><span style="color:#858585;">()</span><span style="color:#DBD7CA;"> %&gt;&lt;/td</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/tr</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/table</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">    tomcat-1</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/body</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">html</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mkdir -p /web/webapp1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> /web/webapp1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 webapp1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cat index.jsp </span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">%@page language=</span><span style="color:#B56959;">&quot;java&quot;</span><span style="color:#393A34;"> import=</span><span style="color:#B56959;">&quot;java.util.*&quot;</span><span style="color:#393A34;"> pageEncoding=</span><span style="color:#B56959;">&quot;UTF-8&quot;</span><span style="color:#393A34;">%</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">html</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">head</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">title</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">tomcat-</span><span style="color:#AB5959;">1&lt;</span><span style="color:#393A34;">/title</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/head</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">body</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">h1&gt;&lt;font color=</span><span style="color:#B56959;">&quot;red&quot;</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">Session serviced by tomcat</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/font&gt;&lt;/h</span><span style="color:#AB5959;">1&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">table aligh=</span><span style="color:#B56959;">&quot;center&quot;</span><span style="color:#393A34;"> border=</span><span style="color:#B56959;">&quot;1&quot;</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">tr</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">td</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">Session ID</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/td</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">td&gt;&lt;%=session.getId</span><span style="color:#8E8F8B;">()</span><span style="color:#393A34;"> %&gt;&lt;/td</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">% session.setAttribute</span><span style="color:#8E8F8B;">(</span><span style="color:#B56959;">&quot;abc&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;abc&quot;</span><span style="color:#8E8F8B;">)</span><span style="color:#AB5959;">;</span><span style="color:#393A34;">%</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/tr</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">tr</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">td</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">Created on</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/td</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">td&gt;&lt;%= </span><span style="color:#6C7834;">session.getCreationTime</span><span style="color:#8E8F8B;">()</span><span style="color:#393A34;"> %&gt;&lt;/td</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/tr</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/table</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    tomcat-1</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/body</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">html</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>Tomcat-2\u8282\u70B9\u4E0Etomcat-1\u8282\u70B9\u914D\u7F6E\u57FA\u672C\u7C7B\u4F3C\uFF0C\u53EA\u662FjvmRoute\u4E0D\u540C\uFF0C\u53E6\u5916\u4E3A\u4E86\u533A\u5206\u7531\u54EA\u4E2A\u8282\u70B9\u63D0\u4F9B\u8BBF\u95EE\uFF0C\u6D4B\u8BD5\u9875\u6807\u9898\u4E5F\u4E0D\u540C\uFF08\u751F\u4EA7\u73AF\u5883\u4E24\u4E2Atomcat\u670D\u52A1\u5668\u63D0\u4F9B\u7684\u7F51\u9875\u5185\u5BB9\u662F\u76F8\u540C\u7684\uFF09\u3002\u5176\u4ED6\u7684\u914D\u7F6E\u90FD\u76F8\u540C\u3002</p><p>\u7528\u6D4F\u89C8\u5668\u8BBF\u95EEnginx\u4E3B\u673A\uFF0C\u9A8C\u8BC1\u8D1F\u8F7D\u5747\u8861</p><p>\u9A8C\u8BC1\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5\u53EF\u4EE5\u5173\u6389\u4E00\u53F0tomcat\u4E3B\u673A\uFF0C\u7528\u5BA2\u6237\u7AEF\u6D4F\u89C8\u5668\u6D4B\u8BD5\u8BBF\u95EE\u3002</p><p>\u4ECE\u4E0A\u9762\u7684\u7ED3\u679C\u80FD\u770B\u51FA\u4E24\u6B21\u8BBF\u95EE\uFF0Cnginx\u628A\u8BBF\u95EE\u8BF7\u6C42\u5206\u522B\u5206\u53D1\u7ED9\u4E86\u540E\u7AEF\u7684tomcat-1\u548Ctomcat-2\uFF0C\u5BA2\u6237\u7AEF\u7684\u8BBF\u95EE\u8BF7\u6C42\u5B9E\u73B0\u4E86\u8D1F\u8F7D\u5747\u8861\uFF0C\u4F46sessionid\u5E76\u4E00\u6837\u3002\u6240\u4EE5\uFF0C\u5230\u8FD9\u91CC\u6211\u4EEC\u51C6\u5907\u5DE5\u4F5C\u5C31\u5168\u90E8\u5B8C\u6210\u4E86\uFF0C\u4E0B\u9762\u6211\u4EEC\u6765\u914D\u7F6Etomcat\u901A\u8FC7redis\u5B9E\u73B0\u4F1A\u8BDD\u4FDD\u6301\u3002</p><h2 id="_5\u3001\u5B89\u88C5redis" tabindex="-1">5\u3001\u5B89\u88C5redis <a class="header-anchor" href="#_5\u3001\u5B89\u88C5redis" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">sudo yum install redis-server</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">sudo yum install redis-server</span></span>
<span class="line"></span></code></pre></div><h2 id="_6\u3001\u914D\u7F6Etomcat-session-redis\u540C\u6B65" tabindex="-1">6\u3001\u914D\u7F6Etomcat session redis\u540C\u6B65 <a class="header-anchor" href="#_6\u3001\u914D\u7F6Etomcat-session-redis\u540C\u6B65" aria-hidden="true">#</a></h2><p>\u901A\u8FC7TomcatClusterRedisSessionManager\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u652F\u6301redis3.0\u7684\u96C6\u7FA4\u65B9\u5F0F \u4E0B\u8F7DTomcatRedisSessionManager-2.0.zip\u5305\uFF0C<code>https://github.com/ran-jit/tomcat-cluster-redis-session-manager</code>\uFF0C\u653E\u5230$TOMCAT_HOMA/lib\u4E0B\uFF0C\u5E76\u89E3\u538B</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 </span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> /soft/tomcat-8080/lib/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> wget https://github.com/ran-jit/tomcat-cluster-redis-session-manager/releases/download/2.0.4/tomcat-cluster-redis-session-manager.zip</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> unzip tomcat-cluster-redis-session-manager.zip </span></span>
<span class="line"><span style="color:#DBD7CA;">Archive:  tomcat-cluster-redis-session-manager.zip</span></span>
<span class="line"><span style="color:#DBD7CA;">   creating: tomcat-cluster-redis-session-manager/conf/</span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/conf/redis-data-cache.properties  </span></span>
<span class="line"><span style="color:#DBD7CA;">   creating: tomcat-cluster-redis-session-manager/lib/</span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/lib/commons-logging-1.2.jar  </span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/lib/commons-pool2-2.4.2.jar  </span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/lib/jedis-2.9.0.jar  </span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/lib/tomcat-cluster-redis-session-manager-2.0.4.jar  </span></span>
<span class="line"><span style="color:#DBD7CA;">  inflating: tomcat-cluster-redis-session-manager/readMe.txt </span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp tomcat-cluster-redis-session-manager/lib/</span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;"> ./</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp tomcat-cluster-redis-session-manager/conf/redis-data-cache.properties ../conf/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cat ../conf/redis-data-cache.properties     </span></span>
<span class="line"><span style="color:#758575;">#-- Redis data-cache configuration</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u8FDC\u7AEFredis\u6570\u636E\u5E93\u7684\u5730\u5740\u548C\u7AEF\u53E3</span></span>
<span class="line"><span style="color:#758575;">#- redis hosts ex: 127.0.0.1:6379, 127.0.0.2:6379, 127.0.0.2:6380, ....</span></span>
<span class="line"><span style="color:#DBD7CA;">redis.hosts=192.168.6.244:6379</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u8FDC\u7AEFredis\u6570\u636E\u5E93\u7684\u8FDE\u63A5\u5BC6\u7801</span></span>
<span class="line"><span style="color:#758575;">#- redis password (for stand-alone mode)</span></span>
<span class="line"><span style="color:#DBD7CA;">redis.password=pwd@123</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u662F\u5426\u652F\u6301\u96C6\u7FA4\uFF0C\u9ED8\u8BA4\u7684\u662F\u5173\u95ED</span></span>
<span class="line"><span style="color:#758575;">#- set true to enable redis cluster mode</span></span>
<span class="line"><span style="color:#DBD7CA;">redis.cluster.enabled=false</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u8FDE\u63A5redis\u7684\u90A3\u4E2A\u5E93</span></span>
<span class="line"><span style="color:#758575;">#- redis database (default 0)</span></span>
<span class="line"><span style="color:#758575;">#redis.database=0</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</span></span>
<span class="line"><span style="color:#758575;">#- redis connection timeout (default 2000)</span></span>
<span class="line"><span style="color:#758575;">#redis.timeout=2000</span></span>
<span class="line"><span style="color:#DBD7CA;">//\u5728\u8FD9\u4E2A</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Context</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">\u6807\u7B7E\u91CC\u9762\u914D\u7F6E</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node4 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim ../conf/context.xml</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Valve className=</span><span style="color:#C98A7D;">&quot;tomcat.request.session.redis.SessionHandlerValve&quot;</span><span style="color:#DBD7CA;"> /</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Manager className=</span><span style="color:#C98A7D;">&quot;tomcat.request.session.redis.SessionManager&quot;</span><span style="color:#DBD7CA;"> /</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 </span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> /soft/tomcat-8080/lib/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> wget https://github.com/ran-jit/tomcat-cluster-redis-session-manager/releases/download/2.0.4/tomcat-cluster-redis-session-manager.zip</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> unzip tomcat-cluster-redis-session-manager.zip </span></span>
<span class="line"><span style="color:#393A34;">Archive:  tomcat-cluster-redis-session-manager.zip</span></span>
<span class="line"><span style="color:#393A34;">   creating: tomcat-cluster-redis-session-manager/conf/</span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/conf/redis-data-cache.properties  </span></span>
<span class="line"><span style="color:#393A34;">   creating: tomcat-cluster-redis-session-manager/lib/</span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/lib/commons-logging-1.2.jar  </span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/lib/commons-pool2-2.4.2.jar  </span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/lib/jedis-2.9.0.jar  </span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/lib/tomcat-cluster-redis-session-manager-2.0.4.jar  </span></span>
<span class="line"><span style="color:#393A34;">  inflating: tomcat-cluster-redis-session-manager/readMe.txt </span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp tomcat-cluster-redis-session-manager/lib/</span><span style="color:#AB5959;">*</span><span style="color:#393A34;"> ./</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp tomcat-cluster-redis-session-manager/conf/redis-data-cache.properties ../conf/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cat ../conf/redis-data-cache.properties     </span></span>
<span class="line"><span style="color:#A0ADA0;">#-- Redis data-cache configuration</span></span>
<span class="line"><span style="color:#393A34;">//\u8FDC\u7AEFredis\u6570\u636E\u5E93\u7684\u5730\u5740\u548C\u7AEF\u53E3</span></span>
<span class="line"><span style="color:#A0ADA0;">#- redis hosts ex: 127.0.0.1:6379, 127.0.0.2:6379, 127.0.0.2:6380, ....</span></span>
<span class="line"><span style="color:#393A34;">redis.hosts=192.168.6.244:6379</span></span>
<span class="line"><span style="color:#393A34;">//\u8FDC\u7AEFredis\u6570\u636E\u5E93\u7684\u8FDE\u63A5\u5BC6\u7801</span></span>
<span class="line"><span style="color:#A0ADA0;">#- redis password (for stand-alone mode)</span></span>
<span class="line"><span style="color:#393A34;">redis.password=pwd@123</span></span>
<span class="line"><span style="color:#393A34;">//\u662F\u5426\u652F\u6301\u96C6\u7FA4\uFF0C\u9ED8\u8BA4\u7684\u662F\u5173\u95ED</span></span>
<span class="line"><span style="color:#A0ADA0;">#- set true to enable redis cluster mode</span></span>
<span class="line"><span style="color:#393A34;">redis.cluster.enabled=false</span></span>
<span class="line"><span style="color:#393A34;">//\u8FDE\u63A5redis\u7684\u90A3\u4E2A\u5E93</span></span>
<span class="line"><span style="color:#A0ADA0;">#- redis database (default 0)</span></span>
<span class="line"><span style="color:#A0ADA0;">#redis.database=0</span></span>
<span class="line"><span style="color:#393A34;">//\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4</span></span>
<span class="line"><span style="color:#A0ADA0;">#- redis connection timeout (default 2000)</span></span>
<span class="line"><span style="color:#A0ADA0;">#redis.timeout=2000</span></span>
<span class="line"><span style="color:#393A34;">//\u5728\u8FD9\u4E2A</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Context</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">\u6807\u7B7E\u91CC\u9762\u914D\u7F6E</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node4 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim ../conf/context.xml</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Valve className=</span><span style="color:#B56959;">&quot;tomcat.request.session.redis.SessionHandlerValve&quot;</span><span style="color:#393A34;"> /</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Manager className=</span><span style="color:#B56959;">&quot;tomcat.request.session.redis.SessionManager&quot;</span><span style="color:#393A34;"> /</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u914D\u7F6E\u4F1A\u8BDD\u5230\u671F\u65F6\u95F4\u5728../conf/web.xml</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">session-config</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">session-timeout</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">6</span><span style="color:#CB7676;">0&lt;</span><span style="color:#DBD7CA;">/session-timeout</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/session-config</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">session-config</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">session-timeout</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">6</span><span style="color:#AB5959;">0&lt;</span><span style="color:#393A34;">/session-timeout</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/session-config</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u542F\u52A8tomcat\u670D\u52A1</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@linux-node2 lib</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> ../bin/startup.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@linux-node2 lib</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> ../bin/startup.sh</span></span>
<span class="line"></span></code></pre></div><p>Tomcat-2\u8282\u70B9\u4E0Etomcat-1\u8282\u70B9\u914D\u7F6E\u76F8\u540C</p><p>\u6D4B\u8BD5\uFF0C\u6211\u4EEC\u6BCF\u6B21\u5F3A\u5237\u4ED6\u7684sessionID\u90FD\u662F\u4E00\u81F4\u7684\uFF0C\u6240\u4EE5\u6211\u4EEC\u8BA4\u4E3A\u4ED6\u7684session\u4F1A\u8BDD\u4FDD\u6301\u5DF2\u7ECF\u5B8C\u6210\uFF0C\u4F60\u4EEC\u4E5F\u53EF\u4EE5\u9009\u62E9\u6362\u4E2A\u5BA2\u6237\u7AEF\u7684IP\u5730\u5740\u6765\u6D4B\u8BD5</p><p><img src="http://bak.agou-ops.top/uploads/wybl/images/m_81e19fbb68eeeb62f6bc566d483ebed2_r.png" alt="null"><img src="http://bak.agou-ops.top/uploads/wybl/images/m_33df9e5ad7721d74c0ffe5478e63b506_r.png" alt="null"></p><blockquote><p>\u8F6C\u8F7D\uFF1A\u8BE5\u6587\u7AE0\u6765\u6E90\u4E8E\u7F51\u7EDC\uFF0C\u4EC5\u505A\u4FEE\u6539\u3002</p></blockquote>`,43),e=[o];function t(c,r,y,i,A,B){return n(),a("div",null,e)}var C=s(p,[["render",t]]);export{D as __pageData,C as default};
