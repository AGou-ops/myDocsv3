import{_ as s,o as n,c as a,a as l}from"./app.1e6146c3.js";const C=JSON.parse('{"title":"\u5341\u516B \u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E","description":"","frontmatter":{},"headers":[{"level":2,"title":"18.1 \u8282\u70B9\u9009\u62E9\u5668","slug":"_18-1-\u8282\u70B9\u9009\u62E9\u5668"},{"level":2,"title":"18.2 \u5BF9\u8282\u70B9\u7684\u4EB2\u548C\u6027","slug":"_18-2-\u5BF9\u8282\u70B9\u7684\u4EB2\u548C\u6027"},{"level":2,"title":"18.3 \u5BF9 POD \u7684\u4EB2\u548C\u6027","slug":"_18-3-\u5BF9-pod-\u7684\u4EB2\u548C\u6027"},{"level":2,"title":"18.4 \u5BF9 POD \u7684\u53CD\u4EB2\u548C\u6027","slug":"_18-4-\u5BF9-pod-\u7684\u53CD\u4EB2\u548C\u6027"},{"level":2,"title":"18.5 node \u6C61\u70B9","slug":"_18-5-node-\u6C61\u70B9"},{"level":2,"title":"18.6 POD \u6C61\u70B9\u5BB9\u5FCD","slug":"_18-6-pod-\u6C61\u70B9\u5BB9\u5FCD"}],"relativePath":"CloudNative/k8s/Quicklystart/\u5341\u516B \u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E.md","lastUpdated":1657272051000}'),p={name:"CloudNative/k8s/Quicklystart/\u5341\u516B \u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E.md"},o=l(`<h1 id="\u5341\u516B-\u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E" tabindex="-1">\u5341\u516B \u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E <a class="header-anchor" href="#\u5341\u516B-\u9AD8\u7EA7\u8C03\u5EA6\u8BBE\u7F6E" aria-hidden="true">#</a></h1><p>\u8282\u70B9\u9009\u62E9\u5668\uFF1Anodeselector\u3001nodeName</p><p>\u8282\u70B9\u4EB2\u548C\u8C03\u5EA6\uFF1AnodeAffinity</p><h2 id="_18-1-\u8282\u70B9\u9009\u62E9\u5668" tabindex="-1">18.1 \u8282\u70B9\u9009\u62E9\u5668 <a class="header-anchor" href="#_18-1-\u8282\u70B9\u9009\u62E9\u5668" aria-hidden="true">#</a></h2><ul><li>\u4F7F\u7528 nodeselector \u6765\u5C06\u9884\u9009\u8303\u56F4\u7F29\u5C0F\uFF0C\u6CA1\u6709\u88AB nodeselector \u9009\u4E2D\u7684\u8282\u70B9\u5C06\u88AB\u9884\u9009\u9636\u6BB5\u6DD8\u6C70</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod-schedule-demo</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">nodeSelector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">gpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ok</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod-schedule-demo</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">nodeSelector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">gpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ok</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6B64\u65F6\u5982\u679C\u6CA1\u6709\u4EFB\u4F55\u4E00\u4E2A\u8282\u70B9\u6709 gpu \u8FD9\u4E2A\u6807\u7B7E\uFF0C\u90A3\u4E48\u8FD9\u4E2A POD \u7684\u8C03\u5EA6\u5C06\u4F1A\u88AB\u6302\u8D77\uFF0CPending \u72B6\u6001\uFF0C\u76F4\u5230\u6EE1\u8DB3\u6761\u4EF6</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl label nodes node2 gpu=ok --overwrite</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl label nodes node2 gpu=ok --overwrite</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B POD \u88AB\u8C03\u5EA6\u7684\u8282\u70B9\uFF0CPOD \u5DF2\u7ECF\u88AB\u8C03\u5EA6\u5230 node2 \u8282\u70B9\u4E86</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl get pods -o wide</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl get pods -o wide</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-2-\u5BF9\u8282\u70B9\u7684\u4EB2\u548C\u6027" tabindex="-1">18.2 \u5BF9\u8282\u70B9\u7684\u4EB2\u548C\u6027 <a class="header-anchor" href="#_18-2-\u5BF9\u8282\u70B9\u7684\u4EB2\u548C\u6027" aria-hidden="true">#</a></h2><p>\u4EB2\u548C\u6027\u5B9A\u4E49\uFF0C\u8BE6\u89C1\uFF1Akubectl explain pods.spec.affinity.nodeAffinity</p><ul><li>POD \u5BF9\u8282\u70B9\u4EB2\u548C\u6027\u5B9A\u4E49</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">nodeAffinity             </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># POD \u5BF9 node \u8282\u70B9\u7684\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">  preferredDuringSchedulingIgnoredDuringExecution  </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">    preference           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u4EB2\u548C\u7684\u8282\u70B9\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#DBD7CA;">      matchExpressions   </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u67E5\u627E\u8868\u8FBE\u5F0F</span></span>
<span class="line"><span style="color:#DBD7CA;">        key              </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        operator         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        values           </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">      matchFields        </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u67E5\u627E\u5B57\u6BB5</span></span>
<span class="line"><span style="color:#DBD7CA;">        key              </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        operator         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        values           </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">    weight               </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">integer</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                               </span><span style="color:#758575;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#DBD7CA;">  requiredDuringSchedulingIgnoredDuringExecution   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">      </span><span style="color:#758575;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">    nodeSelectorTerms    </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">      matchExpressions   </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">        key              </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        operator         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        values           </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">      matchFields        </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">Object</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u67E5\u627E\u5B57\u6BB5</span></span>
<span class="line"><span style="color:#DBD7CA;">        key              </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        operator         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        values           </span><span style="color:#CB7676;">&lt;</span><span style="color:#858585;">[]</span><span style="color:#DBD7CA;">string</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">nodeAffinity             </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># POD \u5BF9 node \u8282\u70B9\u7684\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">  preferredDuringSchedulingIgnoredDuringExecution  </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">    preference           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u7684\u8282\u70B9\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393A34;">      matchExpressions   </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u67E5\u627E\u8868\u8FBE\u5F0F</span></span>
<span class="line"><span style="color:#393A34;">        key              </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        operator         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        values           </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">      matchFields        </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u67E5\u627E\u5B57\u6BB5</span></span>
<span class="line"><span style="color:#393A34;">        key              </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        operator         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        values           </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">    weight               </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">integer</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                               </span><span style="color:#A0ADA0;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#393A34;">  requiredDuringSchedulingIgnoredDuringExecution   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">      </span><span style="color:#A0ADA0;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#393A34;">    nodeSelectorTerms    </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">      matchExpressions   </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">        key              </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        operator         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        values           </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">      matchFields        </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">Object</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u67E5\u627E\u5B57\u6BB5</span></span>
<span class="line"><span style="color:#393A34;">        key              </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        operator         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        values           </span><span style="color:#AB5959;">&lt;</span><span style="color:#8E8F8B;">[]</span><span style="color:#393A34;">string</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"></span></code></pre></div><ul><li>\u793A\u4F8B\u914D\u7F6E</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod-nodeaffinity1-demo</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">affinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">nodeAffinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">        </span><span style="color:#758575;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u5C31 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">nodeSelectorTerms</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">matchExpressions</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">key</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">zone</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">operator</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">In</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">values</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">foo</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">bar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod-nodeaffinity2-demo</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">affinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">nodeAffinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">preferredDuringSchedulingIgnoredDuringExecution</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">     </span><span style="color:#758575;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u4E5F\u53EF\u4EE5\u5BF9\u51D1</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">preference</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">matchExpressions</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">key</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">zone</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">operator</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">In</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">values</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">foo</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">bar</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">weight</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">50</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod-nodeaffinity1-demo</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">affinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">nodeAffinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">        </span><span style="color:#A0ADA0;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u5C31 Pending</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">nodeSelectorTerms</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">matchExpressions</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">key</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">zone</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">operator</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">In</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">values</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">foo</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">bar</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod-nodeaffinity2-demo</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">affinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">nodeAffinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">preferredDuringSchedulingIgnoredDuringExecution</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">     </span><span style="color:#A0ADA0;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u4E5F\u53EF\u4EE5\u5BF9\u51D1</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">preference</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">matchExpressions</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">key</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">zone</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">operator</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">In</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">values</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">foo</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">bar</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">weight</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">50</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">NAME                     READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">pod-nodeaffinity1-demo   0/1     Pending   0          6m16s  </span><span style="color:#758575;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u6CA1\u6709\u5C31\u7B49\u5F85</span></span>
<span class="line"><span style="color:#DBD7CA;">pod-nodeaffinity2-demo   1/1     Running   0          7s     </span><span style="color:#758575;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u6CA1\u6709\u5408\u9002\u4E3B\u673A\u4E5F\u53EF\u4EE5\u51D1\u548C</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">NAME                     READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">pod-nodeaffinity1-demo   0/1     Pending   0          6m16s  </span><span style="color:#A0ADA0;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u6CA1\u6709\u5C31\u7B49\u5F85</span></span>
<span class="line"><span style="color:#393A34;">pod-nodeaffinity2-demo   1/1     Running   0          7s     </span><span style="color:#A0ADA0;"># \u8F6F\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u6CA1\u6709\u5408\u9002\u4E3B\u673A\u4E5F\u53EF\u4EE5\u51D1\u548C</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-3-\u5BF9-pod-\u7684\u4EB2\u548C\u6027" tabindex="-1">18.3 \u5BF9 POD \u7684\u4EB2\u548C\u6027 <a class="header-anchor" href="#_18-3-\u5BF9-pod-\u7684\u4EB2\u548C\u6027" aria-hidden="true">#</a></h2><p>POD \u548C POD \u51FA\u4E8E\u9AD8\u6548\u7684\u901A\u4FE1\u8FD9\u79CD\u9700\u6C42\uFF0C\u6240\u4EE5\u9700\u8981\u5C06 POD \u548C POD \u7EC4\u7EC7\u5728\u540C\u4E00\u53F0\u673A\u5668\uFF0C\u540C\u4E00\u4E2A\u673A\u623F\uFF0C\u4F8B\u5982\uFF1ALNMT \u5982\u679C\u80FD\u8FD0\u884C\u5728\u540C\u4E00\u4E2A\u4E3B\u673A\u4E0A\u66F4\u597D\u3002</p><ol><li><p>\u60F3\u628A\u4E00\u7EC4 POD \u8FD0\u884C\u5728\u4E00\u8D77\uFF0C\u4F7F\u7528\u8282\u70B9\u4EB2\u548C\u6027\u5C31\u53EF\u4EE5\u5B9E\u73B0\uFF0C\u4E3A\u4E86\u8FBE\u6210\u8FD9\u4E2A\u76EE\u7684\uFF0C\u6211\u4EEC\u9700\u8981\uFF1A\u628A\u8282\u70B9\u6807\u7B7E\u7CBE\u5FC3\u7F16\u6392\uFF0C\u5E0C\u671B\u5728\u4E00\u8D77\u8FD0\u884C\u7684 POD\uFF0C\u5C31\u4F7F\u7528\u540C\u4E00\u7EC4\u6807\u7B7E\u9009\u62E9\u5668\u6765\u9009\u62E9\u8282\u70B9\uFF0C\u8FD9\u79CD\u65B9\u5F0F\u9700\u8981\u7BA1\u7406\u8282\u70B9\u6807\u7B7E\u548C POD \u4EB2\u548C\u6027\u624D\u80FD\u505A\u5230\u3002</p></li><li><p>\u60F3\u628A\u4E00\u7EC4 POD \u8FD0\u884C\u5728\u4E00\u8D77\uFF0C\u4F7F\u7528 POD \u4EB2\u548C\u6027\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8BBE\u7F6E POD \u5BF9\u67D0\u4E2A POD \u7684\u4EB2\u548C\u6027\uFF0C\u90A3\u4E48\u6BD4\u5982\uFF1ALNMT\uFF0C\u90A3\u4E48 MySQL \u548C Tomcat \u53EF\u4EE5\u8BBE\u7F6E\u4E3A\u66F4\u52A0\u4EB2\u548C Ngninx \u6240\u5728\u7684\u4E3B\u673A\u6216\u673A\u67DC\uFF0C\u6240\u4EE5\u5FC5\u987B\u6709\u4E2A\u524D\u63D0\u5C31\u662F POD \u548C POD \u600E\u4E48\u624D\u662F\u6700\u8FD1\u7684\uFF0C\u8FD9\u4E2A\u6807\u51C6\u662F\u4EC0\u4E48\uFF0C\u4E5F\u5C31\u662F\u4EC0\u4E48\u662F\u540C\u4E00\u4F4D\u7F6E\uFF0C\u600E\u4E48\u624D\u80FD\u77E5\u9053 node \u548C node \u662F\u5728\u4E00\u4E2A\u673A\u67DC\u3002</p><p>\u6240\u4EE5\u53EF\u4EE5\u4E3A\u540C\u4E00\u4E2A\u673A\u67DC\u7684 node \u8282\u70B9\u6253\u4E0A\u76F8\u540C\u7684\u6807\u7B7E\u3002</p></li><li><p>MySQL \u548C Tomcat \u4E00\u5B9A\u4E0D\u80FD\u548C Nginx \u8FD0\u884C\u5728\u4E00\u8D77\uFF0C\u8FD9\u5C31\u662F\u53CD\u4EB2\u548C\u6027\u3002</p></li></ol><ul><li>POD \u5BF9\u5176\u4ED6 POD \u7684\u4EB2\u548C\u6027\uFF0C\u8BE6\u89C1\uFF1Akubectl explain pods.spec.affinity.podAffinity</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">podAffinity                &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># POD \u5BF9\u5176\u4ED6 POD \u7684\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">preferredDuringSchedulingIgnoredDuringExecution  &lt;[]Object&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u8F6F\u6027\u4EB2\u548C\u6027\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">podAffinityTerm        &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u4EB2\u548C\u7684 POD \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">labelSelector        &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">key              &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">operator         &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">values           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#DBD7CA;">                   </span><span style="color:#758575;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">namespaces           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">topologyKey	       &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">weight                 &lt;integer&gt;</span><span style="color:#DBD7CA;">                             </span><span style="color:#758575;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">requiredDuringSchedulingIgnoredDuringExecution   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u786C\u6027\u4EB2\u548C\u6027\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">labelSelector          &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">key              &lt;string&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">operator         &lt;string&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">values           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#DBD7CA;">                     </span><span style="color:#758575;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">namespaces             &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">topologyKey            &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">podAffinity                &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># POD \u5BF9\u5176\u4ED6 POD \u7684\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">preferredDuringSchedulingIgnoredDuringExecution  &lt;[]Object&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u8F6F\u6027\u4EB2\u548C\u6027\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">podAffinityTerm        &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u7684 POD \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">labelSelector        &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">key              &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">operator         &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">values           &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#393A34;">                   </span><span style="color:#A0ADA0;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">namespaces           &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">topologyKey	       &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">weight                 &lt;integer&gt;</span><span style="color:#393A34;">                             </span><span style="color:#A0ADA0;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">requiredDuringSchedulingIgnoredDuringExecution   &lt;[]Object&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u786C\u6027\u4EB2\u548C\u6027\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">labelSelector          &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">key              &lt;string&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">operator         &lt;string&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">values           &lt;[]string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#393A34;">                     </span><span style="color:#A0ADA0;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">namespaces             &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">topologyKey            &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"></span></code></pre></div><ul><li>\u793A\u4F8B\u914D\u7F6E</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">tier</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">frontend</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod2</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">db</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">tier</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">db</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">busybox</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">busybox:latest</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">IfNotPresent</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">command</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;sh&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;sleep 3600&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">affinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">podAffinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">   </span><span style="color:#758575;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u7684 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">labelSelector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">matchExpressions</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">key</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">app</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">operator</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">In</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">values</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">topologyKey</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">kubernetes.io/hostname</span><span style="color:#DBD7CA;">             </span><span style="color:#758575;"># \u4EB2\u548C\u6027\u7684\u4F9D\u636E\u4E3A\u540C\u4E00\u4E2A\u4E3B\u673A\u540D\u5219\u4EB2\u548C</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">tier</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">frontend</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod2</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">db</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">tier</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">db</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">busybox</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">busybox:latest</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">IfNotPresent</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">command</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;sh&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;sleep 3600&quot;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">affinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">podAffinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">   </span><span style="color:#A0ADA0;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u7684 Pending</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">labelSelector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">matchExpressions</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">key</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">app</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">operator</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">In</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">values</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">topologyKey</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">kubernetes.io/hostname</span><span style="color:#393A34;">             </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u6027\u7684\u4F9D\u636E\u4E3A\u540C\u4E00\u4E2A\u4E3B\u673A\u540D\u5219\u4EB2\u548C</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods -o wide</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">NAME   READY   STATUS    RESTARTS   AGE     IP           NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#DBD7CA;">pod1   1/1     Running   0          3m33s   10.244.2.4   node3   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">pod2   1/1     Running   0          3m33s   10.244.2.5   node3   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">NAME   READY   STATUS    RESTARTS   AGE     IP           NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#393A34;">pod1   1/1     Running   0          3m33s   10.244.2.4   node3   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">pod2   1/1     Running   0          3m33s   10.244.2.5   node3   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-4-\u5BF9-pod-\u7684\u53CD\u4EB2\u548C\u6027" tabindex="-1">18.4 \u5BF9 POD \u7684\u53CD\u4EB2\u548C\u6027 <a class="header-anchor" href="#_18-4-\u5BF9-pod-\u7684\u53CD\u4EB2\u548C\u6027" aria-hidden="true">#</a></h2><ul><li>POD \u5BF9\u5176\u4ED6 POD \u7684\u53CD\u4EB2\u548C\u6027\uFF0C\u8BE6\u89C1\uFF1Akubectl explain pods.spec.affinity.podAntiAffinity</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">podAntiAffinity              &lt;Object&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># POD \u5BF9\u5176\u4ED6 POD \u7684\u53CD\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">preferredDuringSchedulingIgnoredDuringExecution  &lt;[]Object&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u8F6F\u6027\u53CD\u4EB2\u548C\u6027\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">podAffinityTerm        &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u53CD\u4EB2\u548C\u7684 POD \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">labelSelector        &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">key              &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">operator         &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#C98A7D;">values           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#DBD7CA;">                   </span><span style="color:#758575;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">namespaces           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">topologyKey	       &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">weight                 &lt;integer&gt;</span><span style="color:#DBD7CA;">                             </span><span style="color:#758575;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">requiredDuringSchedulingIgnoredDuringExecution   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u786C\u6027\u53CD\u4EB2\u548C\u6027\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">labelSelector          &lt;Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">key              &lt;string&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">operator         &lt;string&gt;</span><span style="color:#DBD7CA;">                                </span><span style="color:#758575;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#C98A7D;">values           &lt;[]string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#C98A7D;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#DBD7CA;">                     </span><span style="color:#758575;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">namespaces             &lt;[]string&gt;</span><span style="color:#DBD7CA;">                            </span><span style="color:#758575;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">topologyKey            &lt;string&gt;</span><span style="color:#DBD7CA;">                              </span><span style="color:#758575;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">podAntiAffinity              &lt;Object&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># POD \u5BF9\u5176\u4ED6 POD \u7684\u53CD\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">preferredDuringSchedulingIgnoredDuringExecution  &lt;[]Object&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u8F6F\u6027\u53CD\u4EB2\u548C\u6027\uFF0C\u5C3D\u91CF\u6EE1\u8DB3\u4EB2\u548C\u6027</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">podAffinityTerm        &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u53CD\u4EB2\u548C\u7684 POD \u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">labelSelector        &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">key              &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">operator         &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#B56959;">values           &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#393A34;">                   </span><span style="color:#A0ADA0;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">namespaces           &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">topologyKey	       &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">weight                 &lt;integer&gt;</span><span style="color:#393A34;">                             </span><span style="color:#A0ADA0;"># \u6743\u91CD 1 - 100</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">requiredDuringSchedulingIgnoredDuringExecution   &lt;[]Object&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u786C\u6027\u53CD\u4EB2\u548C\u6027\uFF0C\u4E0D\u6EE1\u8DB3\u5219 Pending</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">labelSelector          &lt;Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">matchExpressions   &lt;[]Object&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u6807\u7B7E\u9009\u62E9\u5668\u5BF9\u8C61\uFF0C\u9009 POD \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">key              &lt;string&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u6807\u7B7E</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">operator         &lt;string&gt;</span><span style="color:#393A34;">                                </span><span style="color:#A0ADA0;"># \u64CD\u4F5C\uFF1A\u6BD4\u8F83</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#B56959;">values           &lt;[]string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B56959;">matchLabels        &lt;map[string]string&gt;</span><span style="color:#393A34;">                     </span><span style="color:#A0ADA0;"># \u96C6\u5408\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">namespaces             &lt;[]string&gt;</span><span style="color:#393A34;">                            </span><span style="color:#A0ADA0;"># \u540D\u79F0\u7A7A\u95F4\u7684\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">topologyKey            &lt;string&gt;</span><span style="color:#393A34;">                              </span><span style="color:#A0ADA0;"># \u4EB2\u548C\u5224\u65AD\u6761\u4EF6</span></span>
<span class="line"></span></code></pre></div><ul><li>\u914D\u7F6E\u6E05\u5355</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod3</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">tier</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">frontend</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Pod</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">pod4</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">db</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">tier</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">db</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">busybox</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">busybox:latest</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">IfNotPresent</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">command</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;sh&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;sleep 3600&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">affinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">podAntiAffinity</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">   </span><span style="color:#758575;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u7684 Pending</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">labelSelector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">matchExpressions</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">key</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">app</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">operator</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">In</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">values</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">topologyKey</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">kubernetes.io/hostname</span><span style="color:#DBD7CA;">             </span><span style="color:#758575;"># \u53CD\u4EB2\u548C\u6027\u7684\u4F9D\u636E\u4E3A\u540C\u4E00\u4E2A\u4E3B\u673A\u540D</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod3</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">tier</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">frontend</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Pod</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">pod4</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">db</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">tier</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">db</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">busybox</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">busybox:latest</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">IfNotPresent</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">command</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;sh&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;sleep 3600&quot;</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">affinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">podAntiAffinity</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">requiredDuringSchedulingIgnoredDuringExecution</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">   </span><span style="color:#A0ADA0;"># \u786C\u4EB2\u548C\u6027\u8981\u6C42\uFF0C\u4E0D\u6EE1\u8DB3\u7684 Pending</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">labelSelector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">matchExpressions</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">key</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">app</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">operator</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">In</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">values</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">topologyKey</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">kubernetes.io/hostname</span><span style="color:#393A34;">             </span><span style="color:#A0ADA0;"># \u53CD\u4EB2\u548C\u6027\u7684\u4F9D\u636E\u4E3A\u540C\u4E00\u4E2A\u4E3B\u673A\u540D</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-5-node-\u6C61\u70B9" tabindex="-1">18.5 node \u6C61\u70B9 <a class="header-anchor" href="#_18-5-node-\u6C61\u70B9" aria-hidden="true">#</a></h2><p>\u6C61\u70B9\u53EA\u7528\u5728 node \u4E0A\u7684\u952E\u503C\u5C5E\u6027\uFF08nodes.spec.taints\uFF09\uFF0C\u5B83\u7684\u4F5C\u7528\u662F\u62D2\u7EDD\u4E0D\u80FD\u5BB9\u5FCD\u8FD9\u4E9B\u6C61\u70B9\u7684 POD \u8FD0\u884C\u7684\uFF0C\u56E0\u6B64\u9700\u8981\u5728 POD \u4E0A\u5B9A\u4E49\u5BB9\u5FCD\u5EA6\uFF08pods.spec.tolerations\uFF09\uFF0C\u5B83\u4E5F\u662F\u952E\u503C\u6570\u636E\uFF0C\u662F\u4E00\u4E2A\u5217\u8868\uFF0C\u8868\u793A POD \u53EF\u4EE5\u5BB9\u5FCD\u7684\u6C61\u70B9\u5217\u8868\u3002</p><p>\u4E00\u4E2A POD \u80FD\u4E0D\u80FD\u8FD0\u884C\u5728\u4E00\u4E2A\u8282\u70B9\u4E0A\uFF0C\u5C31\u662F pods.spec.tolerations \u5217\u8868\u4E2D\u662F\u5426\u5305\u62EC\u4E86 nodes.spec.taints \u4E2D\u7684\u6570\u636E\u3002</p><ul><li>node \u6C61\u70B9\u6E05\u5355\u683C\u5F0F\uFF0C\u8BE6\u89C1\uFF1Akubectl explain node.spec.taints</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">taints          &lt;[]Object&gt;</span><span style="color:#DBD7CA;">     </span><span style="color:#758575;"># \u6C61\u70B9\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">effect        &lt;string&gt;</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;"># \u5F53 POD \u4E0D\u80FD\u5BB9\u5FCD\u8FD9\u4E2A\u6C61\u70B9\u7684\u65F6\u5019\uFF0C\u8981\u91C7\u53D6\u7684\u884C\u4E3A\uFF0C\u4E5F\u5C31\u662F\u6392\u65A5\u4E0D\u5BB9\u5FCD\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">NoSchedule</span><span style="color:#DBD7CA;">                 </span><span style="color:#758575;"># \u5F71\u54CD\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u4F46\u662F\u5DF2\u7ECF\u8C03\u5EA6\u5B8C\u6210 POD \u65E0\u5F71\u54CD</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">PreferNoSchedule</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;"># \u5F71\u54CD\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u5C1D\u8BD5\u9A71\u9010\u8C03\u5EA6\u5DF2\u7ECF\u5B8C\u6210\u7684\u4F46\u4E0D\u5BB9\u5FCD\u65B0\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">NoExecute</span><span style="color:#DBD7CA;">                  </span><span style="color:#758575;"># \u65B0\u589E\u7684\u6C61\u70B9\uFF0C\u5F71\u54CD\u65B0\u7684\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u4E14\u5F3A\u529B\u9A71\u9010\u8C03\u5EA6\u5DF2\u7ECF\u5B8C\u6210\u7684\u4F46\u4E0D\u5BB9\u5FCD\u65B0\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">key           &lt;string&gt;</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;"># \u952E</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">timeAdded     &lt;string&gt;</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;"># </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">value         &lt;string&gt;</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;"># \u503C</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">taints          &lt;[]Object&gt;</span><span style="color:#393A34;">     </span><span style="color:#A0ADA0;"># \u6C61\u70B9\u5BF9\u8C61\u5217\u8868</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">effect        &lt;string&gt;</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;"># \u5F53 POD \u4E0D\u80FD\u5BB9\u5FCD\u8FD9\u4E2A\u6C61\u70B9\u7684\u65F6\u5019\uFF0C\u8981\u91C7\u53D6\u7684\u884C\u4E3A\uFF0C\u4E5F\u5C31\u662F\u6392\u65A5\u4E0D\u5BB9\u5FCD\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">NoSchedule</span><span style="color:#393A34;">                 </span><span style="color:#A0ADA0;"># \u5F71\u54CD\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u4F46\u662F\u5DF2\u7ECF\u8C03\u5EA6\u5B8C\u6210 POD \u65E0\u5F71\u54CD</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">PreferNoSchedule</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;"># \u5F71\u54CD\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u5C1D\u8BD5\u9A71\u9010\u8C03\u5EA6\u5DF2\u7ECF\u5B8C\u6210\u7684\u4F46\u4E0D\u5BB9\u5FCD\u65B0\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">NoExecute</span><span style="color:#393A34;">                  </span><span style="color:#A0ADA0;"># \u65B0\u589E\u7684\u6C61\u70B9\uFF0C\u5F71\u54CD\u65B0\u7684\u8C03\u5EA6\u8FC7\u7A0B\uFF0C\u4E14\u5F3A\u529B\u9A71\u9010\u8C03\u5EA6\u5DF2\u7ECF\u5B8C\u6210\u7684\u4F46\u4E0D\u5BB9\u5FCD\u65B0\u6C61\u70B9\u7684 POD</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">key           &lt;string&gt;</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;"># \u952E</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">timeAdded     &lt;string&gt;</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;"># </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">value         &lt;string&gt;</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;"># \u503C</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7ED9 node \u6253\u4E0A\u6C61\u70B9\uFF0C\u952E\u4E3A node-type \u503C\u4E3A production\uFF0C\u6C61\u70B9\u52A8\u4F5C</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl taint node node2 node-type=production:NoSchedule</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl taint node node2 node-type=production:NoSchedule</span></span>
<span class="line"></span></code></pre></div><ul><li>\u5220\u9664 node \u4E0A\u7684\u4E00\u4E2A\u6C61\u70B9</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl taint node node2 node-type-</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl taint node node2 node-type-</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6D4B\u8BD5\u6E05\u5355</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp-deploy</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">4</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">release</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">canary</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">release</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">canary</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v2</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http</span></span>
<span class="line"><span style="color:#DBD7CA;">              </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">80</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp-deploy</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">4</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">release</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">canary</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">release</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">canary</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v2</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http</span></span>
<span class="line"><span style="color:#393A34;">              </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">80</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods -o wide\uFF0C\u56E0\u4E3A POD \u6CA1\u6709\u5B9A\u4E49\u5BB9\u5FCD node2 \u7684\u6C61\u70B9</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">NAME                            READY   STATUS    RESTARTS   AGE   IP            NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-675558bfc5-4x5cf   1/1     Running   0          9s    10.244.2.13   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-675558bfc5-58f2s   1/1     Running   0          9s    10.244.2.10   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-675558bfc5-gz4kv   1/1     Running   0          9s    10.244.2.12   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-675558bfc5-hlxdd   1/1     Running   0          9s    10.244.2.11   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">NAME                            READY   STATUS    RESTARTS   AGE   IP            NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-675558bfc5-4x5cf   1/1     Running   0          9s    10.244.2.13   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-675558bfc5-58f2s   1/1     Running   0          9s    10.244.2.10   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-675558bfc5-gz4kv   1/1     Running   0          9s    10.244.2.12   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-675558bfc5-hlxdd   1/1     Running   0          9s    10.244.2.11   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6B64\u65F6\u7ED9 node3 \u4E5F\u6253\u4E0A\u6C61\u70B9\uFF0C\u5E76\u9A71\u9010\u539F\u6709\u7684 POD</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl taint node node3 node-type=dev:NoExecute</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl taint node node3 node-type=dev:NoExecute</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods -o wide\uFF0C\u56E0\u4E3A node3 \u65B0\u589E\u7684\u6C61\u70B9\u9A71\u9010\u4E86\u4E0D\u80FD\u5BB9\u5FCD\u6C61\u70B9\u7684 POD \uFF0C\u6240\u4EE5 POD \u88AB\u6302\u8D77</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">NAME                            READY   STATUS    RESTARTS   AGE   IP       NODE     NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-675558bfc5-22wpj   0/1     Pending   0          10s   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-675558bfc5-lctv5   0/1     Pending   0          14s   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-675558bfc5-m5qdh   0/1     Pending   0          15s   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-675558bfc5-z8c4q   0/1     Pending   0          14s   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">NAME                            READY   STATUS    RESTARTS   AGE   IP       NODE     NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-675558bfc5-22wpj   0/1     Pending   0          10s   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-675558bfc5-lctv5   0/1     Pending   0          14s   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-675558bfc5-m5qdh   0/1     Pending   0          15s   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-675558bfc5-z8c4q   0/1     Pending   0          14s   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-6-pod-\u6C61\u70B9\u5BB9\u5FCD" tabindex="-1">18.6 POD \u6C61\u70B9\u5BB9\u5FCD <a class="header-anchor" href="#_18-6-pod-\u6C61\u70B9\u5BB9\u5FCD" aria-hidden="true">#</a></h2><ul><li>POD \u5BB9\u5FCD\u5EA6\uFF0C\u8BE6\u89C1\uFF1Akubectl explain pods.spec.tolerations</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">tolerations            &lt;[]Object&gt;</span><span style="color:#DBD7CA;">    </span><span style="color:#758575;"># \u5BB9\u5FCD\u5EA6\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">effect               &lt;string&gt;</span><span style="color:#DBD7CA;">      </span><span style="color:#758575;"># \u80FD\u5426\u5BB9\u5FCD node \u4E0A\u7684\u6C61\u70B9\u9A71\u9010\u7B56\u7565\uFF0C\u4E3A\u7A7A\u8868\u793A\u5BB9\u5FCD\u4EFB\u4F55\u9A71\u9010\u7B56\u7565</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">NoSchedule</span><span style="color:#DBD7CA;">                       </span><span style="color:#758575;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 NoSchedule</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">PreferNoSchedule</span><span style="color:#DBD7CA;">                 </span><span style="color:#758575;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 PreferNoSchedule</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#C98A7D;">NoExecute</span><span style="color:#DBD7CA;">                        </span><span style="color:#758575;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 NoExecute</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">key                  &lt;string&gt;</span><span style="color:#DBD7CA;">      </span><span style="color:#758575;"># \u6C61\u70B9\u7684\u952E</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">operator             &lt;string&gt;</span><span style="color:#DBD7CA;">      </span><span style="color:#758575;"># Exists \u6C61\u70B9\u5B58\u5728\u4E0D\u7BA1\u4EC0\u4E48\u503C\uFF0CEqual \u6C61\u70B9\u7684\u503C\u5FC5\u987B\u7B49\u503C</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">tolerationSeconds    &lt;integer&gt;</span><span style="color:#DBD7CA;">     </span><span style="color:#758575;"># \u5BB9\u5FCD\u65F6\u95F4\uFF0C\u5373\u5982\u679C\u88AB\u9A71\u9010\uFF0C\u53EF\u4EE5\u7B49\u591A\u4E45\u518D\u8D70\uFF0C\u9ED8\u8BA4 0 \u79D2\uFF0CNoExecute \u4F7F\u7528</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">value                &lt;string&gt;</span><span style="color:#DBD7CA;">      </span><span style="color:#758575;"># \u6C61\u70B9\u7684\u503C</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">tolerations            &lt;[]Object&gt;</span><span style="color:#393A34;">    </span><span style="color:#A0ADA0;"># \u5BB9\u5FCD\u5EA6\u5BF9\u8C61</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">effect               &lt;string&gt;</span><span style="color:#393A34;">      </span><span style="color:#A0ADA0;"># \u80FD\u5426\u5BB9\u5FCD node \u4E0A\u7684\u6C61\u70B9\u9A71\u9010\u7B56\u7565\uFF0C\u4E3A\u7A7A\u8868\u793A\u5BB9\u5FCD\u4EFB\u4F55\u9A71\u9010\u7B56\u7565</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">NoSchedule</span><span style="color:#393A34;">                       </span><span style="color:#A0ADA0;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 NoSchedule</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">PreferNoSchedule</span><span style="color:#393A34;">                 </span><span style="color:#A0ADA0;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 PreferNoSchedule</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B56959;">NoExecute</span><span style="color:#393A34;">                        </span><span style="color:#A0ADA0;"># \u80FD\u5BB9\u5FCD node \u6C61\u70B9\u7684 NoExecute</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">key                  &lt;string&gt;</span><span style="color:#393A34;">      </span><span style="color:#A0ADA0;"># \u6C61\u70B9\u7684\u952E</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">operator             &lt;string&gt;</span><span style="color:#393A34;">      </span><span style="color:#A0ADA0;"># Exists \u6C61\u70B9\u5B58\u5728\u4E0D\u7BA1\u4EC0\u4E48\u503C\uFF0CEqual \u6C61\u70B9\u7684\u503C\u5FC5\u987B\u7B49\u503C</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">tolerationSeconds    &lt;integer&gt;</span><span style="color:#393A34;">     </span><span style="color:#A0ADA0;"># \u5BB9\u5FCD\u65F6\u95F4\uFF0C\u5373\u5982\u679C\u88AB\u9A71\u9010\uFF0C\u53EF\u4EE5\u7B49\u591A\u4E45\u518D\u8D70\uFF0C\u9ED8\u8BA4 0 \u79D2\uFF0CNoExecute \u4F7F\u7528</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">value                &lt;string&gt;</span><span style="color:#393A34;">      </span><span style="color:#A0ADA0;"># \u6C61\u70B9\u7684\u503C</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7ED9 node2 \u3001node3 \u5206\u522B\u6253\u6C61\u70B9</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl taint node node2 node-type=production:NoSchedule</span></span>
<span class="line"><span style="color:#DBD7CA;">kubectl taint node node3 node-type=dev:NoExecute</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl taint node node2 node-type=production:NoSchedule</span></span>
<span class="line"><span style="color:#393A34;">kubectl taint node node3 node-type=dev:NoExecute</span></span>
<span class="line"></span></code></pre></div><ul><li>\u5B9A\u4E49 POD \u6E05\u5355\u6587\u4EF6\uFF0C\u5BB9\u5FCD node \u4E0A\u5B58\u5728 node-type \u503C\u4E3A dev \u7684\u6C61\u70B9\u3001\u63A5\u53D7\u88AB\u9A71\u9010\u3002</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp-deploy</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">default</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">4</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">release</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">canary</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">release</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">canary</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">myapp</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">ikubernetes/myapp:v2</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http</span></span>
<span class="line"><span style="color:#DBD7CA;">              </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">80</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">tolerations</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">key</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">node-type</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">operator</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Equal</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">value</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">dev</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">effect</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">NoExecute</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp-deploy</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">default</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">4</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">release</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">canary</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">release</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">canary</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">myapp</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">ikubernetes/myapp:v2</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http</span></span>
<span class="line"><span style="color:#393A34;">              </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">80</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">tolerations</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">key</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">node-type</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">operator</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Equal</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">value</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">dev</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">effect</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">NoExecute</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods -o wide\uFF0C\u8FD0\u884C\u5728\u81EA\u5DF1\u5BB9\u5FCD\u7684\u6C61\u70B9\u7684\u8282\u70B9\u4E0A\u4E86</li></ul><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">NAME                           READY   STATUS    RESTARTS   AGE     IP            NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-97578cf74-5v2r6   1/1     Running   0          6m22s   10.244.2.16   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-97578cf74-gbfj7   1/1     Running   0          6m22s   10.244.2.14   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-97578cf74-l4lbv   1/1     Running   0          6m22s   10.244.2.15   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#C98A7D;">myapp-deploy-97578cf74-zvn8f   1/1     Running   0          6m20s   10.244.2.17   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">NAME                           READY   STATUS    RESTARTS   AGE     IP            NODE    NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-97578cf74-5v2r6   1/1     Running   0          6m22s   10.244.2.16   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-97578cf74-gbfj7   1/1     Running   0          6m22s   10.244.2.14   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-97578cf74-l4lbv   1/1     Running   0          6m22s   10.244.2.15   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"><span style="color:#B56959;">myapp-deploy-97578cf74-zvn8f   1/1     Running   0          6m20s   10.244.2.17   node3   &lt;none&gt;           &lt;none&gt;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u4E3A\u8282\u70B9\u589E\u52A0\u65B0\u7684\u6C61\u70B9\uFF0C\u8BBE\u7F6E\u9A71\u79BB POD</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">kubectl taint node node3 disk=hdd:NoExecute --overwrite</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">kubectl taint node node3 disk=hdd:NoExecute --overwrite</span></span>
<span class="line"></span></code></pre></div><ul><li>\u67E5\u770B\u7ED3\u679C\uFF0Ckubectl get pods -o wide\uFF0CPOD \u4E0D\u80FD\u5BB9\u5FCD\u65B0\u7684\u6C61\u70B9\uFF0C\u7ED3\u679C\u88AB\u9A71\u9010</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">NAME                           READY   STATUS    RESTARTS   AGE   IP       NODE     NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-97578cf74-84bfz   0/1     Pending   0          6s    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-97578cf74-fxk2d   0/1     Pending   0          5s    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-97578cf74-jp99j   0/1     Pending   0          6s    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">myapp-deploy-97578cf74-vdkbx   0/1     Pending   0          6s    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">           </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">NAME                           READY   STATUS    RESTARTS   AGE   IP       NODE     NOMINATED NODE   READINESS GATES</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-97578cf74-84bfz   0/1     Pending   0          6s    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-97578cf74-fxk2d   0/1     Pending   0          5s    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-97578cf74-jp99j   0/1     Pending   0          6s    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">myapp-deploy-97578cf74-vdkbx   0/1     Pending   0          6s    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">           </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span></code></pre></div>`,62),e=[o];function c(t,r,y,A,D,i){return n(),a("div",null,e)}var d=s(p,[["render",c]]);export{C as __pageData,d as default};
