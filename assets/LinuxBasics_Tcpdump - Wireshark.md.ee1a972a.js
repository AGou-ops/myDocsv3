import{_ as s,o as a,c as p,a as n}from"./app.1e6146c3.js";const A=JSON.parse('{"title":"tcpdump & wireshark","description":"","frontmatter":{},"headers":[{"level":2,"title":"Tcpdump \u5E38\u7528\u793A\u4F8B\u53CA\u76F8\u5173\u53C2\u6570","slug":"tcpdump-\u5E38\u7528\u793A\u4F8B\u53CA\u76F8\u5173\u53C2\u6570"},{"level":2,"title":"Wireshark \u8FC7\u6EE4\u5668","slug":"wireshark-\u8FC7\u6EE4\u5668"},{"level":3,"title":"\u8FC7\u6EE4\u7B26\u53F7\u53CA\u7EC4\u5408","slug":"\u8FC7\u6EE4\u7B26\u53F7\u53CA\u7EC4\u5408"},{"level":2,"title":"\u793A\u4F8B","slug":"\u793A\u4F8B"},{"level":2,"title":"\u53C2\u8003\u94FE\u63A5","slug":"\u53C2\u8003\u94FE\u63A5"}],"relativePath":"LinuxBasics/Tcpdump - Wireshark.md","lastUpdated":1657272051000}'),l={name:"LinuxBasics/Tcpdump - Wireshark.md"},e=n(`<h1 id="tcpdump-wireshark" tabindex="-1">tcpdump &amp; wireshark <a class="header-anchor" href="#tcpdump-wireshark" aria-hidden="true">#</a></h1><h2 id="tcpdump-\u5E38\u7528\u793A\u4F8B\u53CA\u76F8\u5173\u53C2\u6570" tabindex="-1">Tcpdump \u5E38\u7528\u793A\u4F8B\u53CA\u76F8\u5173\u53C2\u6570 <a class="header-anchor" href="#tcpdump-\u5E38\u7528\u793A\u4F8B\u53CA\u76F8\u5173\u53C2\u6570" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># \u6293\u53D6\u6307\u5B9A\u534F\u8BAE\u548C\u7F51\u7EDC\u63A5\u53E3\u7684\u6570\u636E\u5305\uFF0C</span></span>
<span class="line"><span style="color:#758575;"># -nn\u8868\u793A\u4E0D\u89E3\u6790\u4E3B\u673A\u540D\u79F0\uFF0C</span></span>
<span class="line"><span style="color:#758575;"># -c\u8868\u793A\u6293\u53D6\u7684\u6570\u636E\u5305\u4E2A\u6570</span></span>
<span class="line"><span style="color:#758575;"># -w\u8868\u793A\u5C06\u5185\u5BB9\u6301\u4E45\u5316\u5230\u6587\u4EF6\u5F53\u4E2D\u53BB\uFF0C\u4E00\u822C\u4EE5\`.pcap\`\u540E\u7F00\u7ED3\u5C3E</span></span>
<span class="line"><span style="color:#DBD7CA;">tcpdump -i eth0 -c 5 icmp and host 192.168.1.1 -nn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#758575;"># \u7B80\u5355tcp\u6570\u636E\u5305\uFF0C\u4FDD\u5B58\u7684\u6587\u4EF6\u53EF\u4EE5\u4F7F\u7528wireshark\u5DE5\u5177\u8FDB\u884C\u5206\u6790\u5904\u7406</span></span>
<span class="line"><span style="color:#DBD7CA;">tcpdump -i any tcp and host 192.168.2.100 and port 80 -w http.pcap</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># \u6293\u53D6\u6307\u5B9A\u534F\u8BAE\u548C\u7F51\u7EDC\u63A5\u53E3\u7684\u6570\u636E\u5305\uFF0C</span></span>
<span class="line"><span style="color:#A0ADA0;"># -nn\u8868\u793A\u4E0D\u89E3\u6790\u4E3B\u673A\u540D\u79F0\uFF0C</span></span>
<span class="line"><span style="color:#A0ADA0;"># -c\u8868\u793A\u6293\u53D6\u7684\u6570\u636E\u5305\u4E2A\u6570</span></span>
<span class="line"><span style="color:#A0ADA0;"># -w\u8868\u793A\u5C06\u5185\u5BB9\u6301\u4E45\u5316\u5230\u6587\u4EF6\u5F53\u4E2D\u53BB\uFF0C\u4E00\u822C\u4EE5\`.pcap\`\u540E\u7F00\u7ED3\u5C3E</span></span>
<span class="line"><span style="color:#393A34;">tcpdump -i eth0 -c 5 icmp and host 192.168.1.1 -nn</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;"># \u7B80\u5355tcp\u6570\u636E\u5305\uFF0C\u4FDD\u5B58\u7684\u6587\u4EF6\u53EF\u4EE5\u4F7F\u7528wireshark\u5DE5\u5177\u8FDB\u884C\u5206\u6790\u5904\u7406</span></span>
<span class="line"><span style="color:#393A34;">tcpdump -i any tcp and host 192.168.2.100 and port 80 -w http.pcap</span></span>
<span class="line"></span></code></pre></div><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/8.jpg" alt="tcpdump \u5E38\u7528\u8FC7\u6EE4\u8868\u8FBE\u5F0F\u7C7B"></p><h2 id="wireshark-\u8FC7\u6EE4\u5668" tabindex="-1">Wireshark \u8FC7\u6EE4\u5668 <a class="header-anchor" href="#wireshark-\u8FC7\u6EE4\u5668" aria-hidden="true">#</a></h2><h3 id="\u8FC7\u6EE4\u7B26\u53F7\u53CA\u7EC4\u5408" tabindex="-1">\u8FC7\u6EE4\u7B26\u53F7\u53CA\u7EC4\u5408 <a class="header-anchor" href="#\u8FC7\u6EE4\u7B26\u53F7\u53CA\u7EC4\u5408" aria-hidden="true">#</a></h3><p><img src="https://cdn.jsdelivr.net/gh/AGou-ops/images/2020/wireshark-01.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/AGou-ops/images/2020/wireshark-02.png" alt=""></p><h2 id="\u793A\u4F8B" tabindex="-1">\u793A\u4F8B <a class="header-anchor" href="#\u793A\u4F8B" aria-hidden="true">#</a></h2><ul><li><p><code>ip</code>\u76F8\u5173</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">ip.addr </span><span style="color:#CB7676;">!</span><span style="color:#DBD7CA;">= 192.168.43.37		</span><span style="color:#758575;"># \u8FC7\u6EE4\u975E 192.168.43.37 \u4E3B\u673A\u7684\u6570\u636E\u5305, \u5B98\u65B9\u4E0D\u63A8\u8350\u4F7F\u7528\u8BE5\u683C\u5F0F, \u53EF\u80FD\u4F1A\u51FA\u73B0\u6F0F\u5305\u7684\u73B0\u8C61.</span></span>
<span class="line"><span style="color:#CB7676;">!</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">ip,addr == 192.168.43.37</span><span style="color:#858585;">)</span></span>
<span class="line"><span style="color:#758575;"># \u6216\u8005\u4F7F\u7528</span></span>
<span class="line"><span style="color:#DBD7CA;">not ip.addr == 192.168.43.37</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">(</span><span style="color:#DBD7CA;">ip.addr == 172.16.7.42 and dns</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;"> or </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">172.16.7.7 and icmp</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">ip.addr </span><span style="color:#AB5959;">!</span><span style="color:#393A34;">= 192.168.43.37		</span><span style="color:#A0ADA0;"># \u8FC7\u6EE4\u975E 192.168.43.37 \u4E3B\u673A\u7684\u6570\u636E\u5305, \u5B98\u65B9\u4E0D\u63A8\u8350\u4F7F\u7528\u8BE5\u683C\u5F0F, \u53EF\u80FD\u4F1A\u51FA\u73B0\u6F0F\u5305\u7684\u73B0\u8C61.</span></span>
<span class="line"><span style="color:#AB5959;">!</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">ip,addr == 192.168.43.37</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"><span style="color:#A0ADA0;"># \u6216\u8005\u4F7F\u7528</span></span>
<span class="line"><span style="color:#393A34;">not ip.addr == 192.168.43.37</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">ip.addr == 172.16.7.42 and dns</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;"> or </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">172.16.7.7 and icmp</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;"> </span></span>
<span class="line"></span></code></pre></div></li><li><p>\u9488\u5BF9\u534F\u8BAE\u7684\u8FC7\u6EE4</p></li><li><p>\u83B7\u67D0\u79CD\u534F\u8BAE\u7684\u6570\u636E\u5305\uFF0C\u8868\u8FBE\u5F0F\u5F88\u7B80\u5355\u4EC5\u4EC5\u9700\u8981\u628A\u534F\u8BAE\u7684\u540D\u5B57\u8F93\u5165\u5373\u53EF</p></li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\u610F\uFF1A\u662F\u5426\u533A\u5206\u5927\u5C0F\u5199\uFF1F\u7B54\uFF1A\u533A\u5206\uFF0C<code>\u53EA\u80FD\u4E3A\u5C0F\u5199</code></p><ul><li>\u6355\u83B7\u591A\u79CD\u534F\u8BAE\u7684\u6570\u636E\u5305</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http or telnet</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http or telnet</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6392\u9664\u67D0\u79CD\u534F\u8BAE\u7684\u6570\u636E\u5305</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">not arp   \u6216\u8005   </span><span style="color:#CB7676;">!</span><span style="color:#DBD7CA;">tcp</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">not arp   \u6216\u8005   </span><span style="color:#AB5959;">!</span><span style="color:#393A34;">tcp</span></span>
<span class="line"></span></code></pre></div><ul><li><p>\u9488\u5BF9\u7AEF\u53E3\u7684\u8FC7\u6EE4\uFF08\u89C6\u4F20\u8F93\u534F\u8BAE\u800C\u5B9A\uFF09</p><ul><li>\u6355\u83B7\u67D0\u4E00\u7AEF\u53E3\u7684\u6570\u636E\u5305\uFF08\u4EE5tcp\u534F\u8BAE\u4E3A\u4F8B\uFF09</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">tcp.port == 80</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">tcp.port == 80</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6355\u83B7\u591A\u7AEF\u53E3\u7684\u6570\u636E\u5305\uFF0C\u53EF\u4EE5\u4F7F\u7528and\u6765\u8FDE\u63A5\uFF0C\u4E0B\u9762\u662F\u6355\u83B7\u9AD8\u4E8E\u67D0\u7AEF\u53E3\u7684\u8868\u8FBE\u5F0F\uFF08\u4EE5udp\u534F\u8BAE\u4E3A\u4F8B\uFF09</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">udp.port </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">= 2048</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">udp.port </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">= 2048</span></span>
<span class="line"></span></code></pre></div></li><li><p>\u9488\u5BF9\u957F\u5EA6\u548C\u5185\u5BB9\u7684\u8FC7\u6EE4</p><ul><li>\u9488\u5BF9\u957F\u5EA6\u7684\u8FC7\u8651\uFF08\u8FD9\u91CC\u7684\u957F\u5EA6\u6307\u5B9A\u7684\u662F\u6570\u636E\u6BB5\u7684\u957F\u5EA6\uFF09</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">udp.length </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;"> 20   </span></span>
<span class="line"><span style="color:#DBD7CA;">http.content_length </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">=30</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">udp.length </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;"> 20   </span></span>
<span class="line"><span style="color:#393A34;">http.content_length </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">=30</span></span>
<span class="line"></span></code></pre></div><ul><li>\u9488\u5BF9uri \u5185\u5BB9\u7684\u8FC7\u6EE4</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.request.uri matches </span><span style="color:#C98A7D;">&quot;user&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">\u8BF7\u6C42\u7684uri\u4E2D\u5305\u542B\u201Cuser\u201D\u5173\u952E\u5B57\u7684</span><span style="color:#858585;">)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.request.uri matches </span><span style="color:#B56959;">&quot;user&quot;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">\u8BF7\u6C42\u7684uri\u4E2D\u5305\u542B\u201Cuser\u201D\u5173\u952E\u5B57\u7684</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\u610F\uFF1A<code>matches</code> \u540E\u7684\u5173\u952E\u5B57\u662F<code>\u4E0D\u533A\u5206\u5927\u5C0F\u5199</code>\u7684\uFF01</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.request.uri contains </span><span style="color:#C98A7D;">&quot;User&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">\u8BF7\u6C42\u7684uri\u4E2D\u5305\u542B\u201Cuser\u201D\u5173\u952E\u5B57\u7684</span><span style="color:#858585;">)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.request.uri contains </span><span style="color:#B56959;">&quot;User&quot;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">\u8BF7\u6C42\u7684uri\u4E2D\u5305\u542B\u201Cuser\u201D\u5173\u952E\u5B57\u7684</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span></code></pre></div><p>\u6CE8\u610F\uFF1A<code>contains</code> \u540E\u7684\u5173\u952E\u5B57\u662F<code>\u533A\u5206\u5927\u5C0F\u5199</code>\u7684\uFF01</p></li><li><p>\u9488\u5BF9http\u8BF7\u6C42\u7684\u4E00\u4E9B\u8FC7\u6EE4\u5B9E\u4F8B\u3002</p><ul><li>\u8FC7\u6EE4\u51FA\u8BF7\u6C42\u5730\u5740\u4E2D\u5305\u542B\u201Cuser\u201D\u7684\u8BF7\u6C42\uFF0C\u4E0D\u5305\u62EC\u57DF\u540D\uFF1B</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.request.uri contains </span><span style="color:#C98A7D;">&quot;User&quot;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.request.uri contains </span><span style="color:#B56959;">&quot;User&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u7CBE\u786E\u8FC7\u6EE4\u57DF\u540D</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.host==baidu.com</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.host==baidu.com</span></span>
<span class="line"></span></code></pre></div><ul><li>\u6A21\u7CCA\u8FC7\u6EE4\u57DF\u540D</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.host contains </span><span style="color:#C98A7D;">&quot;baidu&quot;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.host contains </span><span style="color:#B56959;">&quot;baidu&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FC7\u6EE4\u8BF7\u6C42\u7684content_type\u7C7B\u578B</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.content_type ==</span><span style="color:#C98A7D;">&quot;text/html&quot;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.content_type ==</span><span style="color:#B56959;">&quot;text/html&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FC7\u6EE4http\u8BF7\u6C42\u65B9\u6CD5</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.request.method==</span><span style="color:#C98A7D;">&quot;POST&quot;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.request.method==</span><span style="color:#B56959;">&quot;POST&quot;</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FC7\u6EE4tcp\u7AEF\u53E3</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">tcp.port==80</span></span>
<span class="line"><span style="color:#DBD7CA;">http </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> tcp.port==80 or tcp.port==5566</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">tcp.port==80</span></span>
<span class="line"><span style="color:#393A34;">http </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> tcp.port==80 or tcp.port==5566</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FC7\u6EE4http\u54CD\u5E94\u72B6\u6001\u7801</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.response.code==302</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.response.code==302</span></span>
<span class="line"></span></code></pre></div><ul><li>\u8FC7\u6EE4\u542B\u6709\u6307\u5B9Acookie\u7684http\u6570\u636E\u5305</li></ul><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">http.cookie contains </span><span style="color:#C98A7D;">&quot;userid&quot;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">http.cookie contains </span><span style="color:#B56959;">&quot;userid&quot;</span></span>
<span class="line"></span></code></pre></div></li></ul><h2 id="\u53C2\u8003\u94FE\u63A5" tabindex="-1">\u53C2\u8003\u94FE\u63A5 <a class="header-anchor" href="#\u53C2\u8003\u94FE\u63A5" aria-hidden="true">#</a></h2><ul><li>Wireshark\u8FC7\u6EE4\u5668\u5199\u6CD5\u603B\u7ED3: <a href="https://www.cnblogs.com/willingtolove/p/12519490.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/willingtolove/p/12519490.html</a></li><li>tcpdump \u8BE6\u89E3\uFF1A<a href="https://xiaolincoding.com/network/3_tcp/tcp_tcpdump.html" target="_blank" rel="noopener noreferrer">https://xiaolincoding.com/network/3_tcp/tcp_tcpdump.html</a></li></ul>`,19),c=[e];function o(t,r,i,d,h,y){return a(),p("div",null,c)}var D=s(l,[["render",o]]);export{A as __pageData,D as default};
