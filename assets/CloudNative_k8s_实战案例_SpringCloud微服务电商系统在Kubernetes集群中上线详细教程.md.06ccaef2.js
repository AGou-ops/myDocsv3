import{_ as s,o as n,c as a,a as p}from"./app.1e6146c3.js";const d=JSON.parse('{"title":"SpringCloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728Kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B","description":"","frontmatter":{},"headers":[{"level":2,"title":"1.\u5FAE\u670D\u52A1\u67B6\u6784\u53CA\u7406\u8BBA\u6982\u8FF0","slug":"_1-\u5FAE\u670D\u52A1\u67B6\u6784\u53CA\u7406\u8BBA\u6982\u8FF0"},{"level":3,"title":"1.1.\u5355\u4F53\u67B6\u6784\u4E0E\u5FAE\u670D\u52A1\u67B6\u6784\u7684\u533A\u522B","slug":"_1-1-\u5355\u4F53\u67B6\u6784\u4E0E\u5FAE\u670D\u52A1\u67B6\u6784\u7684\u533A\u522B"},{"level":3,"title":"1.2.\u5FAE\u670D\u52A1\u7EC4\u4EF6\u67B6\u6784\u56FE","slug":"_1-2-\u5FAE\u670D\u52A1\u7EC4\u4EF6\u67B6\u6784\u56FE"},{"level":3,"title":"1.3.\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3","slug":"_1-3-\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3"},{"level":3,"title":"1.4.\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\u5BF9\u4E8E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\u5982\u4F55\u7BA1\u7406","slug":"_1-4-\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\u5BF9\u4E8E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\u5982\u4F55\u7BA1\u7406"},{"level":2,"title":"2.\u5FAE\u670D\u52A1\u8FC1\u79FB\u81F3kubernetes\u5E73\u53F0\u6D41\u7A0B","slug":"_2-\u5FAE\u670D\u52A1\u8FC1\u79FB\u81F3kubernetes\u5E73\u53F0\u6D41\u7A0B"},{"level":3,"title":"2.1.\u9879\u76EE\u8FC1\u79FB\u5230K8S\u5E73\u53F0\u6D41\u7A0B","slug":"_2-1-\u9879\u76EE\u8FC1\u79FB\u5230k8s\u5E73\u53F0\u6D41\u7A0B"},{"level":3,"title":"2.2.\u4F20\u7EDF\u90E8\u7F72\u4E0EK8S\u90E8\u7F72\u7684\u533A\u522B","slug":"_2-2-\u4F20\u7EDF\u90E8\u7F72\u4E0Ek8s\u90E8\u7F72\u7684\u533A\u522B"},{"level":2,"title":"3.\u5FAE\u670D\u52A1\u7A0B\u5E8F\u524D\u671F\u73AF\u5883\u51C6\u5907\uFF08\u914D\u7F6E\u3001\u7F16\u8BD1\u3001\u5236\u4F5C\u955C\u50CF\uFF09","slug":"_3-\u5FAE\u670D\u52A1\u7A0B\u5E8F\u524D\u671F\u73AF\u5883\u51C6\u5907\uFF08\u914D\u7F6E\u3001\u7F16\u8BD1\u3001\u5236\u4F5C\u955C\u50CF\uFF09"},{"level":3,"title":"3.1.simple-microservice\u5FAE\u670D\u52A1\u9879\u76EE\u4ECB\u7ECD","slug":"_3-1-simple-microservice\u5FAE\u670D\u52A1\u9879\u76EE\u4ECB\u7ECD"},{"level":3,"title":"3.2.simple\u5FAE\u670D\u52A1\u90E8\u7F72\u5230K8S\u903B\u8F91\u67B6\u6784","slug":"_3-2-simple\u5FAE\u670D\u52A1\u90E8\u7F72\u5230k8s\u903B\u8F91\u67B6\u6784"},{"level":3,"title":"3.3.\u51C6\u5907\u5FAE\u670D\u52A1\u5404\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6","slug":"_3-3-\u51C6\u5907\u5FAE\u670D\u52A1\u5404\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6"},{"level":3,"title":"3.4.\u5236\u4F5C\u5FAE\u670D\u52A1\u7A0B\u5E8F\u6240\u4F7F\u7528\u7684\u7684\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF","slug":"_3-4-\u5236\u4F5C\u5FAE\u670D\u52A1\u7A0B\u5E8F\u6240\u4F7F\u7528\u7684\u7684\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF"},{"level":3,"title":"3.5.\u8C03\u6574Protal\u5FAE\u670D\u52A1\u4E2D\u8FDE\u63A5Gateway\u7F51\u5173\u7684\u5730\u5740","slug":"_3-5-\u8C03\u6574protal\u5FAE\u670D\u52A1\u4E2D\u8FDE\u63A5gateway\u7F51\u5173\u7684\u5730\u5740"},{"level":3,"title":"3.6.\u90E8\u7F72Ingress\u7528\u4E8E\u5C06\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51","slug":"_3-6-\u90E8\u7F72ingress\u7528\u4E8E\u5C06\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51"},{"level":2,"title":"4.\u5728kubernetes\u96C6\u7FA4\u90E8\u7F72simple\u5FAE\u670D\u52A1\u9879\u76EE","slug":"_4-\u5728kubernetes\u96C6\u7FA4\u90E8\u7F72simple\u5FAE\u670D\u52A1\u9879\u76EE"},{"level":3,"title":"4.1.\u90E8\u7F72simple\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684mysql\u6570\u636E\u5E93\u73AF\u5883","slug":"_4-1-\u90E8\u7F72simple\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684mysql\u6570\u636E\u5E93\u73AF\u5883"},{"level":3,"title":"4.2.\u90E8\u7F72eureka\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3","slug":"_4-2-\u90E8\u7F72eureka\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3"},{"level":3,"title":"4.3.\u914D\u7F6E\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDE\u63A5Eureka\u96C6\u7FA4\u7684\u5730\u5740","slug":"_4-3-\u914D\u7F6E\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDE\u63A5eureka\u96C6\u7FA4\u7684\u5730\u5740"},{"level":3,"title":"4.4.\u5C06\u5404\u4E2A\u7A0B\u5E8F\u4EE3\u7801\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F","slug":"_4-4-\u5C06\u5404\u4E2A\u7A0B\u5E8F\u4EE3\u7801\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F"},{"level":3,"title":"4.3.\u4E2D\u90E8\u7F72Gateway\u7F51\u5173\u670D\u52A1","slug":"_4-3-\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1"},{"level":3,"title":"4.4.\u7F16\u5199\u5FEB\u901F\u90E8\u7F72\u5FAE\u670D\u52A1\u5230K8S\u96C6\u7FA4\u7684\u811A\u672C","slug":"_4-4-\u7F16\u5199\u5FEB\u901F\u90E8\u7F72\u5FAE\u670D\u52A1\u5230k8s\u96C6\u7FA4\u7684\u811A\u672C"},{"level":3,"title":"4.5.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Order\u8BA2\u5355\u670D\u52A1","slug":"_4-5-\u4F7F\u7528\u811A\u672C\u90E8\u7F72order\u8BA2\u5355\u670D\u52A1"},{"level":3,"title":"4.6.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Product\u5546\u54C1\u670D\u52A1","slug":"_4-6-\u4F7F\u7528\u811A\u672C\u90E8\u7F72product\u5546\u54C1\u670D\u52A1"},{"level":3,"title":"4.7.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Stock\u5E93\u5B58\u670D\u52A1","slug":"_4-7-\u4F7F\u7528\u811A\u672C\u90E8\u7F72stock\u5E93\u5B58\u670D\u52A1"},{"level":3,"title":"4.8.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Portal\u524D\u7AEF\u9996\u9875","slug":"_4-8-\u4F7F\u7528\u811A\u672C\u90E8\u7F72portal\u524D\u7AEF\u9996\u9875"},{"level":3,"title":"4.9.\u67E5\u770BEureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F","slug":"_4-9-\u67E5\u770Beureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F"},{"level":3,"title":"4.10.\u4F7F\u7528simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0","slug":"_4-10-\u4F7F\u7528simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0"},{"level":2,"title":"5.\u57FA\u4E8EK8S\u96C6\u7FA4\u7684\u5FAE\u670D\u52A1\u7684\u6269\u5BB9\u4E0E\u5347\u7EA7","slug":"_5-\u57FA\u4E8Ek8s\u96C6\u7FA4\u7684\u5FAE\u670D\u52A1\u7684\u6269\u5BB9\u4E0E\u5347\u7EA7"},{"level":3,"title":"5.1.\u5FAE\u670D\u52A1\u7684\u6269\u5BB9","slug":"_5-1-\u5FAE\u670D\u52A1\u7684\u6269\u5BB9"},{"level":3,"title":"5.2.\u5FAE\u670D\u52A1\u7684\u5347\u7EA7","slug":"_5-2-\u5FAE\u670D\u52A1\u7684\u5347\u7EA7"}],"relativePath":"CloudNative/k8s/\u5B9E\u6218\u6848\u4F8B/SpringCloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728Kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B.md","lastUpdated":1657272051000}'),l={name:"CloudNative/k8s/\u5B9E\u6218\u6848\u4F8B/SpringCloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728Kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B.md"},o=p(`<h1 id="springcloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B" tabindex="-1">SpringCloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728Kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B <a class="header-anchor" href="#springcloud\u5FAE\u670D\u52A1\u7535\u5546\u7CFB\u7EDF\u5728kubernetes\u96C6\u7FA4\u4E2D\u4E0A\u7EBF\u8BE6\u7EC6\u6559\u7A0B" aria-hidden="true">#</a></h1><blockquote><p>\u8BE5\u6587\u7AE0\u6765\u81EA\uFF1A<a href="https://jiangxl.blog.csdn.net/article/details/121740024" target="_blank" rel="noopener noreferrer">https://jiangxl.blog.csdn.net/article/details/121740024</a></p><p>\u4EC5\u505A\u4E2A\u4EBA\u5907\u4EFD\u5B66\u4E60\u4F7F\u7528\u3002</p></blockquote><h2 id="_1-\u5FAE\u670D\u52A1\u67B6\u6784\u53CA\u7406\u8BBA\u6982\u8FF0" tabindex="-1">1.<a href="https://so.csdn.net/so/search?q=%E5%BE%AE%E6%9C%8D%E5%8A%A1&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">\u5FAE\u670D\u52A1</a>\u67B6\u6784\u53CA\u7406\u8BBA\u6982\u8FF0 <a class="header-anchor" href="#_1-\u5FAE\u670D\u52A1\u67B6\u6784\u53CA\u7406\u8BBA\u6982\u8FF0" aria-hidden="true">#</a></h2><p>\u7A0B\u5E8F<a href="https://so.csdn.net/so/search?q=%E6%9E%B6%E6%9E%84&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">\u67B6\u6784</a>\u4E00\u5171\u7ECF\u5386\u4E863\u4E2A\u9636\u6BB5\uFF1A\u5355\u4F53\u67B6\u6784\u3001SOA\u67B6\u6784\u3001\u5FAE\u670D\u52A1\u67B6\u6784\u3002</p><p>\u5FAE\u670D\u52A1\u7CFB\u7EDF\u5E94\u7528\u7531\u539F\u6765\u7684\u5355\u4F53\u53D8\u6210\u51E0\u5341\u5230\u51E0\u767E\u4E2A\u4E0D\u540C\u7684\u5DE5\u7A0B\uFF0C\u4F1A\u4EA7\u751F\u4F8B\u5982\u5305\u62EC\u670D\u52A1\u95F4\u7684\u4F9D\u8D56\uFF0C\u670D\u52A1\u5982\u4F55\u62C6\u5C01\uFF0C\u5185\u90E8\u63A5\u53E3\u89C4\u8303\uFF0C\u6570\u636E\u4F20\u9012\u7B49\u7B49\u95EE\u9898\uFF0C\u5C24\u5176\u662F\u670D\u52A1\u62C6\u5206\uFF0C\u9700\u8981\u56E2\u961F\u719F\u6089\u4E1A\u52A1\u6D41\u7A0B\uFF0C\u61C2\u5F97\u53D6\u820D\uFF0C\u8981\u4FDD\u8BC1\u62C6\u5206\u7684\u7C92\u5EA6\u670D\u52A1\u65E2\u7B26\u5408\u201C\u9AD8\u5185\u805A\uFF0C\u4F4E\u8026\u5408\u201D\u7684\u57FA\u672C\u539F\u5219\uFF0C\u8FD8\u8981\u517C\u987E\u4E1A\u52A1\u7684\u53D1\u5C55\u4EE5\u53CA\u516C\u53F8\u7684\u613F\u666F\uFF0C\u8981\u8FD8\u8981\u8BF4\u670D\u56E2\u961F\u6210\u5458\u4E3A\u4E4B\u52AA\u529B\uFF0C\u5E76\u4E14\u79EF\u6781\u6295\u5165\uFF0C\u5728\u591A\u65B9\u4E2D\u95F4\u53D6\u5F97\u5E73\u8861\u3002</p><p>\u5FAE\u670D\u52A1\u4ECE\u6982\u5FF5\u4E0A\u8BB2\u5C31\u662F\u5C06\u4E00\u4E2A\u5927\u7684\u5E73\u53F0\u62C6\u5206\u6210\u51E0\u4E2A\u72EC\u7ACB\u7684\u5C0F\u6A21\u5757\uFF0C\u8FD9\u4E9B\u6A21\u5757\u6709\u81EA\u5DF1\u4E13\u95E8\u7684\u6570\u636E\u5E93\u670D\u52A1\uFF0C\u5373\u4F7F\u8FD9\u4E2A\u5355\u72EC\u6A21\u5757\u51FA\u73B0\u4E86\u6545\u969C\uFF0C\u4E5F\u4E0D\u4F1A\u5F71\u54CD\u6574\u4E2A\u5E73\u53F0\u7684\u4F7F\u7528\uFF0C\u4F8B\u5982\u4E00\u4E2A\u5E73\u53F0\u4E2D\u6709\u8BA2\u5355\u6A21\u5757\u3001\u65B0\u95FB\u6A21\u5757\u3001\u54A8\u8BE2\u6A21\u5757\uFF0C\u5373\u4F7F\u65B0\u95FB\u6A21\u5757\u5B95\u673A\u4E86\uFF0C\u8BA2\u5355\u6A21\u5757\u3001\u65B0\u95FB\u6A21\u5757\u4F9D\u7136\u5DE5\u4F5C\u6B63\u5E38\uFF0C\u4E5F\u4E0D\u4F1A\u9020\u6210\u6574\u4E2A\u7F51\u7AD9\u7684\u762B\u75EA\u3002</p><p>\u5BF9\u4E8E\u5FAE\u670D\u52A1\u7248\u672C\u8FED\u4EE3\u800C\u8A00\uFF0C\u53EA\u9700\u8981\u9488\u5BF9\u7279\u5B9A\u529F\u80FD\u6240\u5728\u7684\u5B50\u9879\u76EE\u4E0A\u7EBF\u5373\u53EF\uFF0C\u7248\u672C\u8FED\u4EE3\u66F4\u52A0\u7075\u6D3B\uFF0C\u800C\u5355\u4F53\u7A0B\u5E8F\u7248\u672C\u8FED\u4EE3\uFF0C\u54EA\u6015\u53EA\u662F\u4E00\u4E2A\u5C0F\u5C0F\u7684\u529F\u80FD\u4E5F\u9700\u8981\u5BF9\u6574\u4E2A\u7CFB\u7EDF\u8FDB\u884C\u66F4\u65B0\u3002</p><p>\u76EE\u524D\u4E3B\u6D41\u7684\u7A0B\u5E8F\u67B6\u6784\u5C31\u662F\u5FAE\u670D\u52A1\u7CFB\u7EDF\uFF0C\u8FD0\u7528\u7684\u6280\u672F\u6808\u66F4\u52A0\u4E30\u5BCC\uFF0C\u4F8B\u5982kubernetes\u3001CI/CD\u3001Devops\u7B49\u7B49\u3002</p><p>\u5FAE\u670D\u52A1\u9879\u76EE\u5728kubernetes\u73AF\u5883\u90E8\u7F72\u4E3B\u8981\u6709\u4E24\u79CD\u5B9E\u73B0\u65B9\u5F0F\uFF1A\u65E0\u72B6\u6001\u7684\u90E8\u7F72\u3001istio\u5FAE\u670D\u52A1\u7F51\u683C\u90E8\u7F72\u3002</p><p>\u53EF\u4EE5\u628A\u5FAE\u670D\u52A1\u7406\u89E3\u4E3A\u662F\u4E00\u4E2A\u5927\u7684\u6846\u67B6\uFF0C\u5728\u8FD9\u4E2A\u6846\u67B6\u91CC\u9762\u5185\u5D4C\u5404\u4E2A\u5B50\u7CFB\u7EDF\u3002</p><h3 id="_1-1-\u5355\u4F53\u67B6\u6784\u4E0E\u5FAE\u670D\u52A1\u67B6\u6784\u7684\u533A\u522B" tabindex="-1">1.1.\u5355\u4F53\u67B6\u6784\u4E0E\u5FAE\u670D\u52A1\u67B6\u6784\u7684\u533A\u522B <a class="header-anchor" href="#_1-1-\u5355\u4F53\u67B6\u6784\u4E0E\u5FAE\u670D\u52A1\u67B6\u6784\u7684\u533A\u522B" aria-hidden="true">#</a></h3><p><strong>\u5FAE\u670D\u52A1\u7684\u7279\u70B9\uFF1A</strong></p><ul><li>\u7CFB\u7EDF\u670D\u52A1\u72EC\u7ACB\u5316 <ul><li>\u6BCF\u4E2A\u5B50\u9879\u76EE\u7CFB\u7EDF\u90FD\u4F1A\u72EC\u7ACB\u5F00\u53D1\u3001\u90E8\u7F72\uFF0C\u6709\u6548\u7684\u907F\u514D\u4E00\u4E2A\u670D\u52A1\u7684bug\u5F71\u54CD\u6574\u4E2A\u7CFB\u7EDF\u7684\u4F7F\u7528</li></ul></li><li>\u6280\u672F\u6808\u7075\u6D3B <ul><li>\u6BCF\u4E2A\u5B50\u7CFB\u7EDF\u4E4B\u95F4\u7EA6\u5B9A\u4E00\u4E2A\u901A\u4FE1\u65B9\u5F0F\uFF0C\u4F8B\u5982MQ\u3001API\u7B49\uFF0C\u4E0D\u518D\u50CF\u5355\u4F53\u670D\u52A1\u90A3\u4E48\u7684\u5C40\u9650\u6027</li></ul></li><li>\u72EC\u7ACB\u90E8\u7F72 <ul><li>\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7CFB\u7EDF\u90FD\u72EC\u7ACB\u90E8\u7F72\uFF0C\u90FD\u6709\u5355\u72EC\u7684war\u5305\uFF0C\u5373\u4F7F\u5176\u4E2D\u4E00\u4E2A\u670D\u52A1\u5F02\u5E38\u5B95\u673A\uFF0C\u4E5F\u4E0D\u4F1A\u5BF9\u6574\u4E2A\u5E73\u53F0\u4EA7\u751F\u5F71\u54CD</li></ul></li><li>\u6269\u5C55\u6027\u5F3A <ul><li>\u6BCF\u4E2A\u5FAE\u670D\u52A1\u90FD\u53EF\u4EE5\u90E8\u7F72\u591A\u5957\uFF0C\u914D\u5408\u6CE8\u518C\u4E2D\u5FC3\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u80FD\u529B</li></ul></li><li>\u72EC\u7ACB\u6570\u636E <ul><li>\u6BCF\u4E2A\u5FAE\u670D\u52A1\u90FD\u6709\u72EC\u7ACB\u7684\u5B58\u50A8\u7EC4\u4EF6\uFF0C\u6BD4\u5982\u6570\u636E\u5E93\u3001\u7F13\u5B58\u7B49\uFF0C\u4E92\u4E0D\u5F71\u54CD</li></ul></li></ul><p><strong>\u5355\u4F53\u670D\u52A1\u7684\u7279\u70B9</strong></p><ul><li>\u6613\u4E8E\u90E8\u7F72 <ul><li>\u5355\u4F53\u670D\u52A1\u53EA\u6709\u4E00\u4E2A\u7A0B\u5E8F\u5305\uFF0C\u53EA\u9700\u8981\u90E8\u7F72\u4E00\u4E2A\u670D\u52A1\u5373\u53EF\u5B8C\u6210\u6574\u4E2A\u7CFB\u7EDF\u7684\u5EFA\u8BBE</li></ul></li><li>\u6613\u4E8E\u6D4B\u8BD5 <ul><li>\u6D4B\u8BD5\u7528\u4F8B\u4E5F\u53EA\u9700\u8981\u8BBE\u8BA1\u4E00\u4E2A\u5373\u53EF</li></ul></li></ul><p><strong>\u5355\u4F53\u670D\u52A1\u7684\u4E0D\u8DB3</strong></p><ul><li>\u4EE3\u7801\u91CF\u7EA7\u5DE8\u5927\uFF0C\u96BE\u4EE5\u7EF4\u62A4\uFF0C\u5982\u679C\u7CFB\u7EDF\u4E2D\u5B58\u5728bug\uFF0C\u4FEE\u590D\u8D77\u6765\u7275\u626F\u529F\u80FD\u592A\u591A\uFF0C\u6545\u969C\u767E\u51FA</li><li>\u6784\u5EFA\u3001\u90E8\u7F72\u7684\u6210\u672C\u5DE8\u5927\uFF0C\u670D\u52A1\u90FD\u96C6\u6210\u5728\u4E00\u8D77\uFF0C\u542F\u52A8\u7684\u65F6\u95F4\u4E5F\u4F1A\u975E\u5E38\u7F13\u6162</li><li>\u65B0\u4EBA\u4E0A\u624B\u8F83\u96BE\uFF0C\u5982\u679C\u6574\u4E2A\u670D\u52A1\u4E5F\u6CA1\u6709\u6CE8\u91CA\u7684\u60C5\u51B5\u4E0B\uFF0C\u65B0\u7684\u5F00\u53D1\u4EBA\u5458\u4E0A\u624B\u4F1A\u975E\u5E38\u96BE</li></ul><p><strong>\u5FAE\u670D\u52A1\u4E0E\u5355\u4F53\u670D\u52A1\u67B6\u6784\u4E0A\u7684\u4E0D\u540C</strong></p><blockquote><p>\u5355\u4F53\u670D\u52A1\uFF1A\u7A0B\u5E8F\u5305\u53EA\u6709\u4E00\u4E2A\uFF0C\u5F00\u53D1\u56E2\u961F\u53EF\u80FD\u6709\u4E00\u7FA4\u4EBA\uFF0C\u7528\u6237\u4E4B\u95F4\u8BBF\u95EE\u7A0B\u5E8F\u5305\u5373\u53EF\u83B7\u53D6\u7CFB\u7EDF\u4FE1\u606F\uFF0C\u540E\u7AEF\u5BF9\u5E94\u4E00\u4E2A\u6570\u636E\u5E93</p><p>\u5FAE\u670D\u52A1\uFF1A\u7A0B\u5E8F\u5305\u6709\u591A\u4E2A\uFF0C\u6BCF\u4E2A\u7A0B\u5E8F\u5305\u90FD\u662F\u4E0D\u540C\u7684\u529F\u80FD\u7ED3\u5408\uFF0C\u4E14\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u90FD\u6709\u81EA\u5DF1\u7684\u5355\u72EC\u6570\u636E\u5E93\u5B58\u50A8\u6570\u636E\uFF0C\u6240\u6709\u7684\u5FAE\u670D\u52A1\u4FE1\u606F\u90FD\u4F1A\u5B58\u50A8\u5230\u6CE8\u518C\u4E2D\u5FC3\uFF0C\u7F51\u5173\u7A0B\u5E8F\u5728\u6700\u524D\u9762\uFF0C\u5F53\u7528\u6237\u6709\u8BF7\u6C42\u8FDB\u6765\u540E\uFF0C\u9996\u5148\u53D1\u9001\u7ED9\u7F51\u5173\u670D\u52A1\uFF0C\u7136\u540E\u7F51\u5173\u6839\u636E\u6CE8\u518C\u4E2D\u5FC3\u7684\u6570\u636E\uFF0C\u5C06\u4E0D\u540C\u529F\u80FD\u7684\u8BF7\u6C42\u8F6C\u53D1\u7ED9\u4E0D\u540C\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F</p></blockquote><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/caf1d3f6f0f4405ea879f6408a54faf5.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_1-2-\u5FAE\u670D\u52A1\u7EC4\u4EF6\u67B6\u6784\u56FE" tabindex="-1">1.2.\u5FAE\u670D\u52A1\u7EC4\u4EF6\u67B6\u6784\u56FE <a class="header-anchor" href="#_1-2-\u5FAE\u670D\u52A1\u7EC4\u4EF6\u67B6\u6784\u56FE" aria-hidden="true">#</a></h3><p>\u4EE5\u7535\u5546\u5E73\u53F0\u4E3A\u4F8B\uFF0C\u63CF\u8FF0\u4E00\u4E2A\u8D2D\u4E70\u5546\u54C1\u7684\u5FAE\u670D\u52A1\u4E4B\u95F4\u8C03\u7528\u6D41\u7A0B</p><p>\u7528\u6237\u9996\u5148\u8BBF\u95EE\u5230\u5E73\u53F0\u7684\u9759\u6001\u9996\u9875\uFF0C\u53D1\u9001\u4E00\u4E2A\u641C\u7D22\u8BF7\u6C42\u4ECE\u524D\u7AEF\u9875\u9762\u63D0\u4EA4\u7ED9\u5FAE\u670D\u52A1\u7684\u7F51\u5173\u670D\u52A1\uFF0C\u7F51\u5173\u670D\u52A1\u662F\u5BF9\u5916\u7684\uFF0C\u4E5F\u5C31\u662F\u4E0D\u7BA1\u7528\u6237\u8981\u64CD\u4F5C\u4EC0\u4E48\u8BF7\u6C42\uFF0C\u90FD\u9700\u8981\u7531\u7F51\u5173\u670D\u52A1\u8F6C\u53D1\u7ED9\u5177\u4F53\u7684\u5FAE\u670D\u52A1\uFF0C\u56E0\u4E3A\u7F51\u5173\u670D\u52A1\u662F\u5165\u53E3\uFF0C\u56E0\u6B64\u7F51\u5173\u670D\u52A1\u4E00\u822C\u90FD\u662F\u591A\u53F0\u505A\u6210\u7684\u8D1F\u8F7D\u5747\u8861\uFF0C\u641C\u7D22\u8BF7\u6C42\u5230\u8FBE\u7F51\u5173\u670D\u52A1\u540E\uFF0C\u7F51\u5173\u670D\u52A1\u4F1A\u6839\u636E\u8BF7\u6C42\u7684\u529F\u80FD\u8F6C\u53D1\u5230\u641C\u7D22\u670D\u52A1\u7684\u7A0B\u5E8F\u4E0A\uFF0C\u641C\u7D22\u51FA\u6765\u5546\u54C1\u540E\uFF0C\u4F1A\u8C03\u7528\u5546\u54C1\u670D\u52A1\u7A0B\u5E8F\uFF0C\u67E5\u770B\u5546\u54C1\u7684\u8BE6\u7EC6\u60C5\u51B5\uFF0C\u7528\u6237\u9009\u62E9\u5B8C\u5546\u54C1\u540E\uFF0C\u5546\u54C1\u670D\u52A1\u518D\u8C03\u7528\u8BA2\u5355\u670D\u52A1\uFF0C\u5B8C\u6210\u8BA2\u5355\u7684\u521B\u5EFA\uFF0C\u518D\u7531\u8BA2\u5355\u670D\u52A1\u8C03\u7528\u652F\u4ED8\u670D\u52A1\uFF0C\u5B8C\u6210\u5546\u54C1\u7684\u8D2D\u4E70\u3002</p><p>\u6240\u6709\u7684\u5FAE\u670D\u52A1\u63A5\u53E3\u4FE1\u606F\u90FD\u4F1A\u6CE8\u518C\u5230\u6CE8\u518C\u4E2D\u5FC3\uFF0C\u5F53\u7A0B\u5E8F\u542F\u52A8\u6210\u529F\u5C31\u4F1A\u81EA\u52A8\u6CE8\u518C\u5230\u6CE8\u518C\u4E2D\u5FC3\uFF0C\u6CE8\u518C\u4E2D\u5FC3\u4E5F\u4F1A\u8D77\u5230\u4E00\u4E2A\u8D1F\u8F7D\u5747\u8861\u7684\u4F5C\u7528\uFF0C\u6839\u636E\u7F51\u5173\u7684API\u8BF7\u6C42\uFF0C\u5728\u6CE8\u518C\u4E2D\u5FC3\u4E0A\u627E\u5230\u7279\u5B9A\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDB\u884C\u8F6C\u53D1\u3002</p><p>\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FD8\u6709\u81EA\u5DF1\u7684\u4E00\u5957\u914D\u7F6E\u4E2D\u5FC3\uFF0C\u4FDD\u5B58\u7740\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u6240\u6709\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53EF\u80FD\u90FD\u6709\u81EA\u5DF1\u72EC\u7ACB\u7684\u540E\u7AEF\u7EC4\u4EF6\uFF0C\u6BD4\u5982MySQL\u3001Redis\u3001MQ\u3001\u5206\u5E03\u5F0F\u5B58\u50A8\u3002</p><p>\u5FAE\u670D\u52A1\u4E4B\u95F4\u7684\u901A\u4FE1\u53EF\u4EE5\u91C7\u7528\u63A5\u53E3API\u3001MQ\u3001RPAC\u7B49\u673A\u5236</p><p>\u5FAE\u670D\u52A1\u5728kubernetes\u96C6\u7FA4\u4E2D\u90E8\u7F72\u65F6\u53EF\u4EE5\u91C7\u7528\u65E0\u72B6\u6001\u670D\u52A1\u7684\u90E8\u7F72\uFF0C\u5BF9\u4E8E\u6570\u636E\u5E93\u3001Redis\u3001MQ\u3001\u5B58\u50A8\u8FD8\u662F\u5EFA\u8BAE\u90E8\u7F72\u5728k8s\u96C6\u7FA4\u4E4B\u5916\u3002</p><p>\u6CE8\u518C\u4E2D\u5FC3\u4E0E\u5FAE\u670D\u52A1\u4E4B\u95F4\u7684\u8054\u7CFB\uFF1A\u53D1\u73B0\u5FAE\u670D\u52A1\u2014&gt;\u5FAE\u670D\u52A1\u6CE8\u518C\u5230\u6CE8\u518C\u4E2D\u5FC3\u2014&gt;\u8FDB\u884C\u5FC3\u8DF3\u76D1\u6D4B\uFF0C\u5F02\u5E38\u7684\u8282\u70B9\u4F1A\u8E22\u51FA</p><p>\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684\u95E8\u6237\u7F51\u7AD9\u4F1A\u914D\u7F6EGateway\u7F51\u5173\u670D\u52A1\u7684\u5730\u5740\uFF0C\u7531\u95E8\u6237\u7F51\u7AD9\u7528\u6237\u8BF7\u6C42\u7684\u5FAE\u670D\u52A1\u4FE1\u606F\uFF0C\u8F6C\u53D1\u7ED9Gateway\u7F51\u5173\u7A0B\u5E8F\uFF0C\u6240\u6709\u7684\u5FAE\u670D\u52A1\u90FD\u4F1A\u6CE8\u518C\u5728Eureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\uFF0CGateway\u7F51\u5173\u4F1A\u5C06\u8BF7\u6C42\u901A\u8FC7\u6CE8\u518C\u4E2D\u5FC3\u8F6C\u53D1\u7ED9\u5BF9\u5E94\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u3002 <img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/0225cafb98dd43d98ddd102cf1203791.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_1-3-\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3" tabindex="-1">1.3.\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3 <a class="header-anchor" href="#_1-3-\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3" aria-hidden="true">#</a></h3><p>\u5FAE\u670D\u52A1\u9762\u5BF9\u7740\u5F88\u591A\u95EE\u9898\uFF1A</p><ul><li>\u5982\u4F55\u8BB0\u5F55\u4E00\u4E2A\u5FAE\u670D\u52A1\u526F\u672C\u7684\u63A5\u53E3\u5730\u5740\uFF0C\u5982\u4F55\u5BF9\u591A\u4E2A\u5FAE\u670D\u52A1\u8282\u70B9\u7EC4\u6210\u7684\u96C6\u7FA4\u505A\u8D1F\u8F7D\u5747\u8861</li><li>\u7B26\u5408\u5224\u65AD\u96C6\u7FA4\u4E2D\u67D0\u4E00\u4E2A\u5FAE\u670D\u52A1\u662F\u5426\u53EF\u7528</li></ul><p>\u5FAE\u670D\u52A1\u9762\u4E34\u7684\u8FD9\u4E9B\u95EE\u9898\u90FD\u53EF\u4EE5\u901A\u8FC7\u6CE8\u518C\u4E2D\u5FC3\u53BB\u89E3\u51B3\uFF0C\u5728\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u53EF\u7528\u8BB0\u5F55\u67D0\u4E00\u4E2A\u5FAE\u670D\u52A1\u7684\u6240\u6709\u526F\u672C\u8282\u70B9\uFF0C\u5F53\u4E00\u4E2A\u526F\u672C\u8282\u70B9\u6302\u6389\u4E86\uFF0C\u6CE8\u518C\u4E2D\u5FC3\u4E5F\u4F1A\u5C06\u5176\u8E22\u51FA\u96C6\u7FA4\uFF0C\u6CE8\u518C\u4E2D\u5FC3\u4F1A\u5C06\u4E00\u4E2A\u5FAE\u670D\u52A1\u7684\u6240\u6709\u526F\u672C\u8282\u70B9\u81EA\u52A8\u5F62\u6210\u4E00\u4E2A\u8D1F\u8F7D\u5747\u8861</p><p>\u5728\u5FAE\u670D\u52A1\u4E2D\u914D\u5408\u6CE8\u518C\u4E2D\u5FC3\u5730\u5740\u4E4B\u540E\uFF0C\u7A0B\u5E8F\u4E00\u65E6\u542F\u52A8\uFF0C\u65E0\u9700\u914D\u7F6E\u6CE8\u518C\u4E2D\u5FC3\uFF0C\u4E14\u80FD\u591F\u81EA\u52A8\u6CE8\u518C\u5230\u6CE8\u518C\u4E2D\u5FC3</p><p>\u5FAE\u670D\u52A1\u63A5\u5165\u6CE8\u518C\u4E2D\u5FC3\u6D41\u7A0B\uFF1A\u5FAE\u670D\u52A1\u7A0B\u5E8F----&gt;\u6CE8\u518C----&gt;\u6CE8\u518C\u4E2D\u5FC3\u670D\u52A1\u5668</p><p>\u6CE8\u518C\u4E2D\u5FC3\u8C03\u7528\u5FAE\u670D\u52A1\u6D41\u7A0B\uFF1A\u5FAE\u670D\u52A1\u7F51\u5173\u7A0B\u5E8F----&gt;\u6CE8\u518C/\u67E5\u8BE2\u5FAE\u670D\u52A1\uFF08\u8C03\u7528\u5FAE\u670D\u52A1\uFF09----&gt;\u6CE8\u518C\u4E2D\u5FC3----&gt;\u5FAE\u670D\u52A1\u7A0B\u5E8F</p><p>\u5F53\u7136\u4E5F\u53EF\u4EE5\u4E0D\u9002\u7528\u6CE8\u518C\u4E2D\u5FC3\uFF0Ck8s\u81EA\u8EAB\u7684\u529F\u80FD\u5C31\u6709\u670D\u52A1\u53D1\u73B0\u81EA\u52A8\u5F62\u6210\u8D1F\u8F7D\u5747\u8861\uFF0C\u4E5F\u53EF\u4EE5\u7528\u5065\u5EB7\u68C0\u67E5\u76D1\u63A7\u670D\u52A1\u7684\u8FD0\u884C\u72B6\u51B5</p><p>\u76EE\u524D\u4E3B\u6D41\u7684\u6CE8\u518C\u4E2D\u5FC3\uFF1AEureka\u3001Nacos</p><h3 id="_1-4-\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\u5BF9\u4E8E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\u5982\u4F55\u7BA1\u7406" tabindex="-1">1.4.\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\u5BF9\u4E8E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\u5982\u4F55\u7BA1\u7406 <a class="header-anchor" href="#_1-4-\u4E0D\u540C\u7684\u90E8\u7F72\u73AF\u5883\u5BF9\u4E8E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\u5982\u4F55\u7BA1\u7406" aria-hidden="true">#</a></h3><p>\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u56DB\u79CD\u65B9\u5F0F\u6765\u7BA1\u7406\u4E0D\u540C\u73AF\u5883\u4F7F\u7528\u4E0D\u540C\u7684\u914D\u7F6E\u6587\u4EF6</p><ul><li>kubernetes configmap\u8D44\u6E90 <ul><li>\u53EF\u4EE5\u6839\u636E\u7EBF\u4E0A\u3001\u9884\u53D1\u5E03\u3001\u6D4B\u8BD5\u73AF\u5883\u7F16\u5199\u4E0D\u540C\u7684configmap\u8D44\u6E90\uFF0C\u7136\u540E\u5C06\u5176\u6302\u8F7D\u5230\u5BF9\u5E94\u7684deployment\u8D44\u6E90\u4E0A</li></ul></li><li>docker <a href="http://xn--entrypoint-c42qt0ml1inyuiq4bry0f.sh" target="_blank" rel="noopener noreferrer">\u5BB9\u5668\u542F\u52A8\u811A\u672Centrypoint.sh</a><ul><li>\u6839\u636E\u73AF\u5883\u7684\u4E0D\u540C\u5728entrypoint.sh\u58F0\u660E\u73AF\u5883\u53D8\u91CF\uFF0C\u8FD0\u884C\u7279\u5B9A\u7684\u914D\u7F6E\u6587\u4EF6</li></ul></li><li>java\u542F\u52A8\u547D\u4EE4\u63A7\u5236 <ul><li>java\u7A0B\u5E8F\u53EF\u4EE5\u540C\u65F6\u5B58\u5728\u591A\u4E2A\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\uFF0C\u53EF\u4EE5\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u58F0\u660E\u5404\u81EA\u7684\u53D8\u91CF\uFF0C\u7136\u540E\u4F7F\u7528<code>java --spring.profiles.active=xxx xxx.jar</code>\u7684\u65B9\u5F0F\u6765\u6307\u5B9A\u4E0D\u540C\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6</li></ul></li><li>\u4F7F\u7528\u5F00\u6E90\u7684\u7EDF\u4E00\u914D\u7F6E\u4E2D\u5FC3\u7A0B\u5E8F\uFF0C\u6BD4\u5982\u5E02\u9762\u4E0A\u4E3B\u6D41\u7684Apollo\u4EE5\u53CADisconf\uFF0C\u8FD9\u4E24\u6B3E\u7A0B\u5E8F\u90FD\u6709\u81EA\u5DF1\u7684\u56FE\u5F62\u5316\u7BA1\u7406\u7CFB\u7EDF\uFF0C\u914D\u7F6E\u53EF\u89C6\u5316</li></ul><h2 id="_2-\u5FAE\u670D\u52A1\u8FC1\u79FB\u81F3kubernetes\u5E73\u53F0\u6D41\u7A0B" tabindex="-1">2.\u5FAE\u670D\u52A1\u8FC1\u79FB\u81F3kubernetes\u5E73\u53F0\u6D41\u7A0B <a class="header-anchor" href="#_2-\u5FAE\u670D\u52A1\u8FC1\u79FB\u81F3kubernetes\u5E73\u53F0\u6D41\u7A0B" aria-hidden="true">#</a></h2><h3 id="_2-1-\u9879\u76EE\u8FC1\u79FB\u5230k8s\u5E73\u53F0\u6D41\u7A0B" tabindex="-1">2.1.\u9879\u76EE\u8FC1\u79FB\u5230K8S\u5E73\u53F0\u6D41\u7A0B <a class="header-anchor" href="#_2-1-\u9879\u76EE\u8FC1\u79FB\u5230k8s\u5E73\u53F0\u6D41\u7A0B" aria-hidden="true">#</a></h3><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/47633ea793f24a4b8727059870501e50.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"> \u9879\u76EE\u8FC1\u79FB\u5230K8S\u5E73\u53F0\u5927\u81F4\u6D41\u7A0B\u5206\u4E3A\u4EE5\u4E0B\u51E0\u4E2A\u9636\u6BB5\uFF1A</p><ul><li>\u5236\u4F5C\u7A0B\u5E8F\u955C\u50CF <ul><li>\u5728K8s\u73AF\u5883\uFF0C\u6240\u6709\u7684\u7A0B\u5E8F\u90FD\u662F\u4EE5Docker\u955C\u50CF\u6765\u8FD0\u884C\u7684\uFF0C\u4E00\u4E2A\u955C\u50CF\u5305\u542B\u4E86\u6587\u4EF6\u7CFB\u7EDF\u3001\u7A0B\u5E8F\u7684\u8FD0\u884C\u73AF\u5883\u3001\u7A0B\u5E8F\u672C\u8EAB\uFF0C\u53EF\u4EE5\u901A\u8FC7Dockerfile\u7684\u5F62\u5F0F\u5236\u4F5C\u955C\u50CF</li></ul></li><li>\u4F7F\u7528\u8D44\u6E90\u63A7\u5236\u5668\u7BA1\u7406Pod\u8D44\u6E90 <ul><li>\u7A0B\u5E8F\u955C\u50CF\u8FD0\u884C\u9700\u8981\u4F9D\u9760Pod\u8D44\u6E90\uFF0C\u9700\u8981\u6709Pod\u63A7\u5236\u5668\u53BB\u7BA1\u7406Pod\u8D44\u6E90</li><li>\u5E38\u89C1\u7684Pod\u63A7\u5236\u5668\uFF1ADeployment\uFF08\u65E0\u72B6\u6001\u7A0B\u5E8F\u90E8\u7F72\uFF09\u3001Statefulset\uFF08\u6709\u72B6\u6001\u7A0B\u5E8F\u90E8\u7F72\uFF09\u3001Job/CronJob\uFF08\u6279\u91CF\u5904\u7406\uFF09</li></ul></li><li>\u5C06Pod\u8D44\u6E90\u4F7F\u7528\u670D\u52A1\u53D1\u73B0\u5BF9\u5916\u8FDB\u884C\u66B4\u9732 <ul><li>Services\u8D44\u6E90\u6CE8\u610F\u901A\u8FC7label\u6807\u7B7E\u4E0EPod\u8FDB\u884C\u5173\u8054\uFF0C\u5B9E\u73B0\u5BF9\u4E00\u7EC4Pod\u7684\u81EA\u52A8\u8D1F\u8F7D\u5747\u8861\u4EE5\u53CA\u670D\u52A1\u53D1\u73B0</li><li>Services\u8D44\u6E90\u652F\u6301Cluster\u3001Nodeport\u3001LoadBalancer\u4E09\u79CD\u7C7B\u578B</li></ul></li><li>\u5BF9\u5916\u53D1\u5E03\u5E94\u7528\u7A0B\u5E8F <ul><li>\u53EF\u4EE5\u4F7F\u7528\u5355\u72EC\u7684nginx\u5BB9\u5668\u53BB\u53CD\u5411\u4EE3\u7406Cordns\u89E3\u6790\u7684services\u540D\u79F0\u5C06Pod\u5E94\u7528\u5BF9\u5916\u53D1\u5E03</li><li>\u4E5F\u53EF\u4EE5\u4F7F\u7528ingress+services\u7684\u65B9\u5F0F\u5C06\u5E94\u7528\u7A0B\u5E8F\u5BF9\u5916\u53D1\u5E03\uFF0C\u4F7F\u7528ingress\u7684\u524D\u63D0\u662F\u5FC5\u987B\u53EF\u4EE5\u901A\u8FC7\u57DF\u540D\u8BBF\u95EE\u5E94\u7528</li><li>\u67B6\u6784\u56FE\u5982\u4E0B <img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/4450dd7d3c994bb78ca36b43af66e28a.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></li></ul></li><li>\u540E\u671F\u7684\u65E5\u5FD7\u6536\u96C6\u4E0E\u76D1\u63A7 <ul><li>\u5F53\u5E94\u7528\u5728K8s\u7A0B\u5E8F\u8FD0\u884C\u540E\uFF0C\u5BF9\u4E8E\u7A0B\u5E8F\u7684\u65E5\u5FD7\u6BD4\u5982nginx\u3001tomcat\u8FD9\u4E9B\u65E5\u5FD7\u6587\u4EF6\u90FD\u4E0D\u4F1A\u505A\u6301\u4E45\u5316\uFF0C\u56E0\u6B64\u5C31\u9700\u8981\u8003\u8651\u5BF9\u65E5\u5FD7\u8FDB\u884C\u6536\u96C6\uFF0C\u53EF\u4EE5\u91C7\u7528Filebeat+ELK\u65B9\u5F0F\u5BF9\u7A0B\u5E8F\u65E5\u5FD7\u8FDB\u884C\u6536\u96C6</li><li>\u4F7F\u7528Prometheus+Grafana\u5BF9\u6574\u4E2AK8s\u5E73\u53F0\u8FDB\u884C\u5168\u65B9\u9762\u76D1\u63A7</li></ul></li></ul><h3 id="_2-2-\u4F20\u7EDF\u90E8\u7F72\u4E0Ek8s\u90E8\u7F72\u7684\u533A\u522B" tabindex="-1">2.2.\u4F20\u7EDF\u90E8\u7F72\u4E0EK8S\u90E8\u7F72\u7684\u533A\u522B <a class="header-anchor" href="#_2-2-\u4F20\u7EDF\u90E8\u7F72\u4E0Ek8s\u90E8\u7F72\u7684\u533A\u522B" aria-hidden="true">#</a></h3><blockquote><p><strong>\u4F20\u7EDF\u65B9\u5F0F\u90E8\u7F72\u9879\u76EE\u65B9\u5F0F\uFF1A</strong></p><p>\u9996\u5148\u7531\u5F00\u53D1\u4EBA\u5458\u63D0\u4EA4\u4EE3\u7801\u5230Gitlab\u4EE3\u7801\u4ED3\u5E93\uFF0CJenkins\u89E6\u53D1\u66F4\u65B0\u4ECEGitlab\u4E0A\u83B7\u53D6\u6700\u65B0\u4EE3\u7801\uFF0C\u901A\u8FC7maven\u5C06\u4EE3\u7801\u7F16\u8BD1\u6210war\u5305\u6216\u8005jar\u5305\uFF0C\u518D\u7531Jenkins\u901A\u8FC7\u5199\u597D\u7684\u81EA\u52A8\u5316\u90E8\u7F72\u811A\u672C\u6216\u8005Ansible\u81EA\u52A8\u5316\u7A0B\u5E8F\u5C06war\u5305\u90E8\u7F72\u5230\u7A0B\u5E8F\u6240\u5728\u7684\u4E91\u4E3B\u673A\uFF0C\u4E91\u4E3B\u673A\u4E00\u5B9A\u4F1A\u662F\u591A\u53F0\u7EC4\u6210\u7684\u8D1F\u8F7D\u5747\u8861\u96C6\u7FA4\uFF0C\u5C06\u8D1F\u8F7D\u5747\u8861VIP\u4E0E\u57DF\u540D\u8FDB\u884C\u7ED1\u5B9A\uFF0C\u7528\u6237\u901A\u8FC7\u8BBF\u95EE\u57DF\u540D\u7531\u8D1F\u8F7D\u5747\u8861\u8F6C\u53D1\u81F3\u5BF9\u5E94\u7684\u540E\u53F0\u4E3B\u673A\u3002</p><p>\u4F20\u7EDF\u67B6\u6784\u8FD0\u7EF4\u73AF\u5883\u4E00\u822C\u7531zabbix\u76D1\u63A7\u7CFB\u7EDF\u8FDB\u884C\u76D1\u63A7\uFF0C\u65E5\u5FD7\u91C7\u96C6\u4F1A\u4F7F\u7528ELK\u5E73\u53F0\u3002</p></blockquote><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/e34c94fc97e0416cb21cd00879244103.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><blockquote><p><strong>Kubernetes\u5E73\u53F0\u90E8\u7F72\u9879\u76EE\u65B9\u5F0F\uFF1A</strong></p><p>\u9996\u5148\u7531\u5F00\u53D1\u4EBA\u5458\u63D0\u4EA4\u4EE3\u7801\u5230Gitlab\u4EE3\u7801\u4ED3\u5E93\uFF0CJenkins\u89E6\u53D1\u66F4\u65B0\u4ECEGitlab\u4E0A\u83B7\u53D6\u6700\u65B0\u4EE3\u7801\uFF0C\u901A\u8FC7\u5199\u597D\u6D41\u6C34\u7EBF\u5C06\u7A0B\u5E8F\u6253\u5305\u6210Docker\u955C\u50CF\u5E76\u63A8\u9001\u81F3Harbor\u4ED3\u5E93\uFF0C\u518D\u7531Jenkins\u8C03\u7528K8s\u7684Master Api\u5C06\u7A0B\u5E8F\u7684\u955C\u50CF\u91C7\u7528Deployment\u63A7\u5236\u5668\u90E8\u7F72\u5230K8s\u96C6\u7FA4\uFF0C\u518D\u7531service\u8D44\u6E90\u66B4\u9732pod\u8D44\u6E90\uFF0C\u6700\u540E\u7531ingress\u6216\u8005nginx\u8D44\u6E90\u5C06\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51\u3002</p></blockquote><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/3ca0d364bdc24690a04d4ca95eb1cb05.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h2 id="_3-\u5FAE\u670D\u52A1\u7A0B\u5E8F\u524D\u671F\u73AF\u5883\u51C6\u5907\uFF08\u914D\u7F6E\u3001\u7F16\u8BD1\u3001\u5236\u4F5C\u955C\u50CF\uFF09" tabindex="-1">3.\u5FAE\u670D\u52A1\u7A0B\u5E8F\u524D\u671F\u73AF\u5883\u51C6\u5907\uFF08\u914D\u7F6E\u3001\u7F16\u8BD1\u3001\u5236\u4F5C\u955C\u50CF\uFF09 <a class="header-anchor" href="#_3-\u5FAE\u670D\u52A1\u7A0B\u5E8F\u524D\u671F\u73AF\u5883\u51C6\u5907\uFF08\u914D\u7F6E\u3001\u7F16\u8BD1\u3001\u5236\u4F5C\u955C\u50CF\uFF09" aria-hidden="true">#</a></h2><h3 id="_3-1-simple-microservice\u5FAE\u670D\u52A1\u9879\u76EE\u4ECB\u7ECD" tabindex="-1">3.1.simple-microservice\u5FAE\u670D\u52A1\u9879\u76EE\u4ECB\u7ECD <a class="header-anchor" href="#_3-1-simple-microservice\u5FAE\u670D\u52A1\u9879\u76EE\u4ECB\u7ECD" aria-hidden="true">#</a></h3><p>\u672C\u6B21\u4F7F\u7528\u7684\u5FAE\u670D\u52A1\u4E3Aspring cloud\u7684\u7535\u5546\u5E73\u53F0\u9879\u76EE</p><p>\u9879\u76EE\u540D\u79F0\uFF1Asimple-microservice</p><p>simple-microservice\u5FAE\u670D\u52A1\u7684\u5404\u4E2A\u7A0B\u5E8F\uFF1A</p><ul><li>eureka-service\uFF08\u6CE8\u518C\u4E2D\u5FC3\uFF09</li><li>gateway-service\uFF08\u7F51\u7BA1\u670D\u52A1\uFF09</li><li>order-service\uFF08\u8BA2\u5355\u670D\u52A1\uFF09</li><li>product-service\uFF08\u5546\u54C1\u670D\u52A1\uFF09</li><li>portal-service\uFF08\u95E8\u6237\u7F51\u7AD9\uFF09</li><li>stock-service\uFF08\u5E93\u5B58\u670D\u52A1\uFF09</li></ul><p>\u7528\u6237\u8BF7\u6C42\u9996\u5148\u5230Protal\u524D\u7AEF\u9875\u9762\uFF0C\u4E5F\u5C31\u662F\u7A0B\u5E8F\u7684\u9996\u9875\uFF0C\u5728\u9996\u9875\u7684\u5404\u9879\u529F\u80FD\u64CD\u4F5C\u90FD\u4F1A\u7531Gateway\u7F51\u5173\u670D\u52A1\u8F6C\u53D1\u5230\u5404\u81EA\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u4E0A\uFF0C\u6BD4\u5982\u8BF7\u6C42\u4E00\u4E2A\u8BA2\u5355\u670D\u52A1\uFF0C\u8BA2\u5355\u670D\u52A1\u4F1A\u4E8B\u5148\u6CE8\u518C\u5230Eureka\u4E2D\uFF0C\u7531Gateway\u5C06\u8BF7\u6C42\u53D1\u9001\u7ED9Eureka\uFF0C\u518D\u7531Eureka\u8F6C\u53D1\u7ED9\u5177\u4F53\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\uFF0C\u8FD9\u4E9B\u5FAE\u670D\u52A1\u7A0B\u5E8F\u90FD\u6709\u81EA\u5DF1\u5355\u72EC\u7684\u6570\u636E\u5E93\u670D\u52A1\u3002</p><p>\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684\u95E8\u6237\u7F51\u7AD9\u4F1A\u914D\u7F6EGateway\u7F51\u5173\u670D\u52A1\u7684\u5730\u5740\uFF0C\u7531\u95E8\u6237\u7F51\u7AD9\u7528\u6237\u8BF7\u6C42\u7684\u5FAE\u670D\u52A1\u4FE1\u606F\uFF0C\u8F6C\u53D1\u7ED9Gateway\u7F51\u5173\u7A0B\u5E8F\uFF0C\u6240\u6709\u7684\u5FAE\u670D\u52A1\u90FD\u4F1A\u6CE8\u518C\u5728Eureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\uFF0CGateway\u7F51\u5173\u4F1A\u5C06\u8BF7\u6C42\u901A\u8FC7\u6CE8\u518C\u4E2D\u5FC3\u8F6C\u53D1\u7ED9\u5BF9\u5E94\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u3002 <img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/b89c6c882bbe4a2d9ab53f97d5fe1f35.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u8BE5\u5FAE\u670D\u52A1\u7A0B\u5E8F\u4EE3\u7801\u53EF\u4EE5\u6258\u7BA1\u5728gitlab\u4EE3\u7801\u4ED3\u5E93\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5EFA\u7ACB\u591A\u4E2A\u5206\u652F\u6A21\u62DF\u4ECE\u5F00\u53D1\u5230\u4E0A\u7EBF\u7684\u6D41\u7A0B\uFF0C\u7406\u5FF5\uFF1A\u5206\u522B\u521B\u5EFA5\u4E2A\u5206\u652F\uFF0C\u5728\u6BCF\u4E2A\u5206\u652F\u4E2D\u589E\u52A0\u5BF9\u5E94\u7684\u4EE3\u7801\uFF0C\u6700\u540E\u5408\u5E76\u5230master\u5206\u652F\uFF0C\u4E5F\u53EF\u4EE5\u76F4\u63A5\u5C31\u5728master\u5206\u652F\u4E0A\u65B0\u589E\u914D\u7F6E\u6587\u4EF6\uFF0C\u6211\u662F\u76F4\u63A5\u62C9\u53D6dev1\u5206\u652F\uFF0C\u53EA\u6709\u7A0B\u5E8F\u4EE3\u7801\u7684\u5206\u652F\uFF0C\u7136\u540E\u65B0\u589E\u4E00\u7CFB\u5217\u914D\u7F6E\uFF0C\u6700\u540E\u4E0A\u7EBF\u3002</p><p>\u62C9\u53D6dev1\u5206\u652F\uFF0C\u8FDB\u884C\u4E00\u7CFB\u5217\u914D\u7F6E\u7684\u8BDD\uFF0C\u9996\u5148\u8981\u628Amaster\u5206\u652F\u91CC\u7684protal\u7A0B\u5E8F\u4EE3\u7801\u540C\u6B65\u5230dev1\u5206\u652F\u91CC\uFF0C\u56E0\u4E3Adev1\u7684protal\u7A0B\u5E8F\u4EE3\u7801\u6709\u70B9bug\uFF0C\u6574\u4E2A\u5FAE\u670D\u52A1\u8FD0\u884C\u5B8C\u6BD5\u540E\uFF0Corder\u8BA2\u5355\u670D\u52A1\u4F1A\u62A5\u9519\u3002</p><p>\u5206\u522B\u6709\u4E94\u4E2A\u5206\u652F\uFF1A</p><ul><li>dev1\uFF1A\u4EA4\u4ED8\u4EE3\u7801</li><li>dev2\uFF1A\u65B0\u589E\u7A0B\u5E8F\u6253\u5305\u7684Dockerfile\u6587\u4EF6</li><li>dev3\uFF1A\u65B0\u589EK8s\u8D44\u6E90\u7F16\u6392Yaml\u6587\u4EF6</li><li>dev4\uFF1A\u5FAE\u670D\u52A1\u94FE\u8DEF\u76D1\u63A7</li><li>dev5\uFF1A\u65B0\u529F\u80FD\u4EE3\u7801\u66F4\u65B0\u4E0A\u7EBF</li><li>master\uFF1A\u4E0A\u7EBF\u7248\u672C</li></ul><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/258d6fe2cd114cd58843209bdf1f85de.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_3-2-simple\u5FAE\u670D\u52A1\u90E8\u7F72\u5230k8s\u903B\u8F91\u67B6\u6784" tabindex="-1">3.2.simple\u5FAE\u670D\u52A1\u90E8\u7F72\u5230K8S\u903B\u8F91\u67B6\u6784 <a class="header-anchor" href="#_3-2-simple\u5FAE\u670D\u52A1\u90E8\u7F72\u5230k8s\u903B\u8F91\u67B6\u6784" aria-hidden="true">#</a></h3><p><strong>simple-microservice\u5FAE\u670D\u52A1\u90E8\u7F72\u5230k8s\u5E73\u53F0\u4E3B\u8981\u5206\u4E3A\u5982\u4E0B\u51E0\u4E2A\u6B65\u9AA4\uFF1A</strong></p><ul><li>\u4FEE\u6539\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6\uFF0C\u5C06\u6570\u636E\u5E93\u7B49\u5404\u7EC4\u4EF6\u5730\u5740\u4FEE\u6539\u4E3A\u5F53\u524D\u73AF\u5883</li><li>\u5C06\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u4F7F\u7528Maven\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684jar\u5305</li><li>\u7F16\u5199Dockerfile\u5C06\u7A0B\u5E8F\u505A\u6210docker\u955C\u50CF</li></ul><p><strong>\u5BF9K8S\u73AF\u5883\u7684\u8981\u6C42\uFF1A</strong></p><p>\u4E00\u5957\u5B8C\u6574\u7684K8S\u96C6\u7FA4\u3001\u6709cordns\u53EF\u4EE5\u89E3\u6790Service\u5730\u5740\u3001Harbor\u955C\u50CF\u4ED3\u5E93\u3001Nginx\u5BB9\u5668\u5C06\u9879\u76EE\u53D1\u5E03\u5230\u4E92\u8054\u7F51\u6216\u8005INgress\u8D44\u6E90\u5C06\u9879\u76EE\u53D1\u5E03\u5230\u4E92\u8054\u7F51\u3002</p><p><strong>\u5FAE\u670D\u52A1\u90E8\u7F72\u5230K8S\u73AF\u5883\u4E4B\u540E\u67B6\u6784\u662F\u600E\u6837\u7684</strong></p><blockquote><p>\u9996\u5148\u7528\u6237\u8BBF\u95EE\u7F51\u7AD9\u7684\u57DF\u540D\uFF0C\u8BF7\u6C42\u8FBE\u5230\u524D\u7AEF\u9875\u9762\uFF0C\u70B9\u51FB\u524D\u7AEF\u9875\u9762\u4E2D\u7684\u529F\u80FD\u8DF3\u8F6C\u5230\u4E0D\u540C\u7684\u5FAE\u670D\u52A1\uFF0C\u6BD4\u5982\u5546\u54C1\u670D\u52A1\uFF0C\u5C06\u5546\u54C1\u670D\u52A1\u7684\u8BF7\u6C42\u4EA4\u4E2AGateway\u7F51\u5173\u670D\u52A1\uFF0C\u7531\u7F51\u5173\u670D\u52A1\u8F6C\u53D1\u7ED9\u5546\u54C1\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8FProduct\uFF0C\u5404\u4E2A\u5FAE\u670D\u52A1\u4E4B\u95F4\u7684\u8C03\u7528\uFF0C\u90FD\u4ECEEureka\u6CE8\u518C\u4E2D\u5FC3\u8BFB\u53D6\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F\u5B8C\u6210\u8C03\u5EA6\uFF0CProduct\uFF08\u5546\u54C1\uFF09\u3001Order\uFF08\u8BA2\u5355\uFF09\u3001Stock\uFF08\u5E93\u5B58\uFF09\u90FD\u6709\u5355\u72EC\u7684\u6570\u636E\u5E93\uFF0CMySQL\u6570\u636E\u90E8\u7F72\u5728K8S\u96C6\u7FA4\u4E4B\u5916\u3002</p><p>\u670D\u52A1\u53D1\u5E03\u5230\u4E92\u8054\u7F51\u91C7\u7528Nginx\u800C\u4E0D\u91C7\u7528Ingress\uFF0CNginx\u53EF\u4EE5\u914D\u7F6E\u66F4\u591A\u7684\u53C2\u6570\uFF0C\u5C06Nginx\u5BB9\u5668\u8FD0\u884C\u5728\u6BCF\u4E00\u4E2ANode\u4E3B\u673A\u4E0A\uFF0C\u6620\u5C04Node\u4E3B\u673A\u768480/443\u7AEF\u53E3\uFF0C\u901A\u8FC7\u5728hosts\u6587\u4EF6\u91CC\u7ED1\u5B9Anode\u4E3B\u673Aip+\u7A0B\u5E8F\u57DF\u540D\u7684\u65B9\u5F0F\u8BBF\u95EE\u5FAE\u670D\u52A1\u3002</p></blockquote><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/60f3e04a6fb3410cbdc1f54eee6a7c4e.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_3-3-\u51C6\u5907\u5FAE\u670D\u52A1\u5404\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6" tabindex="-1">3.3.\u51C6\u5907\u5FAE\u670D\u52A1\u5404\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#_3-3-\u51C6\u5907\u5FAE\u670D\u52A1\u5404\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h3><p>\u5728\u4F7F\u7528Maven\u4E4B\u524D\uFF0C\u9996\u5148\u5C06\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6\u8FDB\u884C\u4FEE\u6539\uFF0C\u7F16\u8BD1\u6210\u529F\u4E4B\u540E\u518D\u60F3\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u5185\u5BB9\uFF0C\u5C31\u9700\u8981\u91CD\u65B0\u7F16\u8BD1\u4E86\uFF0C\u5C06\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7684\u73AF\u5883\u5730\u5740\u90FD\u4FEE\u6539\u6210\u81EA\u5DF1\u73AF\u5883\u7684\u5730\u5740\u3002</p><p>\u62C9\u53D6dev1\u5206\u652F\u5C55\u5F00\u5168\u65B0\u914D\u7F6E</p><h4 id="_3-3-1-\u521B\u5EFA\u5FAE\u670D\u52A1\u5404\u4E2A\u7A0B\u5E8F\u7684prod\u914D\u7F6E\u6587\u4EF6" tabindex="-1">3.3.1.\u521B\u5EFA\u5FAE\u670D\u52A1\u5404\u4E2A\u7A0B\u5E8F\u7684prod\u914D\u7F6E\u6587\u4EF6 <a class="header-anchor" href="#_3-3-1-\u521B\u5EFA\u5FAE\u670D\u52A1\u5404\u4E2A\u7A0B\u5E8F\u7684prod\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a></h4><p>eureka\uFF08\u6CE8\u518C\u4E2D\u5FC3\uFF09\u3001gateway\uFF08\u7F51\u5173\uFF09\u3001order\uFF08\u8BA2\u5355\uFF09\u3001portal\uFF08\u9996\u9875\uFF09\u3001product\uFF08\u5546\u54C1\uFF09\u3001stock\uFF08\u5E93\u5B58\uFF09\u8FD9\u51E0\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u90FD\u9700\u8981\u914D\u7F6E\uFF0C\u65B0\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u7528\u4E8E\u7EBF\u4E0A\u751F\u4EA7\u73AF\u5883</p><p>order\uFF08\u8BA2\u5355\uFF09\u3001product\uFF08\u5546\u54C1\uFF09\u3001stock\uFF08\u5E93\u5B58\uFF09\u8FD9\u4E9B\u5FAE\u670D\u52A1\u6709\u4E24\u4E2A\u5305\uFF0C\u5206\u522B\u662Fxxx-biz\u548Cxxx-api\uFF0C\u53EA\u9700\u8981\u90E8\u7F72biz\u76EE\u5F55\u4E0B\u7684jar\u5305\u5373\u53EF\uFF0Capi\u7684\u76EE\u5F55\u53EA\u662F\u5B58\u5728\u4E00\u4E9B\u4F9D\u8D56</p><p>order\uFF08\u8BA2\u5355\uFF09\u3001product\uFF08\u5546\u54C1\uFF09\u3001stock\uFF08\u5E93\u5B58\uFF09\u8FD9\u4E9B\u5FAE\u670D\u52A1\u90FD\u6709\u81EA\u5DF1\u5355\u72EC\u7684\u6570\u636E\u5E93</p><p>\u5148\u5C06prod\u7684\u914D\u7F6E\u6587\u4EF6\u521B\u5EFA\u51FA\u6765\uFF0C\u5F85eureka\u9879\u76EE\u90E8\u7F72\u5B8C\u6210\u540E\uFF0C\u518D\u8FDB\u884C\u8FDB\u4E00\u6B65\u7684\u4FEE\u6539\uFF0C\u6700\u540E\u5C06\u7A0B\u5E8F\u7F16\u8BD1</p><p><strong>1.eureka-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> eureka-service/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080        </span><span style="color:#758575;">#eureka\u7684\u7AEF\u53E3\u53F7</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: legendshop-basic-eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod    </span><span style="color:#758575;">#\u5C06\u8FD9\u91CC\u4FEE\u6539\u4E3Aprod\u5C31\u4F1A\u8C03\u7528prod\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6Eeureka\u670D\u52A1\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  server:</span></span>
<span class="line"><span style="color:#DBD7CA;">    renewal-percent-threshold: 0.9</span></span>
<span class="line"><span style="color:#DBD7CA;">    enable-self-preservation: </span><span style="color:#E0A569;">false</span></span>
<span class="line"><span style="color:#DBD7CA;">    eviction-interval-timer-in-ms: 40000</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    hostname: 127.0.0.1</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">false</span></span>
<span class="line"><span style="color:#DBD7CA;">    serviceUrl:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://127.0.0.1:</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">server.port</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/eureka/</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">false</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> eureka-service/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080        </span><span style="color:#A0ADA0;">#eureka\u7684\u7AEF\u53E3\u53F7</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: legendshop-basic-eureka</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod    </span><span style="color:#A0ADA0;">#\u5C06\u8FD9\u91CC\u4FEE\u6539\u4E3Aprod\u5C31\u4F1A\u8C03\u7528prod\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6Eeureka\u670D\u52A1\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/eureka-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  server:</span></span>
<span class="line"><span style="color:#393A34;">    renewal-percent-threshold: 0.9</span></span>
<span class="line"><span style="color:#393A34;">    enable-self-preservation: </span><span style="color:#B58451;">false</span></span>
<span class="line"><span style="color:#393A34;">    eviction-interval-timer-in-ms: 40000</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    hostname: 127.0.0.1</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">false</span></span>
<span class="line"><span style="color:#393A34;">    serviceUrl:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://127.0.0.1:</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">server.port</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/eureka/</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">false</span></span>
<span class="line"></span></code></pre></div><p><strong>2.gateway-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> gateway-service/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cat application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: @artifactId@</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6    </span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    service-url:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#758575;">#\u4FEE\u6539eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> gateway-service/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cat application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: @artifactId@</span></span>
<span class="line"><span style="color:#393A34;">    </span></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6    </span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/gateway-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    service-url:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#A0ADA0;">#\u4FEE\u6539eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre></div><p><strong>3.order-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> order-service/order-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: order-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6    </span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  datasource:</span></span>
<span class="line"><span style="color:#DBD7CA;">    url: jdbc:mysql://192.168.20.11:3306/tb_order</span><span style="color:#CB7676;">?</span><span style="color:#DBD7CA;">characterEncoding=utf-8     </span><span style="color:#758575;">#mysql\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#DBD7CA;">    username: root  </span></span>
<span class="line"><span style="color:#DBD7CA;">    password: 123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    service-url:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#758575;">#eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> order-service/order-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: order-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6    </span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/order-service/order-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  datasource:</span></span>
<span class="line"><span style="color:#393A34;">    url: jdbc:mysql://192.168.20.11:3306/tb_order</span><span style="color:#AB5959;">?</span><span style="color:#393A34;">characterEncoding=utf-8     </span><span style="color:#A0ADA0;">#mysql\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#393A34;">    username: root  </span></span>
<span class="line"><span style="color:#393A34;">    password: 123456</span></span>
<span class="line"><span style="color:#393A34;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    service-url:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#A0ADA0;">#eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre></div><p><strong>5.product-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> product-service/product-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: product-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  datasource:</span></span>
<span class="line"><span style="color:#DBD7CA;">    url: jdbc:mysql://192.168.20.11:3306/tb_product</span><span style="color:#CB7676;">?</span><span style="color:#DBD7CA;">characterEncoding=utf-8     </span><span style="color:#758575;">#\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#DBD7CA;">    username: root</span></span>
<span class="line"><span style="color:#DBD7CA;">    password: 123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    service-url:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#758575;">#eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> product-service/product-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: product-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/product-service/product-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  datasource:</span></span>
<span class="line"><span style="color:#393A34;">    url: jdbc:mysql://192.168.20.11:3306/tb_product</span><span style="color:#AB5959;">?</span><span style="color:#393A34;">characterEncoding=utf-8     </span><span style="color:#A0ADA0;">#\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#393A34;">    username: root</span></span>
<span class="line"><span style="color:#393A34;">    password: 123456</span></span>
<span class="line"><span style="color:#393A34;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    service-url:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#A0ADA0;">#eureka\u5730\u5740</span></span>
<span class="line"></span></code></pre></div><p><strong>6.stock-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> stock-service/stock-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: stock-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  datasource:</span></span>
<span class="line"><span style="color:#DBD7CA;">    url: jdbc:mysql://192.168.20.11:3306/tb_stock</span><span style="color:#CB7676;">?</span><span style="color:#DBD7CA;">characterEncoding=utf-8   </span><span style="color:#758575;">#\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#DBD7CA;">    username: root</span></span>
<span class="line"><span style="color:#DBD7CA;">    password: 123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    service-url:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-service.eureka:8080/eureka/      </span><span style="color:#758575;">#eureka\u5730\u5740                            </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> stock-service/stock-service-biz/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: stock-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  datasource:</span></span>
<span class="line"><span style="color:#393A34;">    url: jdbc:mysql://192.168.20.11:3306/tb_stock</span><span style="color:#AB5959;">?</span><span style="color:#393A34;">characterEncoding=utf-8   </span><span style="color:#A0ADA0;">#\u6570\u636E\u5E93\u5730\u5740</span></span>
<span class="line"><span style="color:#393A34;">    username: root</span></span>
<span class="line"><span style="color:#393A34;">    password: 123456</span></span>
<span class="line"><span style="color:#393A34;">    driver-class-name: com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    service-url:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-service.eureka:8080/eureka/      </span><span style="color:#A0ADA0;">#eureka\u5730\u5740                            </span></span>
<span class="line"></span></code></pre></div><p><strong>4.portal-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> portal-service/src/main/resources/</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">server:</span></span>
<span class="line"><span style="color:#DBD7CA;">  port: 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">  undertow:</span></span>
<span class="line"><span style="color:#DBD7CA;">    io-threads: 16</span></span>
<span class="line"><span style="color:#DBD7CA;">    worker-threads: 256</span></span>
<span class="line"><span style="color:#DBD7CA;">    buffer-size: 1024</span></span>
<span class="line"><span style="color:#DBD7CA;">    direct-buffers: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">spring:</span></span>
<span class="line"><span style="color:#DBD7CA;">  application:</span></span>
<span class="line"><span style="color:#DBD7CA;">    name: portal-service</span></span>
<span class="line"><span style="color:#DBD7CA;">  profiles:</span></span>
<span class="line"><span style="color:#DBD7CA;">    active: prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    service-url:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#758575;">#\u6307\u5B9Aeureka\u5730\u5740</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u521B\u5EFA\u4E00\u4E2Aprod\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> portal-service/src/main/resources/</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cp application-fat.yml application-prod.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7A0B\u5E8F\u4F7F\u7528prod\u7684\u914D\u7F6E\u6587\u4EF6\u8FD0\u884C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application.yml </span></span>
<span class="line"><span style="color:#393A34;">server:</span></span>
<span class="line"><span style="color:#393A34;">  port: 8080</span></span>
<span class="line"><span style="color:#393A34;">  undertow:</span></span>
<span class="line"><span style="color:#393A34;">    io-threads: 16</span></span>
<span class="line"><span style="color:#393A34;">    worker-threads: 256</span></span>
<span class="line"><span style="color:#393A34;">    buffer-size: 1024</span></span>
<span class="line"><span style="color:#393A34;">    direct-buffers: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">spring:</span></span>
<span class="line"><span style="color:#393A34;">  application:</span></span>
<span class="line"><span style="color:#393A34;">    name: portal-service</span></span>
<span class="line"><span style="color:#393A34;">  profiles:</span></span>
<span class="line"><span style="color:#393A34;">    active: prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u914D\u7F6E\u7A0B\u5E8F\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/portal-service/src/main/resources</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim application-prod.yml </span></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    service-url:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-0.eureka-service:8080/eureka/      </span><span style="color:#A0ADA0;">#\u6307\u5B9Aeureka\u5730\u5740</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span></code></pre></div><h4 id="_3-3-2-\u8C03\u6574\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7684pom\u6587\u4EF6\u589E\u52A0prod\u73AF\u5883" tabindex="-1">3.3.2.\u8C03\u6574\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7684pom\u6587\u4EF6\u589E\u52A0prod\u73AF\u5883 <a class="header-anchor" href="#_3-3-2-\u8C03\u6574\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7684pom\u6587\u4EF6\u589E\u52A0prod\u73AF\u5883" aria-hidden="true">#</a></h4><p>\u7531\u4E8E\u6211\u4EEC\u65B0\u52A0\u4E86\u4E00\u4E2Aprod\u7EBF\u4E0A\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u56E0\u6B64\u4E5F\u9700\u8981\u5728pom.xml\u4E2D\u914D\u7F6E\uFF0C\u914D\u7F6E\u5B8C\u6210\u540E\u53EF\u4EE5\u7F16\u8BD1\u4E00\u4E0B\uFF0C\u770B\u770B\u662F\u5426\u53EF\u4EE5\u505A\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F\u5305</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u5B89\u88C5maven</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> yum -y install java-1.8.0-openjdk maven</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u8C03\u6574pom.xml\u589E\u52A0prod\u73AF\u5883\u914D\u7F6E</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim pom.xml </span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7      </span><span style="color:#758575;">#65\u884C\u5DE6\u53F3</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">profile</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">id</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">prod</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/id</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">properties</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">profileActive</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">prod</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/profileActive</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/properties</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/profile</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/profiles</span><span style="color:#CB7676;">&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u7F16\u8BD1\u7A0B\u5E8F</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u67E5\u770B\u7F16\u8BD1\u6210\u529F\u7684war\u5305</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> find </span><span style="color:#E0A569;">.</span><span style="color:#DBD7CA;"> -name </span><span style="color:#C98A7D;">&quot;*.jar&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">./basic-common/basic-common-core/target/basic-common-core.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./eureka-service/target/eureka-service.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./gateway-service/target/gateway-service.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./order-service/order-service-api/target/order-service-api.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./order-service/order-service-biz/target/order-service-biz.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./portal-service/target/portal-service.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./product-service/product-service-api/target/product-service-api.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./product-service/product-service-biz/target/product-service-biz.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./stock-service/stock-service-api/target/stock-service-api.jar</span></span>
<span class="line"><span style="color:#DBD7CA;">./stock-service/stock-service-biz/target/stock-service-biz.jar</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u5B89\u88C5maven</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> yum -y install java-1.8.0-openjdk maven</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u8C03\u6574pom.xml\u589E\u52A0prod\u73AF\u5883\u914D\u7F6E</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim pom.xml </span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7      </span><span style="color:#A0ADA0;">#65\u884C\u5DE6\u53F3</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">profile</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">id</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">prod</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/id</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">properties</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">profileActive</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">prod</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/profileActive</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/properties</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/profile</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/profiles</span><span style="color:#AB5959;">&gt;</span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u7F16\u8BD1\u7A0B\u5E8F</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u67E5\u770B\u7F16\u8BD1\u6210\u529F\u7684war\u5305</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> find </span><span style="color:#B58451;">.</span><span style="color:#393A34;"> -name </span><span style="color:#B56959;">&quot;*.jar&quot;</span></span>
<span class="line"><span style="color:#393A34;">./basic-common/basic-common-core/target/basic-common-core.jar</span></span>
<span class="line"><span style="color:#393A34;">./eureka-service/target/eureka-service.jar</span></span>
<span class="line"><span style="color:#393A34;">./gateway-service/target/gateway-service.jar</span></span>
<span class="line"><span style="color:#393A34;">./order-service/order-service-api/target/order-service-api.jar</span></span>
<span class="line"><span style="color:#393A34;">./order-service/order-service-biz/target/order-service-biz.jar</span></span>
<span class="line"><span style="color:#393A34;">./portal-service/target/portal-service.jar</span></span>
<span class="line"><span style="color:#393A34;">./product-service/product-service-api/target/product-service-api.jar</span></span>
<span class="line"><span style="color:#393A34;">./product-service/product-service-biz/target/product-service-biz.jar</span></span>
<span class="line"><span style="color:#393A34;">./stock-service/stock-service-api/target/stock-service-api.jar</span></span>
<span class="line"><span style="color:#393A34;">./stock-service/stock-service-biz/target/stock-service-biz.jar</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-4-\u5236\u4F5C\u5FAE\u670D\u52A1\u7A0B\u5E8F\u6240\u4F7F\u7528\u7684\u7684\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF" tabindex="-1">3.4.\u5236\u4F5C\u5FAE\u670D\u52A1\u7A0B\u5E8F\u6240\u4F7F\u7528\u7684\u7684\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF <a class="header-anchor" href="#_3-4-\u5236\u4F5C\u5FAE\u670D\u52A1\u7A0B\u5E8F\u6240\u4F7F\u7528\u7684\u7684\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF" aria-hidden="true">#</a></h3><h4 id="_3-4-1-\u4E3A\u7A0B\u5E8F\u73AF\u5883\u6784\u5EFA\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF" tabindex="-1">3.4.1.\u4E3A\u7A0B\u5E8F\u73AF\u5883\u6784\u5EFA\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF <a class="header-anchor" href="#_3-4-1-\u4E3A\u7A0B\u5E8F\u73AF\u5883\u6784\u5EFA\u5E95\u5C42\u7CFB\u7EDF\u955C\u50CF" aria-hidden="true">#</a></h4><p>\u7531\u4E8E\u662FSpringCloud\u5FAE\u670D\u52A1\u7CFB\u7EDF\uFF0CSpringCloud\u5C5E\u4E8EJAVA\u8BED\u8A00\u5F00\u53D1\u7684\u9879\u76EE\uFF0C\u56E0\u6B64\u8981\u6709JAVA\u542F\u52A8\u73AF\u5883\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u62C9\u53D6centos7.5\u4F5C\u4E3A\u5E95\u5C42\u5BB9\u5668</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker pull centos:7.5.1804</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u542F\u52A8\u5BB9\u5668</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker run -itd centos:7.5.1804</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u8FDB\u5165\u7CFB\u7EDF\u5BB9\u5668\u8FDB\u884C\u73AF\u5883\u914D\u7F6E</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker </span><span style="color:#E0A569;">exec</span><span style="color:#DBD7CA;"> -it 462237f9a0a bash</span></span>
<span class="line"><span style="color:#758575;">#\u5B89\u88C5java\u73AF\u5883</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@2fcfb51f04e0 /</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> yum -y install java-1.8.0-openjdk net-tools</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@2fcfb51f04e0 /</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> java  -version</span></span>
<span class="line"><span style="color:#DBD7CA;">openjdk version </span><span style="color:#C98A7D;">&quot;1.8.0_302&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">OpenJDK Runtime Environment </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">build 1.8.0_302-b08</span><span style="color:#858585;">)</span></span>
<span class="line"><span style="color:#DBD7CA;">OpenJDK 64-Bit Server VM </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">build 25.302-b08, mixed mode</span><span style="color:#858585;">)</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@2fcfb51f04e0 /</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mkdir /data/simple-microservice -p</span></span>
<span class="line"><span style="color:#758575;">#\u8C03\u6574\u7CFB\u7EDF\u65F6\u533A</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@2fcfb51f04e0 /</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> yum -y intall tzdata</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@2fcfb51f04e0 /</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime </span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">4.\u5C06\u5BB9\u5668\u63D0\u4EA4\u4E3A\u955C\u50CF</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker commit 2fcfb51f04e0 centos-java:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">5.\u914D\u7F6EHarbor\u955C\u50CF\u4ED3\u5E93</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim /etc/docker/daemon.json </span></span>
<span class="line"><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">&quot;registry-mirrors&quot;</span><span style="color:#DBD7CA;">: </span><span style="color:#858585;">[</span><span style="color:#C98A7D;">&quot;https://9wn5tbfh.mirror.aliyuncs.com&quot;</span><span style="color:#858585;">]</span><span style="color:#DBD7CA;">,</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#C98A7D;">&quot;insecure-registries&quot;</span><span style="color:#DBD7CA;">: </span><span style="color:#858585;">[</span><span style="color:#C98A7D;">&quot;192.168.20.10&quot;</span><span style="color:#858585;">]</span></span>
<span class="line"><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> systemctl restart docker</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">6.\u63D0\u4EA4\u955C\u50CF\u5230Harbor\u4ED3\u5E93</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker login -u admin -p Harbor12345 192.168.20.10</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker tag centos-java:v1 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker push 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u62C9\u53D6centos7.5\u4F5C\u4E3A\u5E95\u5C42\u5BB9\u5668</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker pull centos:7.5.1804</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u542F\u52A8\u5BB9\u5668</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker run -itd centos:7.5.1804</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u8FDB\u5165\u7CFB\u7EDF\u5BB9\u5668\u8FDB\u884C\u73AF\u5883\u914D\u7F6E</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker </span><span style="color:#B58451;">exec</span><span style="color:#393A34;"> -it 462237f9a0a bash</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u5B89\u88C5java\u73AF\u5883</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@2fcfb51f04e0 /</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> yum -y install java-1.8.0-openjdk net-tools</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@2fcfb51f04e0 /</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> java  -version</span></span>
<span class="line"><span style="color:#393A34;">openjdk version </span><span style="color:#B56959;">&quot;1.8.0_302&quot;</span></span>
<span class="line"><span style="color:#393A34;">OpenJDK Runtime Environment </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">build 1.8.0_302-b08</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"><span style="color:#393A34;">OpenJDK 64-Bit Server VM </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">build 25.302-b08, mixed mode</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@2fcfb51f04e0 /</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mkdir /data/simple-microservice -p</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u8C03\u6574\u7CFB\u7EDF\u65F6\u533A</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@2fcfb51f04e0 /</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> yum -y intall tzdata</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@2fcfb51f04e0 /</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime </span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">4.\u5C06\u5BB9\u5668\u63D0\u4EA4\u4E3A\u955C\u50CF</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker commit 2fcfb51f04e0 centos-java:v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">5.\u914D\u7F6EHarbor\u955C\u50CF\u4ED3\u5E93</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim /etc/docker/daemon.json </span></span>
<span class="line"><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">&quot;registry-mirrors&quot;</span><span style="color:#393A34;">: </span><span style="color:#8E8F8B;">[</span><span style="color:#B56959;">&quot;https://9wn5tbfh.mirror.aliyuncs.com&quot;</span><span style="color:#8E8F8B;">]</span><span style="color:#393A34;">,</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#B56959;">&quot;insecure-registries&quot;</span><span style="color:#393A34;">: </span><span style="color:#8E8F8B;">[</span><span style="color:#B56959;">&quot;192.168.20.10&quot;</span><span style="color:#8E8F8B;">]</span></span>
<span class="line"><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> systemctl restart docker</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">6.\u63D0\u4EA4\u955C\u50CF\u5230Harbor\u4ED3\u5E93</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker login -u admin -p Harbor12345 192.168.20.10</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker tag centos-java:v1 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker push 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"></span></code></pre></div><h4 id="_3-4-2-\u4E3A\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7F16\u5199dockerfile" tabindex="-1">3.4.2.\u4E3A\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7F16\u5199Dockerfile <a class="header-anchor" href="#_3-4-2-\u4E3A\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7F16\u5199dockerfile" aria-hidden="true">#</a></h4><p><strong>\u8BBE\u8BA1\u6982\u5FF5\uFF1A</strong></p><p>\u91C7\u75283.3.1\u4E2D\u5236\u4F5C\u7684\u5E95\u5C42\u955C\u50CF</p><p>\u7B2C\u4E00\u6B65\uFF1A\u5728\u955C\u50CF\u91CC\u9762\u521B\u5EFA<code>/data/simple-microservice/\u5FAE\u670D\u52A1\u540D\u79F0</code>\u8FD9\u6837\u7684\u76EE\u5F55\u7528\u4E8E\u5B58\u653E\u7A0B\u5E8F\u7684jar\u5305</p><p>\u7B2C\u4E8C\u6B65\uFF1A\u5C06\u7A0B\u5E8F\u7684jar\u5305\u62F7\u8D1D\u81F3\u955C\u50CF\u4E2D</p><p>\u7B2C\u4E09\u6B65\uFF1A\u751F\u6210\u4E00\u4E2A\u542F\u52A8\u811A\u672C\uFF0C\u7531\u4E8E\u670D\u52A1\u540D\u79F0\u90FD\u4E0D\u4E00\u6837\u4E5F\u5C31\u662F\u6BCF\u4E2A\u7A0B\u5E8F\u7684\u8DEF\u5F84\u90FD\u4E0D\u540C\uFF0C\u60F3\u8981\u505A\u5230\u4E00\u4E2A\u5E95\u5C42\u955C\u50CF\u591A\u4E2A\u7A0B\u5E8F\u590D\u7528\uFF0C\u90A3\u4E48\u5C31\u9700\u8981\u5728\u542F\u52A8\u811A\u672C\u91CC\u624B\u52A8\u6307\u5B9A\u7A0B\u5E8F\u7684\u8DEF\u5F84\uFF0C\u5728\u811A\u672C\u4E2D\u6307\u5B9A\u7A0B\u5E8F\u7684\u90E8\u7F72\u8DEF\u5F84\u4EE5\u53CA\u65E5\u5FD7\u8DEF\u5F84</p><p>\u7B2C\u56DB\u6B65\uFF1A\u66B4\u97328080\u7AEF\u53E3</p><p>\u5C06Dockerfile\u653E\u5230\u7A0B\u5E8F\u7F16\u8BD1\u7684\u76EE\u5F55\u4E5F\u5C31\u662F\u4E0Esrc\u5728\u540C\u4E00\u76EE\u5F55</p><p><strong>1.eureka-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">\u57284.2.2.\u4F1A\u5199</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">\u57284.2.2.\u4F1A\u5199</span></span>
<span class="line"></span></code></pre></div><p><strong>2.gateway-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/gateway-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/gateway-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/gateway-service.jar /data/simple-microservice/gateway-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/gateway-service/gateway-service.jar &gt; /data/simple-microservice/gateway-service/gateway-service.log &amp; \\ntail -f /data/simple-microservice/gateway-service/gateway-service.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/gateway-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/gateway-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/gateway-service.jar /data/simple-microservice/gateway-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/gateway-service/gateway-service.jar &gt; /data/simple-microservice/gateway-service/gateway-service.log &amp; \\ntail -f /data/simple-microservice/gateway-service/gateway-service.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><p><strong>3.order-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/order-service/order-service-biz</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/order-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/order-service-biz.jar /data/simple-microservice/order-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/order-service/order-service-biz.jar &gt; /data/simple-microservice/order-service/order-service-biz.log &amp; \\ntail -f /data/simple-microservice/order-service/order-service-biz.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/order-service/order-service-biz</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/order-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/order-service-biz.jar /data/simple-microservice/order-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/order-service/order-service-biz.jar &gt; /data/simple-microservice/order-service/order-service-biz.log &amp; \\ntail -f /data/simple-microservice/order-service/order-service-biz.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><p><strong>4.portal-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/portal-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/portal-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/portal-service.jar /data/simple-microservice/portal-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/portal-service/portal-service.jar &gt; /data/simple-microservice/portal-service/portal-service.log &amp; \\ntail -f /data/simple-microservice/portal-service/portal-service.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/portal-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/portal-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/portal-service.jar /data/simple-microservice/portal-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/portal-service/portal-service.jar &gt; /data/simple-microservice/portal-service/portal-service.log &amp; \\ntail -f /data/simple-microservice/portal-service/portal-service.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><p><strong>5.product-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/product-service/product-service-biz</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim Dockerfile</span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/product-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/product-service-biz.jar /data/simple-microservice/product-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/product-service/product-service-biz.jar &gt; /data/simple-microservice/product-service/product-service-biz.log &amp; \\ntail -f /data/simple-microservice/product-service/product-service-biz.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/product-service/product-service-biz</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim Dockerfile</span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/product-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/product-service-biz.jar /data/simple-microservice/product-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/product-service/product-service-biz.jar &gt; /data/simple-microservice/product-service/product-service-biz.log &amp; \\ntail -f /data/simple-microservice/product-service/product-service-biz.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><p><strong>6.stock-service\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> cat Dockerfile</span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/stock-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/stock-service-biz.jar /data/simple-microservice/stock-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/stock-service/stock-service-biz.jar &gt; /data/simple-microservice/stock-service/stock-service-biz.log &amp; \\ntail -f /data/simple-microservice/stock-service/stock-service-biz.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/simple-microservice-dev1/stock-service/stock-service-biz</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> cat Dockerfile</span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/stock-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/stock-service-biz.jar /data/simple-microservice/stock-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar /data/simple-microservice/stock-service/stock-service-biz.jar &gt; /data/simple-microservice/stock-service/stock-service-biz.log &amp; \\ntail -f /data/simple-microservice/stock-service/stock-service-biz.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-5-\u8C03\u6574protal\u5FAE\u670D\u52A1\u4E2D\u8FDE\u63A5gateway\u7F51\u5173\u7684\u5730\u5740" tabindex="-1">3.5.\u8C03\u6574Protal\u5FAE\u670D\u52A1\u4E2D\u8FDE\u63A5Gateway\u7F51\u5173\u7684\u5730\u5740 <a class="header-anchor" href="#_3-5-\u8C03\u6574protal\u5FAE\u670D\u52A1\u4E2D\u8FDE\u63A5gateway\u7F51\u5173\u7684\u5730\u5740" aria-hidden="true">#</a></h3><p>Protal\u662F\u6211\u4EEC\u7535\u5546\u5E73\u53F0\u7684\u95E8\u6237\u7F51\u7AD9\uFF0C\u4E5F\u5C31\u662F\u524D\u7AEF\u9996\u9875\uFF0C\u5728Protal\u5FAE\u670D\u52A1\u4E2D\u4F1A\u586B\u5199\u597D\u5176\u4ED6\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684\u5730\u5740\uFF0CGateway\u7F51\u5173\u7A0B\u5E8F\u7684\u5730\u5740\u5C31\u662F\u5199\u6B7B\u5728Protal\u9879\u76EE\u7684js\u91CC\uFF0C\u5728\u6211\u4EEC\u5B9A\u4E49\u597DGateway\u7F51\u5173\u670D\u52A1\u7684\u57DF\u540D\u540E\uFF0C\u5C31\u8981\u5C06\u57DF\u540D\u5199\u5165\u5230\u5BF9\u5E94\u7684js\u6587\u4EF6\u91CC\uFF0C\u5426\u5219\u5F53\u9879\u76EE\u542F\u52A8\u4E4B\u540E\u662F\u65E0\u6CD5\u8C03\u901A\u7684\u3002</p><p>\u9700\u8981\u4FEE\u6539\u4E0B\u5217\u8FD9\u56DB\u4E2A\u6587\u4EF6</p><p>portal-service/src/main/resources/static/js/orderList.js</p><p>portal-service/src/main/resources/static/js/productList.js <img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/d0e207db0cb54e6296ca185728e5ed1c.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">\u6253\u5F00\u8FD9\u56DB\u4E2A\u6587\u4EF6\uFF0C\u5C06\u91CC\u9762\u7684gateway.ctnrs.com\u57DF\u540D\u4FEE\u6539\u4E3Agateway.jiangxl.com\u57DF\u540D</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">vim\u4FEE\u6539\u547D\u4EE4\uFF1A%s/gateway.ctnrs.com/gateway.jiangxl.com/g</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">\u6253\u5F00\u8FD9\u56DB\u4E2A\u6587\u4EF6\uFF0C\u5C06\u91CC\u9762\u7684gateway.ctnrs.com\u57DF\u540D\u4FEE\u6539\u4E3Agateway.jiangxl.com\u57DF\u540D</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">vim\u4FEE\u6539\u547D\u4EE4\uFF1A%s/gateway.ctnrs.com/gateway.jiangxl.com/g</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-6-\u90E8\u7F72ingress\u7528\u4E8E\u5C06\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51" tabindex="-1">3.6.\u90E8\u7F72Ingress\u7528\u4E8E\u5C06\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51 <a class="header-anchor" href="#_3-6-\u90E8\u7F72ingress\u7528\u4E8E\u5C06\u5FAE\u670D\u52A1\u7A0B\u5E8F\u53D1\u5E03\u5230\u4E92\u8054\u7F51" aria-hidden="true">#</a></h3><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u4E0B\u8F7Dingress\u90E8\u7F72\u7684yaml\u6587\u4EF6</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/mandatory.yaml</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/provider/baremetal/service-nodeport.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u8C03\u6574ingress nodeport\u7AEF\u53E3</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/ingress</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim service-nodeport.yaml</span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#DBD7CA;">  ports:</span></span>
<span class="line"><span style="color:#DBD7CA;">    - name: http</span></span>
<span class="line"><span style="color:#DBD7CA;">      port: 80</span></span>
<span class="line"><span style="color:#DBD7CA;">      targetPort: 80</span></span>
<span class="line"><span style="color:#DBD7CA;">      nodePort: 80</span></span>
<span class="line"><span style="color:#DBD7CA;">      protocol: TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">    - name: https</span></span>
<span class="line"><span style="color:#DBD7CA;">      port: 443</span></span>
<span class="line"><span style="color:#DBD7CA;">      targetPort: 443</span></span>
<span class="line"><span style="color:#DBD7CA;">      nodePort: 443</span></span>
<span class="line"><span style="color:#DBD7CA;">      protocol: TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u90E8\u7F72ingress</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#DBD7CA;">/springcloud/ingress</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl apply -f mandatory.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">4.\u67E5\u770Bingress\u90E8\u7F72\u7684\u7ED3\u679C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get all -n ingress-nginx</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                                            READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/nginx-ingress-controller-766867958b-n7dwj   1/1     Running   0          49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                    TYPE       CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">S</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;">                 AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">service/ingress-nginx   NodePort   10.0.0.107   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        80:80/TCP,443:443/TCP   49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                                       READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/nginx-ingress-controller   1/1     1            1           49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                                                  DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/nginx-ingress-controller-766867958b   1         1         1       49m</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u4E0B\u8F7Dingress\u90E8\u7F72\u7684yaml\u6587\u4EF6</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/mandatory.yaml</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/nginx-0.30.0/deploy/static/provider/baremetal/service-nodeport.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u8C03\u6574ingress nodeport\u7AEF\u53E3</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/ingress</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim service-nodeport.yaml</span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#393A34;">  ports:</span></span>
<span class="line"><span style="color:#393A34;">    - name: http</span></span>
<span class="line"><span style="color:#393A34;">      port: 80</span></span>
<span class="line"><span style="color:#393A34;">      targetPort: 80</span></span>
<span class="line"><span style="color:#393A34;">      nodePort: 80</span></span>
<span class="line"><span style="color:#393A34;">      protocol: TCP</span></span>
<span class="line"><span style="color:#393A34;">    - name: https</span></span>
<span class="line"><span style="color:#393A34;">      port: 443</span></span>
<span class="line"><span style="color:#393A34;">      targetPort: 443</span></span>
<span class="line"><span style="color:#393A34;">      nodePort: 443</span></span>
<span class="line"><span style="color:#393A34;">      protocol: TCP</span></span>
<span class="line"><span style="color:#393A34;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u90E8\u7F72ingress</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#393A34;">/springcloud/ingress</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl apply -f mandatory.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">4.\u67E5\u770Bingress\u90E8\u7F72\u7684\u7ED3\u679C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get all -n ingress-nginx</span></span>
<span class="line"><span style="color:#393A34;">NAME                                            READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">pod/nginx-ingress-controller-766867958b-n7dwj   1/1     Running   0          49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                    TYPE       CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">S</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;">                 AGE</span></span>
<span class="line"><span style="color:#393A34;">service/ingress-nginx   NodePort   10.0.0.107   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        80:80/TCP,443:443/TCP   49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                                       READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/nginx-ingress-controller   1/1     1            1           49m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                                                  DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/nginx-ingress-controller-766867958b   1         1         1       49m</span></span>
<span class="line"></span></code></pre></div><h2 id="_4-\u5728kubernetes\u96C6\u7FA4\u90E8\u7F72simple\u5FAE\u670D\u52A1\u9879\u76EE" tabindex="-1">4.\u5728kubernetes\u96C6\u7FA4\u90E8\u7F72simple\u5FAE\u670D\u52A1\u9879\u76EE <a class="header-anchor" href="#_4-\u5728kubernetes\u96C6\u7FA4\u90E8\u7F72simple\u5FAE\u670D\u52A1\u9879\u76EE" aria-hidden="true">#</a></h2><p>simple\u5FAE\u670D\u52A1\u9879\u76EE\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72\uFF0C\u53EA\u6709eureka\u670D\u52A1\u91C7\u7528statefulset\u63A7\u5236\u5668\u90E8\u7F72\uFF0C\u5176\u4F59\u6240\u6709\u5FAE\u670D\u52A1\u5747\u91C7\u7528deployment\u63A7\u5236\u5668\u90E8\u7F72\uFF0C\u6240\u6709\u7684\u5FAE\u670D\u52A1\u901A\u8FC7ingress\u53D1\u5E03\u5728\u4E92\u8054\u7F51\u3002</p><p><strong>simple\u5FAE\u670D\u52A1\u7535\u5546\u9879\u76EE\u5728K8S\u96C6\u7FA4\u90E8\u7F72\u6D41\u7A0B</strong></p><p>1\uFF09\u90E8\u7F72simple\u7535\u5546\u5FAE\u670D\u52A1\u9879\u76EE\u7684\u6570\u636E\u5E93\u73AF\u5883</p><p>2\uFF09\u5728K8S\u4E2D\u90E8\u7F72Eureka\u6CE8\u518C\u4E2D\u5FC3</p><p>3\uFF09\u4FEE\u6539\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u6307\u5B9Aeureka\u6CE8\u518C\u4E2D\u5FC3\u96C6\u7FA4\u7684\u5730\u5740</p><p>4\uFF09\u4F7F\u7528maven\u5C06\u6BCF\u4E2A\u5FAE\u670D\u52A1\u6784\u5EFA\u6210\u53EF\u90E8\u7F72\u7684jar\u5305</p><p>5\uFF09\u90E8\u7F72Gateway\u5173\u670D\u52A1</p><p>6\uFF09\u90E8\u7F72protal\u3001order\u3001product\u3001stock\u670D\u52A1</p><h3 id="_4-1-\u90E8\u7F72simple\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684mysql\u6570\u636E\u5E93\u73AF\u5883" tabindex="-1">4.1.\u90E8\u7F72simple\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684mysql\u6570\u636E\u5E93\u73AF\u5883 <a class="header-anchor" href="#_4-1-\u90E8\u7F72simple\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684mysql\u6570\u636E\u5E93\u73AF\u5883" aria-hidden="true">#</a></h3><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u5B89\u88C5MySQL\u6570\u636E\u5E93</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> rpm -ivh http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;">  yum install mysql-community-server </span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u542F\u52A8MySQL</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> systemctl start mysqld</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> systemctl </span><span style="color:#E0A569;">enable</span><span style="color:#DBD7CA;"> mysqld</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u8BBE\u7F6E\u6570\u636E\u5E93\u5BC6\u7801</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mysqladmin -u root password </span><span style="color:#C98A7D;">&#39;123456&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">4.\u521B\u5EFAorder\uFF08\u8BA2\u5355\uFF09\u3001product\uFF08\u5546\u54C1\uFF09\u3001stock\uFF08\u5E93\u5B58\uFF09\u5FAE\u670D\u52A1\u7684\u6570\u636E\u5E93</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@harbor-mysql </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mysql -uroot -p123456</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> create database tb_order</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, 1 row affected </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">0.00 sec</span><span style="color:#858585;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> create database tb_product</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, 1 row affected </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">0.01 sec</span><span style="color:#858585;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> create database tb_stock</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, 1 row affected </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">0.00 sec</span><span style="color:#858585;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">5.\u5BFC\u5165\u6570\u636E\u5E93\u6570\u636E</span></span>
<span class="line"><span style="color:#758575;">#\u5C06\u6570\u636E\u5E93\u6587\u4EF6\u4F20\u5230\u6570\u636E\u5E93\u670D\u52A1\u5668</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> scp -r db root@192.168.20.11:/root</span></span>
<span class="line"><span style="color:#758575;">#\u5BFC\u5165order\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> use tb_order</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">source</span><span style="color:#DBD7CA;"> /root/db/order.sql</span></span>
<span class="line"><span style="color:#758575;">#\u5BFC\u5165product\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> use tb_product</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">source</span><span style="color:#DBD7CA;"> /root/db/product.sql</span></span>
<span class="line"><span style="color:#758575;">#\u5BFC\u5165stock\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> use tb_stock</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">source</span><span style="color:#DBD7CA;"> /root/db/stock.sql</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">6.\u5141\u8BB8\u6570\u636E\u5E93\u8FDC\u7A0B\u8BBF\u95EE</span></span>
<span class="line"><span style="color:#DBD7CA;">mysql</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> grant all privileges on </span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;">.</span><span style="color:#CB7676;">*</span><span style="color:#DBD7CA;"> to </span><span style="color:#C98A7D;">&#39;root&#39;</span><span style="color:#DBD7CA;">@</span><span style="color:#C98A7D;">&#39;%&#39;</span><span style="color:#DBD7CA;"> identified by </span><span style="color:#C98A7D;">&#39;123456&#39;</span><span style="color:#DBD7CA;"> with grant option</span><span style="color:#CB7676;">;</span></span>
<span class="line"><span style="color:#DBD7CA;">Query OK, 0 rows affected </span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">0.00 sec</span><span style="color:#858585;">)</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u5B89\u88C5MySQL\u6570\u636E\u5E93</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> rpm -ivh http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64/mysql-community-release-el7-5.noarch.rpm</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;">  yum install mysql-community-server </span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u542F\u52A8MySQL</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> systemctl start mysqld</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> systemctl </span><span style="color:#B58451;">enable</span><span style="color:#393A34;"> mysqld</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u8BBE\u7F6E\u6570\u636E\u5E93\u5BC6\u7801</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mysqladmin -u root password </span><span style="color:#B56959;">&#39;123456&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">4.\u521B\u5EFAorder\uFF08\u8BA2\u5355\uFF09\u3001product\uFF08\u5546\u54C1\uFF09\u3001stock\uFF08\u5E93\u5B58\uFF09\u5FAE\u670D\u52A1\u7684\u6570\u636E\u5E93</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@harbor-mysql </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mysql -uroot -p123456</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> create database tb_order</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, 1 row affected </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">0.00 sec</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> create database tb_product</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, 1 row affected </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">0.01 sec</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> create database tb_stock</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, 1 row affected </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">0.00 sec</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">5.\u5BFC\u5165\u6570\u636E\u5E93\u6570\u636E</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u5C06\u6570\u636E\u5E93\u6587\u4EF6\u4F20\u5230\u6570\u636E\u5E93\u670D\u52A1\u5668</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> scp -r db root@192.168.20.11:/root</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u5BFC\u5165order\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> use tb_order</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#B58451;">source</span><span style="color:#393A34;"> /root/db/order.sql</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u5BFC\u5165product\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> use tb_product</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#B58451;">source</span><span style="color:#393A34;"> /root/db/product.sql</span></span>
<span class="line"><span style="color:#A0ADA0;">#\u5BFC\u5165stock\u6570\u636E\u5E93\u7684\u6570\u636E</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> use tb_stock</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> </span><span style="color:#B58451;">source</span><span style="color:#393A34;"> /root/db/stock.sql</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">6.\u5141\u8BB8\u6570\u636E\u5E93\u8FDC\u7A0B\u8BBF\u95EE</span></span>
<span class="line"><span style="color:#393A34;">mysql</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> grant all privileges on </span><span style="color:#AB5959;">*</span><span style="color:#393A34;">.</span><span style="color:#AB5959;">*</span><span style="color:#393A34;"> to </span><span style="color:#B56959;">&#39;root&#39;</span><span style="color:#393A34;">@</span><span style="color:#B56959;">&#39;%&#39;</span><span style="color:#393A34;"> identified by </span><span style="color:#B56959;">&#39;123456&#39;</span><span style="color:#393A34;"> with grant option</span><span style="color:#AB5959;">;</span></span>
<span class="line"><span style="color:#393A34;">Query OK, 0 rows affected </span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">0.00 sec</span><span style="color:#8E8F8B;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-2-\u90E8\u7F72eureka\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3" tabindex="-1">4.2.\u90E8\u7F72eureka\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3 <a class="header-anchor" href="#_4-2-\u90E8\u7F72eureka\u5FAE\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3" aria-hidden="true">#</a></h3><p>Eureka\u5728\u6574\u4E2A\u5FAE\u670D\u52A1\u67B6\u6784\u4E2D\u8D77\u5230\u81F3\u5173\u91CD\u8981\u7684\u7684\u4F5C\u7528\uFF0C\u5FC5\u987B\u4FDD\u8BC1Eureka\u670D\u52A1\u9AD8\u53EF\u7528\u3002</p><p>Eureka\u670D\u52A1\u91C7\u7528statefulset\u6709\u72B6\u6001\u5E94\u7528\u90E8\u7F72\u65B9\u5F0F\u518DK8S\u96C6\u7FA4\u4E2D\u8FDB\u884C\u90E8\u7F72\u3002</p><p>Eureka\u672C\u8EAB\u5C31\u53EF\u4EE5\u5229\u7528\u81EA\u8EAB\u7684\u670D\u52A1\u53D1\u73B0\u6765\u5B9E\u73B0\u96C6\u7FA4\u7684\u9AD8\u53EF\u7528\uFF0C\u53EA\u9700\u8981\u5728Eureka\u914D\u7F6E\u6587\u4EF6\u4E2D\u6307\u5B9A\u5404\u4E2AEureka\u8282\u70B9\u7684\u5730\u5740\u5C31\u53EF\u4EE5\u5B9E\u73B0\u3002</p><p>\u5C06\u7A0B\u5E8F\u90E8\u7F72\u5728K8S\u4E4B\u540E\uFF0C\u5982\u4F55\u80FD\u591F\u4FDD\u8BC1\u6BCF\u4E2AEureka Pod\u7684\u5730\u5740\u552F\u4E00\u4E0D\u53D8\uFF0C\u5C31\u9700\u8981\u7528\u5230Statefulset\u63A7\u5236\u5668\u91C7\u7528\u6709\u72B6\u6001\u7684\u5E94\u7528\u90E8\u7F72\uFF0C\u4F7F\u7528Statefulset\u63A7\u5236\u5668\u4E4B\u540E\uFF0C\u6BCF\u4E2APod\u7684\u540D\u79F0\u90FD\u662F\u552F\u4E00\u4E0D\u53D8\u7684\uFF0C\u5E76\u4E14\u6BCF\u4E2APod\u90FD\u6709\u4E00\u4E2ADNS\u670D\u52A1\u53D1\u73B0\u5730\u5740\uFF0C\u901A\u8FC7\u8FD9\u4E2ADNS\u5730\u5740\u5C31\u53EF\u4EE5\u8BF7\u6C42\u5230Pod\u4E2D\u7684\u670D\u52A1\uFF0C\u4E3B\u8981\u662Fcoredns\u7EC4\u4EF6\u6765\u5B9E\u73B0\u7684\uFF0C\u56E0\u6B64\u96C6\u7FA4\u8FD8\u9700\u8981\u5B89\u88C5\u6709coredns\u670D\u52A1\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5C06\u6BCF\u4E00\u4E2AEureka Pod\u7684DNS\u670D\u52A1\u53D1\u73B0\u5730\u5740\u5199\u5165\u5230Eureka\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u6BCF\u4E2AEureka\u8282\u70B9\u76F8\u4E92\u6CE8\u518C\uFF0C\u6700\u7EC8\u5F62\u6210\u9AD8\u53EF\u7528\u96C6\u7FA4\u3002</p><p>Statefulset+Headless\u90E8\u7F72\u7684\u7A0B\u5E8FDNS\u540D\u683C\u5F0F\uFF1A<code>&lt;statefulsetName-index&gt;.&lt;service-name&gt;.&lt;namespace-name&gt;.svc.cluster.local</code>\u540E\u9762\u7684.svc.cluster.local\u53EF\u4EE5\u53BB\u6389\uFF0CK8S\u9ED8\u8BA4\u5C31\u662F.svc.cluster.local\u3002</p><p><code>&lt;statefulsetName-index&gt;</code>\u5C31\u662FPod\u7684\u540D\u79F0\uFF0C-index\u662F\u6BCF\u4E00\u4E2APod\u540D\u79F0\u540E\u9762\u7684\u6570\u5B57\u7F16\u53F7\uFF0CStatefulset\u63A7\u5236\u5668\u90E8\u7F72\u597D\u7684Pod\uFF0C\u4F1A\u5728\u6BCF\u4E00\u4E2APod\u540D\u79F0\u540E\u9762\u52A0\u4E0A\u4E00\u4E2A\u6570\u5B57\u7F16\u53F7\uFF0C\u4ECE0\u5F00\u59CB\uFF0C\u4E00\u6B21\u7D2F\u52A0\uFF0C\u4FDD\u8BC1\u6240\u6709\u7684Pod\u90FD\u6709\u4E00\u4E2A\u72EC\u7ACB\u7684\u8BBF\u95EE\u5165\u53E3</p><p><code>&lt;service-name&gt;</code>\u662F\u7A0B\u5E8F\u7684service\u8D44\u6E90\u7684\u540D\u79F0</p><p><code>&lt;namespace-name&gt;</code>\u662F\u7A0B\u5E8F\u6240\u5728\u7684namespace\u540D\u79F0</p><p>\u6211\u4EEC\u7684Eureka\u89C4\u5B9A\u7684\u8282\u70B9\u6570\u4E3A3\u4E2A\uFF0C\u4E5F\u5C31\u662F\u6700\u7EC8statefulset\u4F1A\u542F\u52A83\u4E2APod\u526F\u672C\u7EC4\u6210Eureka\u96C6\u7FA4\u3002</p><h4 id="_4-2-1-\u4FEE\u6539eureka\u914D\u7F6E\u6587\u4EF6\u589E\u52A0\u5404\u8282\u70B9\u5730\u5740" tabindex="-1">4.2.1.\u4FEE\u6539Eureka\u914D\u7F6E\u6587\u4EF6\u589E\u52A0\u5404\u8282\u70B9\u5730\u5740 <a class="header-anchor" href="#_4-2-1-\u4FEE\u6539eureka\u914D\u7F6E\u6587\u4EF6\u589E\u52A0\u5404\u8282\u70B9\u5730\u5740" aria-hidden="true">#</a></h4><p>Eureka\u96C6\u7FA4\u8282\u70B9\u6BCF\u4E2APod\u526F\u672C\u670D\u52A1\u53D1\u73B0\u5730\u5740\u5982\u4E0B\uFF0C\u9700\u8981\u5C06\u5176\u914D\u7F6E\u5728eureka\u4E2D</p><div class="language-"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#dbd7ca;">http://eureka-0.eureka-service.simple-ms\`</span></span>
<span class="line"><span style="color:#dbd7ca;">\`http://eureka-0.eureka-service.simple-ms\`</span></span>
<span class="line"><span style="color:#dbd7ca;">\`http://eureka-0.eureka-service.simple-ms</span></span>
<span class="line"><span style="color:#dbd7ca;"></span></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393a34;">http://eureka-0.eureka-service.simple-ms\`</span></span>
<span class="line"><span style="color:#393a34;">\`http://eureka-0.eureka-service.simple-ms\`</span></span>
<span class="line"><span style="color:#393a34;">\`http://eureka-0.eureka-service.simple-ms</span></span>
<span class="line"><span style="color:#393a34;"></span></span></code></pre></div><p>\u4FEE\u6539Eureka\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u91C7\u7528Dns\u670D\u52A1\u53D1\u73B0\u5730\u5740\u7684\u5F62\u5F0F\u5C06\u6BCF\u4E2A\u8282\u70B9\u7684\u5730\u5740\u90FD\u5199\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u5F53Eureka\u542F\u52A8\u4E4B\u540E\uFF0C\u6BCF\u4E2A\u8282\u70B9\u90FD\u4F1A\u76F8\u4E92\u53D1\u73B0\u6700\u7EC8\u5F62\u6210\u9AD8\u53EF\u7528\u96C6\u7FA4\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u4FEE\u6539Eureka\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u8282\u70B9\u5730\u5740</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 eureka-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim src/main/resources/application-prod.yml</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka:</span></span>
<span class="line"><span style="color:#DBD7CA;">  server:</span></span>
<span class="line"><span style="color:#DBD7CA;">    renewal-percent-threshold: 0.9</span></span>
<span class="line"><span style="color:#DBD7CA;">    enable-self-preservation: </span><span style="color:#E0A569;">false</span></span>
<span class="line"><span style="color:#DBD7CA;">    eviction-interval-timer-in-simple-ms: 40000</span></span>
<span class="line"><span style="color:#DBD7CA;">  instance:</span></span>
<span class="line"><span style="color:#DBD7CA;">    hostname: 127.0.0.1</span></span>
<span class="line"><span style="color:#DBD7CA;">    prefer-ip-address: </span><span style="color:#E0A569;">false</span></span>
<span class="line"><span style="color:#DBD7CA;">  client:</span></span>
<span class="line"><span style="color:#DBD7CA;">    register-with-eureka: </span><span style="color:#E0A569;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    serviceUrl:</span></span>
<span class="line"><span style="color:#DBD7CA;">      defaultZone: http://eureka-0.eureka.simple-ms:</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">server.port</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/eureka/,http://eureka-1.eureka.simple-ms:</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">server.port</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/eureka/,http://eureka-2.eureka.simple-ms:</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">server.port</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/eureka/</span></span>
<span class="line"><span style="color:#DBD7CA;">    fetch-registry: </span><span style="color:#E0A569;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u4F7F\u7528maven\u5C06\u6700\u65B0\u7684Eureka\u7F16\u8BD1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u6CE8\u610F\uFF1A\u53EA\u80FD\u5728\u9879\u76EE\u6700\u5916\u5C42\u7684\u76EE\u5F55\u4E2D\u6267\u884Cmvn clean package</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u4FEE\u6539Eureka\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u8282\u70B9\u5730\u5740</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 eureka-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim src/main/resources/application-prod.yml</span></span>
<span class="line"><span style="color:#393A34;">eureka:</span></span>
<span class="line"><span style="color:#393A34;">  server:</span></span>
<span class="line"><span style="color:#393A34;">    renewal-percent-threshold: 0.9</span></span>
<span class="line"><span style="color:#393A34;">    enable-self-preservation: </span><span style="color:#B58451;">false</span></span>
<span class="line"><span style="color:#393A34;">    eviction-interval-timer-in-simple-ms: 40000</span></span>
<span class="line"><span style="color:#393A34;">  instance:</span></span>
<span class="line"><span style="color:#393A34;">    hostname: 127.0.0.1</span></span>
<span class="line"><span style="color:#393A34;">    prefer-ip-address: </span><span style="color:#B58451;">false</span></span>
<span class="line"><span style="color:#393A34;">  client:</span></span>
<span class="line"><span style="color:#393A34;">    register-with-eureka: </span><span style="color:#B58451;">true</span></span>
<span class="line"><span style="color:#393A34;">    serviceUrl:</span></span>
<span class="line"><span style="color:#393A34;">      defaultZone: http://eureka-0.eureka.simple-ms:</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">server.port</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/eureka/,http://eureka-1.eureka.simple-ms:</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">server.port</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/eureka/,http://eureka-2.eureka.simple-ms:</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">server.port</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/eureka/</span></span>
<span class="line"><span style="color:#393A34;">    fetch-registry: </span><span style="color:#B58451;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u4F7F\u7528maven\u5C06\u6700\u65B0\u7684Eureka\u7F16\u8BD1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u6CE8\u610F\uFF1A\u53EA\u80FD\u5728\u9879\u76EE\u6700\u5916\u5C42\u7684\u76EE\u5F55\u4E2D\u6267\u884Cmvn clean package</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-2-2-\u8C03\u6574eureka\u7684dockerfile" tabindex="-1">4.2.2.\u8C03\u6574Eureka\u7684Dockerfile <a class="header-anchor" href="#_4-2-2-\u8C03\u6574eureka\u7684dockerfile" aria-hidden="true">#</a></h4><p>\u7531\u4E8E\u6211\u4EEC\u5728Eureka\u914D\u7F6E\u6587\u4EF6\u4E2D\u914D\u7F6E\u7684\u662F\u4EE5dns\u540D\u79F0\u6765\u4E92\u76F8\u53D1\u73B0\u5BF9\u65B9\uFF0C\u5E76\u4E0D\u662F\u4EE5IP\u5730\u5740\u5F62\u5F0F\u53D1\u73B0\uFF0C\u56E0\u6B64\u6211\u4EEC\u9700\u8981\u914D\u7F6EDockerfile\uFF0C\u5728\u542F\u52A8\u7A0B\u5E8F\u65F6\u5C06\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684hostname\u5B57\u6BB5\u503C\u4FEE\u6539\u4E3A\u5F53\u524DPod\u7684dns\u540D\u79F0\u3002</p><p>\u56E0\u4E3A\u6211\u4EEC\u7684Eureka\u662F\u591APod\u7EC4\u6210\u7684\u9AD8\u53EF\u7528\u96C6\u7FA4\uFF0C\u56E0\u6B64\u4E0D\u80FD\u5C06dns\u540D\u79F0\u5199\u6B7B\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u4E0D\u7136\u6BCF\u4E2APod\u90FD\u662F\u540C\u6837\u7684\u5730\u5740\uFF0C\u96C6\u7FA4\u662F\u7EC4\u4EF6\u4E0D\u6210\u529F\u7684\uFF0C\u6240\u4EE5\u5C31\u9700\u8981\u5728Dockerfile\u4E2D\u5B9A\u4E49\u7A0B\u5E8F\u542F\u52A8\u547D\u4EE4\u65F6\uFF0C\u5C06dns\u540D\u79F0\u5730\u5740\u8BBE\u7F6E\u6210\u53D8\u91CF\uFF0C\u7531Pod\u8D44\u6E90\u5C06\u53D8\u91CF\u503C\u4F20\u5165\u5230\u542F\u52A8\u547D\u4EE4\u4E2D\uFF0C\u7A0B\u5E8F\u542F\u52A8\u65F6\u5C31\u4F1A\u7528Pod\u7684dns\u540D\u79F0\u5730\u5740\u66FF\u6362\u6389\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684IP\u5730\u5740\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u4FEE\u6539DOckerfile\u6587\u4EF6\u5185\u5BB9</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 eureka-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#DBD7CA;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN mkdir /data/simple-microservice/eureka-service -p</span></span>
<span class="line"><span style="color:#DBD7CA;">COPY ./target/eureka-service.jar /data/simple-microservice/eureka-service/</span></span>
<span class="line"><span style="color:#DBD7CA;">RUN </span><span style="color:#E0A569;">echo</span><span style="color:#DBD7CA;"> -e </span><span style="color:#C98A7D;">&quot;#!/bin/bash \\njava -jar -Deureka.instance.hostname=</span><span style="color:#858585;">\${</span><span style="color:#C98A7D;">MY_POD_NAME</span><span style="color:#858585;">}</span><span style="color:#C98A7D;">.eureka.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar &gt; /data/simple-microservice/eureka-service/eureka-service.log &amp; \\ntail -f /data/simple-microservice/eureka-service/eureka-service.log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;"> /data/entrypoint.sh </span><span style="color:#CB7676;">&amp;&amp;</span><span style="color:#DBD7CA;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#DBD7CA;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#DBD7CA;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u4FEE\u6539DOckerfile\u6587\u4EF6\u5185\u5BB9</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 eureka-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> vim Dockerfile </span></span>
<span class="line"><span style="color:#393A34;">FROM 192.168.20.11/base/centos-java:v1</span></span>
<span class="line"><span style="color:#393A34;">RUN mkdir /data/simple-microservice/eureka-service -p</span></span>
<span class="line"><span style="color:#393A34;">COPY ./target/eureka-service.jar /data/simple-microservice/eureka-service/</span></span>
<span class="line"><span style="color:#393A34;">RUN </span><span style="color:#B58451;">echo</span><span style="color:#393A34;"> -e </span><span style="color:#B56959;">&quot;#!/bin/bash \\njava -jar -Deureka.instance.hostname=</span><span style="color:#8E8F8B;">\${</span><span style="color:#B56959;">MY_POD_NAME</span><span style="color:#8E8F8B;">}</span><span style="color:#B56959;">.eureka.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar &gt; /data/simple-microservice/eureka-service/eureka-service.log &amp; \\ntail -f /data/simple-microservice/eureka-service/eureka-service.log&quot;</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;"> /data/entrypoint.sh </span><span style="color:#AB5959;">&amp;&amp;</span><span style="color:#393A34;"> chmod a+x /data/entrypoint.sh</span></span>
<span class="line"><span style="color:#393A34;">EXPOSE 8080</span></span>
<span class="line"><span style="color:#393A34;">ENTRYPOINT /data/entrypoint.sh</span></span>
<span class="line"></span></code></pre></div><p>\u542F\u52A8\u547D\u4EE4\u5355\u72EC\u62C9\u51FA\u6765\u770B\u4E00\u4E0B\uFF0C<code>-Deureka.instance.hostname</code>\u8FD9\u4E2A\u53C2\u6570\u8868\u793A\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u4E2Dhostname\u53C2\u6570\u7684\u503C\uFF0C<code>\${MY_POD_NAME}</code>\u8FD9\u4E2A\u53D8\u91CF\u4F7F\u4ECEdeployment\u8D44\u6E90\u6587\u4EF6\u4E2D\u5B9A\u4E49\u7684env\u53D8\u91CF\uFF0C\u5C06Pod\u7684\u540D\u79F0\u8D4B\u7ED9MY_POD_NAME\u53D8\u91CF\uFF0C\u6700\u540E\u5F15\u5165\u5230\u542F\u52A8\u547D\u4EE4\u4E2D\uFF0C\u6700\u540E\u5728\u914D\u7F6E\u6587\u4EF6\u4E2Dhostname\u5B57\u6BB5\u7684\u503C\u5E94\u8BE5\u662F<code>eureka-0.eureka-service.simple-ms</code></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">java -jar -Deureka.instance.hostname=</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">MY_POD_NAME</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">.eureka-service.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">java -jar -Deureka.instance.hostname=</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">MY_POD_NAME</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">.eureka-service.simple-ms /data/simple-microservice/eureka-service/eureka-service.jar</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-2-3-\u6784\u5EFAeureka\u670D\u52A1\u7684docker\u955C\u50CF" tabindex="-1">4.2.3.\u6784\u5EFAEureka\u670D\u52A1\u7684Docker\u955C\u50CF <a class="header-anchor" href="#_4-2-3-\u6784\u5EFAeureka\u670D\u52A1\u7684docker\u955C\u50CF" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 eureka-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker build -t  192.168.20.11/simple-microservice/eureka-service:v1 </span><span style="color:#E0A569;">.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 eureka-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker images </span><span style="color:#CB7676;">|</span><span style="color:#DBD7CA;"> grep eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">192.168.20.11/simp-microservice/eureka-service        v1                  1dc64fc9ba09        About a minute ago   800MB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 eureka-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker push 192.168.20.11/simple-microservice/eureka-service:v1</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 eureka-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker build -t  192.168.20.11/simple-microservice/eureka-service:v1 </span><span style="color:#B58451;">.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 eureka-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker images </span><span style="color:#AB5959;">|</span><span style="color:#393A34;"> grep eureka</span></span>
<span class="line"><span style="color:#393A34;">192.168.20.11/simp-microservice/eureka-service        v1                  1dc64fc9ba09        About a minute ago   800MB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 eureka-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker push 192.168.20.11/simple-microservice/eureka-service:v1</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-2-4-\u7F16\u5199eureka\u90E8\u7F72yaml\u8D44\u6E90\u6587\u4EF6" tabindex="-1">4.2.4.\u7F16\u5199Eureka\u90E8\u7F72YAML\u8D44\u6E90\u6587\u4EF6 <a class="header-anchor" href="#_4-2-4-\u7F16\u5199eureka\u90E8\u7F72yaml\u8D44\u6E90\u6587\u4EF6" aria-hidden="true">#</a></h4><p><strong>1\uFF09\u521B\u5EFA\u547D\u540D\u7A7A\u95F4</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#C98A7D;">1.\u521B\u5EFA\u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#758575;"># kubectl create ns simple-ms</span></span>
<span class="line"><span style="color:#C98A7D;">namespace/simple-ms created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C98A7D;">2.\u521B\u5EFA\u8D44\u6E90\u7F16\u6392YAML\u6587\u4EF6\u5B58\u653E\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#C98A7D;">root@binary-k8s-master1 ~</span><span style="color:#858585;">]</span><span style="color:#C98A7D;">\\# mkdir springcloud/simple-microservice-dev1/k8s/</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#B56959;">1.\u521B\u5EFA\u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#A0ADA0;"># kubectl create ns simple-ms</span></span>
<span class="line"><span style="color:#B56959;">namespace/simple-ms created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B56959;">2.\u521B\u5EFA\u8D44\u6E90\u7F16\u6392YAML\u6587\u4EF6\u5B58\u653E\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#B56959;">root@binary-k8s-master1 ~</span><span style="color:#8E8F8B;">]</span><span style="color:#B56959;">\\# mkdir springcloud/simple-microservice-dev1/k8s/</span></span>
<span class="line"></span></code></pre></div><p><strong>2\uFF09\u767B\u5F55Harbor</strong></p><p>\u53EF\u4EE5\u4E0D\u5728\u6BCF\u4E00\u4E2ANode\u8282\u70B9\u4F7F\u7528docker login\u767B\u9646Harbor\u4ED3\u5E93\uFF0C\u53EF\u4EE5\u5C06Harbor\u4ED3\u5E93\u7684\u8BA4\u8BC1\u4FE1\u606F\u505A\u6210secret\uFF0C\u901A\u8FC7\u4F7F\u7528secret\u7684\u65B9\u5F0F\u8FDE\u63A5Harbor\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl create secret docker-registry registry-pull-secret --docker-server=192.168.20.11 --docker-username=admin --docker-password=Harbor12345 --docker-email=admin@ctnrs.com -n simple-ms</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl create secret docker-registry registry-pull-secret --docker-server=192.168.20.11 --docker-username=admin --docker-password=Harbor12345 --docker-email=admin@ctnrs.com -n simple-ms</span></span>
<span class="line"></span></code></pre></div><p><strong>3\uFF09\u7F16\u5199\u8D44\u6E90YAML\u6587\u4EF6</strong></p><p>eureka\u8981\u505A\u6210\u96C6\u7FA4\u5F0F\u7684\u670D\u52A1\uFF0C\u6240\u4EE5\u8981\u91C7\u7528statefulset\u63A7\u5236\u5668\u90E8\u7F72\uFF0C\u5E76\u91C7\u7528headless service\u4FDD\u8BC1statefulset\u521B\u5EFA\u7684pod\u540D\u79F0\u552F\u4E00\u6027\uFF0C\u6700\u540E\u901A\u8FC7ingress\u5C06eureka\u670D\u52A1\u53D1\u5E03\u5728\u4E92\u8054\u7F51\u73AF\u5883\u3002</p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#C98A7D;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#C98A7D;">\\# vim eureka-deploy.yaml</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#ingress\u8D44\u6E90</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Ingress</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#\u7C7B\u578B\u4E3Aingress</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">             </span><span style="color:#758575;">#\u5B9A\u4E49\u5143\u6570\u636E\u4FE1\u606F\uFF1A\u8D44\u6E90\u540D\u79F0\u3001\u8D44\u6E90\u6240\u5728\u7684\u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">rules</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                  </span><span style="color:#758575;">#\u5B9A\u4E49ingress\u89C4\u5219</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">host</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka.jiangxl.com</span><span style="color:#DBD7CA;">          </span><span style="color:#758575;">#\u5B9A\u4E49eureka\u4F7F\u7528\u7684\u57DF\u540D</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">http</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                   </span><span style="color:#758575;">#\u91C7\u7528http\u7C7B\u578B\u7684\u8BBF\u95EE\u65B9\u5F0F</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">paths</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                  </span><span style="color:#758575;">#\u5B9A\u4E49\u7A0B\u5E8F\u7684url\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">path</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">/</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">backend</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                </span><span style="color:#758575;">#\u9488\u5BF9\u5B9A\u4E49\u7684\u7A0B\u5E8F\u8DEF\u5F84\u5173\u4E8E\u5BF9\u5E94\u7684\u540E\u7AEFservice\u8D44\u6E90</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">serviceName</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">servicePort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#headless service\u8D44\u6E90</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span><span style="color:#DBD7CA;">          </span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Service</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">clusterIP</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">None</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;">#ClusterIP\u8D44\u6E90\u8BBE\u7F6E\u4E3ANode\u5C31\u4EE3\u8868headless\u7C7B\u578B\u7684service</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">            </span><span style="color:#758575;">#\u5B9A\u4E49\u66B4\u9732\u7684eureka\u7AEF\u53E3\u53F7</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#\u6807\u7B7E\u9009\u62E9\u5668\uFF0C\u5173\u8054\u540E\u7AEFpod</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#statefulset\u8D44\u6E90</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">StatefulSet</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">3</span><span style="color:#DBD7CA;">               </span><span style="color:#758575;">#\u526F\u672C\u6570</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                 </span><span style="color:#758575;">#\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;">         </span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">serviceName</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&quot;eureka&quot;</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#service\u7684\u540D\u79F0\uFF0C\u4E5F\u5C31\u662F\u5C06\u6765\u7684pod\u540D\u79F0</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">                 </span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#harbor\u955C\u50CF\u4ED3\u5E93\u7684\u51ED\u636E\u4FE1\u606F</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/eureka-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">env</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">              </span><span style="color:#758575;">#\u589E\u52A0\u4E00\u4E2A\u73AF\u5883\u53D8\u91CF\uFF0C\u53D8\u91CF\u540D\u4E3AMY_POD_NAME\uFF0C\u503C\u4E3Apod\u7684\u540D\u79F0\uFF0C\u8FD9\u4E2A\u53D8\u91CF\u4FE1\u606F\u4F1A\u4F20\u5165dockerfile\u4E2D</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">MY_POD_NAME</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">valueFrom</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">              </span><span style="color:#429988;">fieldRef</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">                </span><span style="color:#429988;">fieldPath</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">metadata.name</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">            </span><span style="color:#758575;">#\u8D44\u6E90\u914D\u989D</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#\u6700\u5C0F\u8D44\u6E90\u9650\u5236\uFF0Ccpu\u4E3A0.5\uFF0C\u5185\u5B58\u4E3A256M</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#\u6700\u5927\u8D44\u6E90\u9650\u5236\uFF0Ccpu\u4E3A1\uFF0C\u5185\u5B58\u4E3A1G</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;">          </span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">         </span><span style="color:#758575;">#\u5C31\u7EEA\u6027\u5065\u5EB7\u68C0\u67E5</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">          </span><span style="color:#758575;">#\u4EE5tcp 8080\u7AEF\u53E3\u4F5C\u4E3A\u5065\u5EB7\u68C0\u67E5\u7684\u673A\u5236</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;">  </span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span><span style="color:#DBD7CA;">     </span><span style="color:#758575;">#\u5BB9\u5668\u542F\u52A860\u79D2\u540E\u8FDB\u884C\u68C0\u6D4B</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">         </span><span style="color:#758575;">#\u63A2\u6D4B\u7684\u9891\u7387</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">            </span><span style="color:#758575;">#\u5B58\u6D3B\u6027\u5065\u5EB7\u68C0\u67E5</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;">            </span><span style="color:#758575;">#\u4EE5tcp 8080\u7AEF\u53E3\u4F5C\u4E3A\u5065\u5EB7\u68C0\u67E5\u7684\u673A\u5236</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;">  </span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span><span style="color:#DBD7CA;">       </span><span style="color:#758575;">#\u5BB9\u5668\u542F\u52A860\u79D2\u540E\u8FDB\u884C\u68C0\u67E5</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span><span style="color:#DBD7CA;">           </span><span style="color:#758575;">#\u63A2\u6D4B\u7684\u9891\u7387\u4E3A10\u79D2\u4E00\u6B21</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#B56959;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#B56959;">\\# vim eureka-deploy.yaml</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#ingress\u8D44\u6E90</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Ingress</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#\u7C7B\u578B\u4E3Aingress</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">             </span><span style="color:#A0ADA0;">#\u5B9A\u4E49\u5143\u6570\u636E\u4FE1\u606F\uFF1A\u8D44\u6E90\u540D\u79F0\u3001\u8D44\u6E90\u6240\u5728\u7684\u547D\u540D\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">rules</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                  </span><span style="color:#A0ADA0;">#\u5B9A\u4E49ingress\u89C4\u5219</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">host</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka.jiangxl.com</span><span style="color:#393A34;">          </span><span style="color:#A0ADA0;">#\u5B9A\u4E49eureka\u4F7F\u7528\u7684\u57DF\u540D</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">http</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                   </span><span style="color:#A0ADA0;">#\u91C7\u7528http\u7C7B\u578B\u7684\u8BBF\u95EE\u65B9\u5F0F</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">paths</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                  </span><span style="color:#A0ADA0;">#\u5B9A\u4E49\u7A0B\u5E8F\u7684url\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">path</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">/</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">backend</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                </span><span style="color:#A0ADA0;">#\u9488\u5BF9\u5B9A\u4E49\u7684\u7A0B\u5E8F\u8DEF\u5F84\u5173\u4E8E\u5BF9\u5E94\u7684\u540E\u7AEFservice\u8D44\u6E90</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">serviceName</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">servicePort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">            </span></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#headless service\u8D44\u6E90</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span><span style="color:#393A34;">          </span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Service</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">clusterIP</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">None</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;">#ClusterIP\u8D44\u6E90\u8BBE\u7F6E\u4E3ANode\u5C31\u4EE3\u8868headless\u7C7B\u578B\u7684service</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">#\u5B9A\u4E49\u66B4\u9732\u7684eureka\u7AEF\u53E3\u53F7</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#\u6807\u7B7E\u9009\u62E9\u5668\uFF0C\u5173\u8054\u540E\u7AEFpod</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#statefulset\u8D44\u6E90</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">StatefulSet</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">3</span><span style="color:#393A34;">               </span><span style="color:#A0ADA0;">#\u526F\u672C\u6570</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                 </span><span style="color:#A0ADA0;">#\u6807\u7B7E\u9009\u62E9\u5668</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;">         </span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">serviceName</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&quot;eureka&quot;</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#service\u7684\u540D\u79F0\uFF0C\u4E5F\u5C31\u662F\u5C06\u6765\u7684pod\u540D\u79F0</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">                 </span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#harbor\u955C\u50CF\u4ED3\u5E93\u7684\u51ED\u636E\u4FE1\u606F</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">eureka</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/eureka-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">env</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">              </span><span style="color:#A0ADA0;">#\u589E\u52A0\u4E00\u4E2A\u73AF\u5883\u53D8\u91CF\uFF0C\u53D8\u91CF\u540D\u4E3AMY_POD_NAME\uFF0C\u503C\u4E3Apod\u7684\u540D\u79F0\uFF0C\u8FD9\u4E2A\u53D8\u91CF\u4FE1\u606F\u4F1A\u4F20\u5165dockerfile\u4E2D</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">MY_POD_NAME</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">valueFrom</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">              </span><span style="color:#2F8A89;">fieldRef</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">                </span><span style="color:#2F8A89;">fieldPath</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">metadata.name</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">#\u8D44\u6E90\u914D\u989D</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#\u6700\u5C0F\u8D44\u6E90\u9650\u5236\uFF0Ccpu\u4E3A0.5\uFF0C\u5185\u5B58\u4E3A256M</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#\u6700\u5927\u8D44\u6E90\u9650\u5236\uFF0Ccpu\u4E3A1\uFF0C\u5185\u5B58\u4E3A1G</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span><span style="color:#393A34;">          </span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">         </span><span style="color:#A0ADA0;">#\u5C31\u7EEA\u6027\u5065\u5EB7\u68C0\u67E5</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">          </span><span style="color:#A0ADA0;">#\u4EE5tcp 8080\u7AEF\u53E3\u4F5C\u4E3A\u5065\u5EB7\u68C0\u67E5\u7684\u673A\u5236</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;">  </span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span><span style="color:#393A34;">     </span><span style="color:#A0ADA0;">#\u5BB9\u5668\u542F\u52A860\u79D2\u540E\u8FDB\u884C\u68C0\u6D4B</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">         </span><span style="color:#A0ADA0;">#\u63A2\u6D4B\u7684\u9891\u7387</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">#\u5B58\u6D3B\u6027\u5065\u5EB7\u68C0\u67E5</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;">            </span><span style="color:#A0ADA0;">#\u4EE5tcp 8080\u7AEF\u53E3\u4F5C\u4E3A\u5065\u5EB7\u68C0\u67E5\u7684\u673A\u5236</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;">  </span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span><span style="color:#393A34;">       </span><span style="color:#A0ADA0;">#\u5BB9\u5668\u542F\u52A860\u79D2\u540E\u8FDB\u884C\u68C0\u67E5</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span><span style="color:#393A34;">           </span><span style="color:#A0ADA0;">#\u63A2\u6D4B\u7684\u9891\u7387\u4E3A10\u79D2\u4E00\u6B21</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-2-5-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72eureka\u6CE8\u518C\u4E2D\u5FC3" tabindex="-1">4.2.5.\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72Eureka\u6CE8\u518C\u4E2D\u5FC3 <a class="header-anchor" href="#_4-2-5-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72eureka\u6CE8\u518C\u4E2D\u5FC3" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u90E8\u7F72eureka\u670D\u52A1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl apply -f eureka-deploy.yaml </span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770B\u90E8\u7F72\u7684\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-0   1/1     Running   1          12h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-1   1/1     Running   0          12h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-2   1/1     Running   0          12h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME             TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">S</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;">    AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">service/eureka   ClusterIP   None         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   13h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                      READY   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">statefulset.apps/eureka   3/3     13h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u67E5\u770Beureka\u7684ingress\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME     CLASS    HOSTS                ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   eureka.jiangxl.com   10.0.0.107   80      13h</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u90E8\u7F72eureka\u670D\u52A1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl apply -f eureka-deploy.yaml </span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770B\u90E8\u7F72\u7684\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-0   1/1     Running   1          12h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-1   1/1     Running   0          12h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-2   1/1     Running   0          12h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME             TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">S</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;">    AGE</span></span>
<span class="line"><span style="color:#393A34;">service/eureka   ClusterIP   None         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   13h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                      READY   AGE</span></span>
<span class="line"><span style="color:#393A34;">statefulset.apps/eureka   3/3     13h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u67E5\u770Beureka\u7684ingress\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME     CLASS    HOSTS                ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   eureka.jiangxl.com   10.0.0.107   80      13h</span></span>
<span class="line"></span></code></pre></div><p>\u9996\u5148\u5728\u672C\u5730hosts\u6587\u4EF6\u4E2D\u7ED1\u5B9Aeureka\u57DF\u540D\u89E3\u6790\uFF0C\u7136\u540E\u5728\u6D4F\u89C8\u5668\u4E2D\u8F93\u5165eureka.jiangxl.com\u8BBF\u95EEeureka\u670D\u52A1\u3002</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/dac8c49c10904c4591acb933a094c0d7.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_4-3-\u914D\u7F6E\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDE\u63A5eureka\u96C6\u7FA4\u7684\u5730\u5740" tabindex="-1">4.3.\u914D\u7F6E\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDE\u63A5Eureka\u96C6\u7FA4\u7684\u5730\u5740 <a class="header-anchor" href="#_4-3-\u914D\u7F6E\u5404\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u8FDE\u63A5eureka\u96C6\u7FA4\u7684\u5730\u5740" aria-hidden="true">#</a></h3><p>\u5728\u7A0B\u5E8F\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u586B\u5199eureka\u96C6\u7FA4\u6240\u6709\u8282\u70B9\u7684\u670D\u52A1\u53D1\u73B0\u5730\u5740</p><p><strong>1.gateway-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim gateway-service/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#C98A7D;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#429988;">eureka</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">instance</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">prefer-ip-address</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">client</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">register-with-eureka</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">fetch-registry</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">service-url</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">defaultZone</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim gateway-service/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#B56959;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"><span style="color:#2F8A89;">eureka</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">instance</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">prefer-ip-address</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">client</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">register-with-eureka</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">fetch-registry</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">service-url</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">defaultZone</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre></div><p><strong>2.order-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim order-service/order-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#429988;">spring</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">datasource</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">url</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">username</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">root</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">password</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">driver-class-name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#429988;">eureka</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">instance</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">prefer-ip-address</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">client</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">register-with-eureka</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">fetch-registry</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">service-url</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">defaultZone</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim order-service/order-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#2F8A89;">spring</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">datasource</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">url</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">jdbc:mysql://192.168.20.11:3306/tb_order?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">username</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">root</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">password</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">123456</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">driver-class-name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#2F8A89;">eureka</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">instance</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">prefer-ip-address</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">client</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">register-with-eureka</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">fetch-registry</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">service-url</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">defaultZone</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre></div><p><strong>3.product-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim product-service/product-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#429988;">spring</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">datasource</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">url</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">username</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">root</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">password</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">driver-class-name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#429988;">eureka</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">instance</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">prefer-ip-address</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">client</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">register-with-eureka</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">fetch-registry</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">service-url</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">defaultZone</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim product-service/product-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#2F8A89;">spring</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">datasource</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">url</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">jdbc:mysql://192.168.20.11:3306/tb_product?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">username</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">root</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">password</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">123456</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">driver-class-name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#2F8A89;">eureka</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">instance</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">prefer-ip-address</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">client</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">register-with-eureka</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">fetch-registry</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">service-url</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">defaultZone</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre></div><p><strong>4.stock-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim stock-service/stock-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#429988;">spring</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">datasource</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">url</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">username</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">root</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">password</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">123456</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">driver-class-name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#429988;">eureka</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">instance</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">prefer-ip-address</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">client</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">register-with-eureka</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">fetch-registry</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">service-url</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">defaultZone</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim stock-service/stock-service-biz/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#2F8A89;">spring</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">datasource</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">url</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">jdbc:mysql://192.168.20.11:3306/tb_stock?characterEncoding=utf-8</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">username</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">root</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">password</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">123456</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">driver-class-name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">com.mysql.jdbc.Driver</span></span>
<span class="line"></span>
<span class="line"><span style="color:#2F8A89;">eureka</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">instance</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">prefer-ip-address</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">client</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">register-with-eureka</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">fetch-registry</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">service-url</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">defaultZone</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"></span></code></pre></div><p><strong>5.portal-service\u914D\u7F6E\u6587\u4EF6</strong></p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim portal-service/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#429988;">eureka</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">instance</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">prefer-ip-address</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">client</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">service-url</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">defaultZone</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">register-with-eureka</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">fetch-registry</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">true</span></span>
<span class="line"><span style="color:#C98A7D;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim portal-service/src/main/resources/application-prod.yml </span></span>
<span class="line"><span style="color:#2F8A89;">eureka</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">instance</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">prefer-ip-address</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">client</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">service-url</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">defaultZone</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">http://eureka-0.eureka.simple-ms:8080/eureka,http://eureka-1.eureka.simple-ms:8080/eureka,http://eureka-2.eureka.simple-ms:8080/eureka</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">register-with-eureka</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">fetch-registry</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">true</span></span>
<span class="line"><span style="color:#B56959;">\xB7\xB7\xB7\xB7\xB7\xB7</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-4-\u5C06\u5404\u4E2A\u7A0B\u5E8F\u4EE3\u7801\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F" tabindex="-1">4.4.\u5C06\u5404\u4E2A\u7A0B\u5E8F\u4EE3\u7801\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F <a class="header-anchor" href="#_4-4-\u5C06\u5404\u4E2A\u7A0B\u5E8F\u4EE3\u7801\u7F16\u8BD1\u6210\u53EF\u90E8\u7F72\u7684\u7A0B\u5E8F" aria-hidden="true">#</a></h3><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-3-\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" tabindex="-1">4.3.\u4E2D\u90E8\u7F72Gateway\u7F51\u5173\u670D\u52A1 <a class="header-anchor" href="#_4-3-\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" aria-hidden="true">#</a></h3><h4 id="_4-3-1-\u5C06gateway\u7A0B\u5E8F\u6253\u5305\u6210docker\u955C\u50CF" tabindex="-1">4.3.1.\u5C06Gateway\u7A0B\u5E8F\u6253\u5305\u6210docker\u955C\u50CF <a class="header-anchor" href="#_4-3-1-\u5C06gateway\u7A0B\u5E8F\u6253\u5305\u6210docker\u955C\u50CF" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 gateway-service</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> docker build -t 192.168.20.11/simple-microservice/gateway-service:v1 </span><span style="color:#E0A569;">.</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 gateway-service</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> docker build -t 192.168.20.11/simple-microservice/gateway-service:v1 </span><span style="color:#B58451;">.</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-3-2-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" tabindex="-1">4.3.2.\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72Gateway\u7F51\u5173\u670D\u52A1 <a class="header-anchor" href="#_4-3-2-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" aria-hidden="true">#</a></h4><p>\u6240\u6709\u7A0B\u5E8F\u7684\u8D44\u6E90YAML\u6587\u4EF6\u90FD\u5B58\u653E\u5728/root/springcloud/simple-microservice-dev1/k8s\u8DEF\u5F84\u3002</p><p>\u5FAE\u670D\u52A1\u7A0B\u5E8F\u7684\u8BDD\u5C31\u4E0D\u9700\u8981\u6709\u72B6\u6001\u5E94\u7528\u90E8\u7F72\u4E86\uFF0C\u76F4\u63A5\u91C7\u7528deployment\u65E0\u72B6\u6001\u5E94\u7528\u90E8\u7F72\u7684\u63A7\u5236\u5668\uFF0C\u5B57\u6BB5\u914D\u7F6E\u548Ceureka\u670D\u52A1\u7684statefulset\u914D\u7F6E\u53C2\u6570\u51E0\u4E4E\u662F\u4E00\u6837\u7684\uFF0C\u5FAE\u670D\u52A1\u7684\u5404\u4E2A\u7A0B\u5E8F\u4E5F\u90FD\u91C7\u7528\u6709deployment\u63A7\u5236\u5668\u53BB\u90E8\u7F72\uFF0C\u6BCF\u4E2A\u7A0B\u5E8F\u7684yaml\u6587\u4EF6\u4E5F\u53EA\u6709\u540D\u5B57\u3001\u4F7F\u7528\u7684\u955C\u50CF\u4E0D\u540C\uFF0C\u5176\u4F59\u6240\u6709\u53C2\u6570\u5747\u4E00\u81F4\u3002</p><p>gateway\u662F\u7F51\u5173\u670D\u52A1\uFF0C\u9700\u8981\u914D\u7F6E\u4E00\u4E2Aingress\u548Cservice\u8D44\u6E90\uFF0C\u5C06\u5176\u53D1\u5E03\u5728\u96C6\u7FA4\u4E4B\u5916\u3002</p><p>\u5B57\u6BB5\u914D\u7F6E\u548Cstatefulset\u7684\u4E00\u81F4\uFF0C\u4E0D\u518D\u505A\u6CE8\u91CA\u4FE1\u606F</p><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim gateway-deploy.yaml</span></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#ingress\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Ingress</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">rules</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">host</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway.jiangxl.com</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">http</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">paths</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">path</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">/</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">backend</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">serviceName</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">servicePort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#service\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Service</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#758575;">#deployment\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span><span style="color:#DBD7CA;">         </span><span style="color:#758575;">#\u526F\u672C\u6570\u8BBE\u7F6E1\u4E2A\uFF0C\u540E\u7EED\u518D\u52A0</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">gateway</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/gateway-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Always</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim gateway-deploy.yaml</span></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#ingress\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Ingress</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">rules</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">host</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway.jiangxl.com</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">http</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">paths</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">path</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">/</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">backend</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">serviceName</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">servicePort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#service\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Service</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#A0ADA0;">#deployment\u8D44\u6E90YAML</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span><span style="color:#393A34;">         </span><span style="color:#A0ADA0;">#\u526F\u672C\u6570\u8BBE\u7F6E1\u4E2A\uFF0C\u540E\u7EED\u518D\u52A0</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">gateway</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/gateway-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Always</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-3-3-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" tabindex="-1">4.3.3.\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72Gateway\u7F51\u5173\u670D\u52A1 <a class="header-anchor" href="#_4-3-3-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72gateway\u7F51\u5173\u670D\u52A1" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u90E8\u7F72\u7F51\u5173\u670D\u52A1</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl apply -f gateway-deploy.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770Bgateway pod\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-0                   1/1     Running   1          2d12h</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-1                   1/1     Running   0          2d12h</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-2                   1/1     Running   0          2d12h</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway-7c687f6c45-mcwpf   1/1     Running   0          2m2s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">3.\u67E5\u770Bdeployment\u548Csvc\u7684\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get deploy,svc -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/gateway   1/1     1            1           17h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">S</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;">    AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">service/eureka    ClusterIP   None         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   2d13h</span></span>
<span class="line"><span style="color:#DBD7CA;">service/gateway   ClusterIP   10.0.0.188   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   17h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">4.\u67E5\u770Bgateway ingress\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   eureka.jiangxl.com    10.0.0.107   80      2d13h</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   gateway.jiangxl.com   10.0.0.107   80      17h</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u90E8\u7F72\u7F51\u5173\u670D\u52A1</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl apply -f gateway-deploy.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770Bgateway pod\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka-0                   1/1     Running   1          2d12h</span></span>
<span class="line"><span style="color:#393A34;">eureka-1                   1/1     Running   0          2d12h</span></span>
<span class="line"><span style="color:#393A34;">eureka-2                   1/1     Running   0          2d12h</span></span>
<span class="line"><span style="color:#393A34;">gateway-7c687f6c45-mcwpf   1/1     Running   0          2m2s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">3.\u67E5\u770Bdeployment\u548Csvc\u7684\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get deploy,svc -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/gateway   1/1     1            1           17h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">S</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;">    AGE</span></span>
<span class="line"><span style="color:#393A34;">service/eureka    ClusterIP   None         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   2d13h</span></span>
<span class="line"><span style="color:#393A34;">service/gateway   ClusterIP   10.0.0.188   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   17h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">4.\u67E5\u770Bgateway ingress\u8D44\u6E90\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   eureka.jiangxl.com    10.0.0.107   80      2d13h</span></span>
<span class="line"><span style="color:#393A34;">gateway   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   gateway.jiangxl.com   10.0.0.107   80      17h</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-4-\u7F16\u5199\u5FEB\u901F\u90E8\u7F72\u5FAE\u670D\u52A1\u5230k8s\u96C6\u7FA4\u7684\u811A\u672C" tabindex="-1">4.4.\u7F16\u5199\u5FEB\u901F\u90E8\u7F72\u5FAE\u670D\u52A1\u5230K8S\u96C6\u7FA4\u7684\u811A\u672C <a class="header-anchor" href="#_4-4-\u7F16\u5199\u5FEB\u901F\u90E8\u7F72\u5FAE\u670D\u52A1\u5230k8s\u96C6\u7FA4\u7684\u811A\u672C" aria-hidden="true">#</a></h3><p>\u7531\u4E8E\u5FAE\u670D\u52A1\u7A0B\u5E8F\u4F17\u591A\uFF0C\u5E76\u4E14\u6BCF\u4E2A\u7A0B\u5E8F\u5728K8S\u96C6\u7FA4\u90E8\u7F72\u7684\u6D41\u7A0B\u4E5F\u57FA\u672C\u4E00\u6837\uFF0C\u56E0\u6B64\u6211\u4EEC\u7F16\u5199\u4E00\u4E2A\u90E8\u7F72\u811A\u672C\uFF0C\u53EA\u8981\u51C6\u5907\u597D\u7A0B\u5E8F\u7684jar\u5305\u4EE5\u53CA\u8D44\u6E90YAML\u6587\u4EF6\u5C31\u53EF\u4EE5\u5C06\u5176\u4E00\u952E\u90E8\u7F72\u5230K8S\u96C6\u7FA4\uFF0C\u5F53\u524D\u4E5F\u53EF\u4EE5\u901A\u8FC7Helm\u6765\u5B9E\u73B0\u3002</p><p><strong>1.\u811A\u672C\u5185\u5BB9</strong></p><p>\u5B9E\u73B0\u903B\u8F91\uFF1A</p><p>1.\u5C06harbor\u4ED3\u5E93\u7684\u5730\u5740\u3001\u6240\u6709\u5FAE\u670D\u52A1\u7684\u540D\u79F0\u3001k8s yaml\u6587\u4EF6\u7684\u8DEF\u5F84\u3001\u5FAE\u670D\u52A1\u4EE3\u7801\u6240\u5728\u7684\u8DEF\u5F84\u90FD\u5B9A\u4E49\u6210\u73AF\u5883\u53D8\u91CF\u3002</p><p>2.\u5982\u679C\u53EA\u60F3\u90E8\u7F72\u5176\u4E2D\u4E00\u4E2A\u5FAE\u670D\u52A1\u7684\u8BDD\uFF0C\u901A\u8FC7\u4F4D\u7F6E\u4F20\u53C2\u7684\u65B9\u5F0F\u6765\u5B9E\u73B0\uFF0C\u4E5F\u5C31\u662F\u518D\u5B9A\u4E49\u4E00\u4E2A\u5FAE\u670D\u52A1\u540D\u79F0\u7684\u53D8\u91CF\uFF0C\u53D8\u91CF\u503C\u4E3AKaTeX parse error: Expected &#39;}&#39;, got &#39;EOF&#39; at end of input: {1:-{service_list}}\uFF0C\u5C06\u8981\u90E8\u7F72\u7684\u5FAE\u670D\u52A1\u540D\u79F0\u901A\u8FC7\u4F4D\u7F6E\u4F20\u53C2\u7684\u65B9\u5F0F\uFF0C\u5C06\u503C\u4F20\u5165\u5230service_list\u53D8\u91CF\u540D\u91CC\uFF0C\u8986\u76D6\u539Fservice_list\u53D8\u91CF\u503C\uFF0C\u5B9E\u73B0\u5355\u4E2A\u5FAE\u670D\u52A1\u7684\u90E8\u7F72\uFF0C\u5982\u679C\u6CA1\u6709\u4F7F\u7528\u4F4D\u7F6E\u53C2\u6570\uFF0C\u90A3\u4E48\u9ED8\u8BA4\u90E8\u7F72\u5168\u90E8\u7684\u5FAE\u670D\u52A1\u3002</p><p>3.\u8FDB\u5165\u5FAE\u670D\u52A1\u4EE3\u7801\u6240\u5728\u7684\u8DEF\u5F84\u3002\u7136\u540E\u901A\u8FC7for\u5FAA\u73AF\u7684\u65B9\u5F0F\uFF0C\u904D\u5386service_list\u53D8\u91CF\u4E2D\u7684\u5404\u4E2A\u5FAE\u670D\u52A1\uFF0C\u7136\u540E\u672C\u6B21\u5FAA\u73AF\u7684\u5FAE\u670D\u52A1\u4EE3\u7801\u8DEF\u5F84\uFF0C\u5224\u65AD\u662F\u5426\u6709\u5305\u542Bbiz\u7684\u76EE\u5F55\uFF0C\u5982\u679C\u6709biz\u76EE\u5F55\u5219\u5207\u5165\u5230biz\u76EE\u5F55\uFF0C\u7136\u540E\u901A\u8FC7\u53D8\u91CF\u7684\u5F62\u5F0F\u5B9A\u4E49\u955C\u50CF\u540D\u79F0\uFF0C\u6784\u5EFA\u955C\u50CF\u3001\u63A8\u9001\u81F3\u955C\u50CF\u4ED3\u5E93\u3002</p><p>4.\u5C06\u6700\u65B0\u6253\u5305\u597D\u7684docker\u8FDB\u5728yaml\u6587\u4EF6\u4E2D\u901A\u8FC7sed\u547D\u4EE4\u66FF\u6362\uFF0C\u6700\u540E\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72\u8FD9\u4E2A\u5FAE\u670D\u52A1\u3002</p><p><code>\${1:-\${service_list}}</code>\uFF1A\u8FD9\u4E2A\u7684\u610F\u601D\u5C31\u662F\u5982\u679C<code>$1</code>\u4F4D\u7F6E\u53C2\u6570\u6CA1\u6709\u4F20\u5165\u503C\uFF0C\u90A3\u4E48service_list\u53D8\u91CF\u7684\u503C\u5C31\u662F<code>$service_list</code>\u53D8\u91CF\u7684\u503C\uFF0C\u76F8\u5F53\u4E8E\u4E00\u4E2A\u5224\u65AD\u3002</p><p>\u672C\u811A\u672C\u53EF\u4EE5\u81EA\u52A8\u5316\u5B8C\u6210\u5FAE\u670D\u52A1\u5230K8S\u96C6\u7FA4\u7684\u4E00\u4E2A\u90E8\u7F72\uFF0C\u5305\u62EC\u7A0B\u5E8F\u7684\u7F16\u8BD1\u3001\u6253\u5305\u6210docker\u955C\u50CF\u3001\u63A8\u8350\u955C\u50CF\u5230Harbor\u4ED3\u5E93\uFF0C\u6700\u540E\u5C06\u7A0B\u5E8F\u90E8\u7F72\u5230K8S\u96C6\u7FA4</p><div class="language-shell"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;">#!/bin/bash</span></span>
<span class="line"><span style="color:#DBD7CA;">registry_addr=192.168.20.11</span></span>
<span class="line"><span style="color:#DBD7CA;">service_list=</span><span style="color:#C98A7D;">&quot;eureka-service gateway-service order-service product-service stock-service portal-service&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">service_list=</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">1</span><span style="color:#CB7676;">:-</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">service_list</span><span style="color:#858585;">}}</span><span style="color:#DBD7CA;">      </span></span>
<span class="line"><span style="color:#DBD7CA;">current_dir=/root/springcloud/simple-microservice-dev1/k8s</span></span>
<span class="line"><span style="color:#DBD7CA;">service_dir=</span><span style="color:#C98A7D;">$(dirname </span><span style="color:#858585;">$</span><span style="color:#C98A7D;">current_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">service_dir</span></span>
<span class="line"><span style="color:#758575;">#mvn clean package -Dmaven.test.skip=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">for</span><span style="color:#DBD7CA;"> </span><span style="color:#B8A965;">service</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">in</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">service_list</span><span style="color:#CB7676;">;</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">do</span></span>
<span class="line"><span style="color:#DBD7CA;">   </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">service_dir</span><span style="color:#DBD7CA;">/</span><span style="color:#858585;">$</span><span style="color:#B8A965;">service</span></span>
<span class="line"><span style="color:#DBD7CA;">   biz_count=</span><span style="color:#C98A7D;">\`ls </span><span style="color:#CB7676;">|</span><span style="color:#C98A7D;"> grep biz </span><span style="color:#CB7676;">|</span><span style="color:#C98A7D;"> wc -l\`</span></span>
<span class="line"><span style="color:#DBD7CA;">   </span><span style="color:#4D9375;">if</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">[</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">$</span><span style="color:#B8A965;">biz_count</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">-eq</span><span style="color:#DBD7CA;"> 1 </span><span style="color:#858585;">]</span><span style="color:#CB7676;">;</span><span style="color:#4D9375;">then</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#E0A569;">cd</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">\${</span><span style="color:#B8A965;">service</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">-biz</span></span>
<span class="line"><span style="color:#DBD7CA;">   </span><span style="color:#4D9375;">fi</span></span>
<span class="line"><span style="color:#DBD7CA;">   service_name=</span><span style="color:#C98A7D;">\`echo </span><span style="color:#858585;">$</span><span style="color:#C98A7D;">service </span><span style="color:#CB7676;">|</span><span style="color:#C98A7D;"> awk -F- &#39;{print $1}&#39;\`</span></span>
<span class="line"><span style="color:#DBD7CA;">   image_name=</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">registry_addr</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/simple-microservice/</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">service</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">   yaml_name=</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">service_name</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">-deploy.yaml</span></span>
<span class="line"><span style="color:#DBD7CA;">   docker build -t </span><span style="color:#858585;">\${</span><span style="color:#B8A965;">image_name</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">.</span></span>
<span class="line"><span style="color:#DBD7CA;">   docker push </span><span style="color:#858585;">\${</span><span style="color:#B8A965;">image_name</span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">   sed -i -r </span><span style="color:#C98A7D;">&quot;s#(image: )(.*)#\\1</span><span style="color:#858585;">$</span><span style="color:#C98A7D;">image_name#&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">\${</span><span style="color:#B8A965;">current_dir</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">yaml_name</span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">   kubectl apply -f </span><span style="color:#858585;">\${</span><span style="color:#B8A965;">current_dir</span><span style="color:#858585;">}</span><span style="color:#DBD7CA;">/</span><span style="color:#858585;">\${</span><span style="color:#B8A965;">yaml_name</span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#4D9375;">done</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">#!/bin/bash</span></span>
<span class="line"><span style="color:#393A34;">registry_addr=192.168.20.11</span></span>
<span class="line"><span style="color:#393A34;">service_list=</span><span style="color:#B56959;">&quot;eureka-service gateway-service order-service product-service stock-service portal-service&quot;</span></span>
<span class="line"><span style="color:#393A34;">service_list=</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">1</span><span style="color:#AB5959;">:-</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">service_list</span><span style="color:#8E8F8B;">}}</span><span style="color:#393A34;">      </span></span>
<span class="line"><span style="color:#393A34;">current_dir=/root/springcloud/simple-microservice-dev1/k8s</span></span>
<span class="line"><span style="color:#393A34;">service_dir=</span><span style="color:#B56959;">$(dirname </span><span style="color:#8E8F8B;">$</span><span style="color:#B56959;">current_dir)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B58451;">cd</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">service_dir</span></span>
<span class="line"><span style="color:#A0ADA0;">#mvn clean package -Dmaven.test.skip=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">for</span><span style="color:#393A34;"> </span><span style="color:#8C862B;">service</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">in</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">service_list</span><span style="color:#AB5959;">;</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">do</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">service_dir</span><span style="color:#393A34;">/</span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">service</span></span>
<span class="line"><span style="color:#393A34;">   biz_count=</span><span style="color:#B56959;">\`ls </span><span style="color:#AB5959;">|</span><span style="color:#B56959;"> grep biz </span><span style="color:#AB5959;">|</span><span style="color:#B56959;"> wc -l\`</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#1C6B48;">if</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">[</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">$</span><span style="color:#8C862B;">biz_count</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">-eq</span><span style="color:#393A34;"> 1 </span><span style="color:#8E8F8B;">]</span><span style="color:#AB5959;">;</span><span style="color:#1C6B48;">then</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B58451;">cd</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">service</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">-biz</span></span>
<span class="line"><span style="color:#393A34;">   </span><span style="color:#1C6B48;">fi</span></span>
<span class="line"><span style="color:#393A34;">   service_name=</span><span style="color:#B56959;">\`echo </span><span style="color:#8E8F8B;">$</span><span style="color:#B56959;">service </span><span style="color:#AB5959;">|</span><span style="color:#B56959;"> awk -F- &#39;{print $1}&#39;\`</span></span>
<span class="line"><span style="color:#393A34;">   image_name=</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">registry_addr</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/simple-microservice/</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">service</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">:v1</span></span>
<span class="line"><span style="color:#393A34;">   yaml_name=</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">service_name</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">-deploy.yaml</span></span>
<span class="line"><span style="color:#393A34;">   docker build -t </span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">image_name</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;"> </span><span style="color:#B58451;">.</span></span>
<span class="line"><span style="color:#393A34;">   docker push </span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">image_name</span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">   sed -i -r </span><span style="color:#B56959;">&quot;s#(image: )(.*)#\\1</span><span style="color:#8E8F8B;">$</span><span style="color:#B56959;">image_name#&quot;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">current_dir</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">yaml_name</span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">   kubectl apply -f </span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">current_dir</span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;">/</span><span style="color:#8E8F8B;">\${</span><span style="color:#8C862B;">yaml_name</span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#1C6B48;">done</span></span>
<span class="line"></span></code></pre></div><p><strong>2.\u811A\u672C\u4F7F\u7528\u65B9\u5F0F</strong></p><p>\u6267\u884C\u672C\u811A\u672C\u524D\u63D0\u662F\u5FC5\u987B\u5148\u5C06\u7A0B\u5E8F\u90E8\u7F72\u7684YAML\u6587\u4EF6\u51C6\u5907\u597D\uFF0C\u653E\u5728/root/springcloud/simple-microservice-dev1/k8s\u8DEF\u5F84</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">\u811A\u672C\u7684\u7528\u6CD5\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">sh deploy_k8s.sh \u5FAE\u670D\u52A1\u540D\u79F0</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">\u811A\u672C\u7684\u7528\u6CD5\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">sh deploy_k8s.sh \u5FAE\u670D\u52A1\u540D\u79F0</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-5-\u4F7F\u7528\u811A\u672C\u90E8\u7F72order\u8BA2\u5355\u670D\u52A1" tabindex="-1">4.5.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Order\u8BA2\u5355\u670D\u52A1 <a class="header-anchor" href="#_4-5-\u4F7F\u7528\u811A\u672C\u90E8\u7F72order\u8BA2\u5355\u670D\u52A1" aria-hidden="true">#</a></h3><h4 id="_4-5-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" tabindex="-1">4.5.1.\u7F16\u5199\u8D44\u6E90\u90E8\u7F72YAML\u6587\u4EF6 <a class="header-anchor" href="#_4-5-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" aria-hidden="true">#</a></h4><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim order-deploy.yaml </span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">order</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">order</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">order</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">order</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/order-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Always</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim order-deploy.yaml </span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">order</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">order</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">order</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">order</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/order-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Always</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-5-2\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72order\u8BA2\u5355\u670D\u52A1" tabindex="-1">4.5.2\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72Order\u8BA2\u5355\u670D\u52A1 <a class="header-anchor" href="#_4-5-2\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72order\u8BA2\u5355\u670D\u52A1" aria-hidden="true">#</a></h4><p><strong>1.\u4F7F\u7528\u811A\u672C\u5C06Order\u670D\u52A1\u90E8\u7F72\u5230K8S\u96C6\u7FA4</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> sh deploy_k8s.sh order-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u6267\u884C\u5B8C\u811A\u672C\uFF0Corder\u7A0B\u5E8F\u7684docker\u955C\u50CF\u5DF2\u7ECF\u5236\u4F5C\u597D\u5E76\u4E14\u63A8\u9001\u5230\u4E86harbor\u4ED3\u5E93\uFF0C\u5DF2\u7ECF\u4F7F\u7528sed\u547D\u4EE4\u5C06\u955C\u50CF\u7684\u540D\u79F0\u5728yaml\u4E2D\u66FF\u6362\u6210\u4E86\u6700\u65B0\u7684\u955C\u50CF\uFF0C\u90E8\u7F72\u5230\u4E86K8S\u96C6\u7FA4</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> sh deploy_k8s.sh order-service</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u6267\u884C\u5B8C\u811A\u672C\uFF0Corder\u7A0B\u5E8F\u7684docker\u955C\u50CF\u5DF2\u7ECF\u5236\u4F5C\u597D\u5E76\u4E14\u63A8\u9001\u5230\u4E86harbor\u4ED3\u5E93\uFF0C\u5DF2\u7ECF\u4F7F\u7528sed\u547D\u4EE4\u5C06\u955C\u50CF\u7684\u540D\u79F0\u5728yaml\u4E2D\u66FF\u6362\u6210\u4E86\u6700\u65B0\u7684\u955C\u50CF\uFF0C\u90E8\u7F72\u5230\u4E86K8S\u96C6\u7FA4</span></span>
<span class="line"></span></code></pre></div><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/be81d4ca75f14ea1afd933b7e4f34ea5.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><strong>2.\u67E5\u770B\u7A0B\u5E8F\u8D44\u6E90\u7684\u72B6\u6001</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                          READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-0                  1/1     Running   1          2d15h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-1                  1/1     Running   0          2d15h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-2                  1/1     Running   0          2d15h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/gateway-8665d5d56-tx2m8   1/1     Running   0          39m</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/order-6694f4c474-cp5d6    1/1     Running   0          35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway   1/1     1            1           21h</span></span>
<span class="line"><span style="color:#DBD7CA;">order     1/1     1            1           36m</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                          READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-0                  1/1     Running   1          2d15h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-1                  1/1     Running   0          2d15h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-2                  1/1     Running   0          2d15h</span></span>
<span class="line"><span style="color:#393A34;">pod/gateway-8665d5d56-tx2m8   1/1     Running   0          39m</span></span>
<span class="line"><span style="color:#393A34;">pod/order-6694f4c474-cp5d6    1/1     Running   0          35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">gateway   1/1     1            1           21h</span></span>
<span class="line"><span style="color:#393A34;">order     1/1     1            1           36m</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-6-\u4F7F\u7528\u811A\u672C\u90E8\u7F72product\u5546\u54C1\u670D\u52A1" tabindex="-1">4.6.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Product\u5546\u54C1\u670D\u52A1 <a class="header-anchor" href="#_4-6-\u4F7F\u7528\u811A\u672C\u90E8\u7F72product\u5546\u54C1\u670D\u52A1" aria-hidden="true">#</a></h3><h4 id="_4-6-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" tabindex="-1">4.6.1.\u7F16\u5199\u8D44\u6E90\u90E8\u7F72YAML\u6587\u4EF6 <a class="header-anchor" href="#_4-6-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" aria-hidden="true">#</a></h4><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim product-deploy.yaml </span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/product-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Always</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim product-deploy.yaml </span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/product-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Always</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="_4-6-2-\u5728k8s\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719Fproduct\u5546\u54C1\u670D\u52A1" tabindex="-1">4.6.2.\u5728K8S\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719FProduct\u5546\u54C1\u670D\u52A1 <a class="header-anchor" href="#_4-6-2-\u5728k8s\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719Fproduct\u5546\u54C1\u670D\u52A1" aria-hidden="true">#</a></h4><p><strong>1.\u4F7F\u7528\u811A\u672C\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72product\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> sh deploy_k8s.sh product-service</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> sh deploy_k8s.sh product-service</span></span>
<span class="line"></span></code></pre></div><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/72e772fd74a1497188734a6e1fd3d28e.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><strong>2.\u67E5\u770B\u7A0B\u5E8F\u8D44\u6E90\u7684\u72B6\u6001</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway-8665d5d56-tx2m8    1/1     Running   2          74m</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-cp5d6     1/1     Running   4          69m</span></span>
<span class="line"><span style="color:#DBD7CA;">product-77c8bb6847-vbxnr   1/1     Running   2          21m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway   1/1     1            1           21h</span></span>
<span class="line"><span style="color:#DBD7CA;">order     1/1     1            1           72m</span></span>
<span class="line"><span style="color:#DBD7CA;">product   1/1     1            1           24m</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#393A34;">eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#393A34;">gateway-8665d5d56-tx2m8    1/1     Running   2          74m</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-cp5d6     1/1     Running   4          69m</span></span>
<span class="line"><span style="color:#393A34;">product-77c8bb6847-vbxnr   1/1     Running   2          21m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">gateway   1/1     1            1           21h</span></span>
<span class="line"><span style="color:#393A34;">order     1/1     1            1           72m</span></span>
<span class="line"><span style="color:#393A34;">product   1/1     1            1           24m</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-7-\u4F7F\u7528\u811A\u672C\u90E8\u7F72stock\u5E93\u5B58\u670D\u52A1" tabindex="-1">4.7.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Stock\u5E93\u5B58\u670D\u52A1 <a class="header-anchor" href="#_4-7-\u4F7F\u7528\u811A\u672C\u90E8\u7F72stock\u5E93\u5B58\u670D\u52A1" aria-hidden="true">#</a></h3><h4 id="_4-7-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" tabindex="-1">4.7.1.\u7F16\u5199\u8D44\u6E90\u90E8\u7F72YAML\u6587\u4EF6 <a class="header-anchor" href="#_4-7-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" aria-hidden="true">#</a></h4><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim product-deploy.yaml </span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">product</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/product-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Always</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim product-deploy.yaml </span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">product</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/product-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Always</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"></span></code></pre></div><h4 id="_4-7-2-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72stock\u5E93\u5B58\u670D\u52A1" tabindex="-1">4.7.2.\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72Stock\u5E93\u5B58\u670D\u52A1 <a class="header-anchor" href="#_4-7-2-\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72stock\u5E93\u5B58\u670D\u52A1" aria-hidden="true">#</a></h4><p><strong>1.\u4F7F\u7528\u811A\u672C\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72stock\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> sh deploy_k8s.sh stock-service</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> sh deploy_k8s.sh stock-service</span></span>
<span class="line"></span></code></pre></div><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/34720b14a59e4d8e97e5d887beff8a9d.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><strong>2.\u67E5\u770B\u7A0B\u5E8F\u8D44\u6E90\u7684\u72B6\u6001</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-0                   1/1     Running   5          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway-8665d5d56-tx2m8    1/1     Running   2          112m</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-cp5d6     1/1     Running   4          107m</span></span>
<span class="line"><span style="color:#DBD7CA;">product-77c8bb6847-vbxnr   1/1     Running   2          59m</span></span>
<span class="line"><span style="color:#DBD7CA;">stock-6cf98bb445-mxf7b     1/1     Running   0          30m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway   1/1     1            1           22h</span></span>
<span class="line"><span style="color:#DBD7CA;">order     1/1     1            1           108m</span></span>
<span class="line"><span style="color:#DBD7CA;">product   1/1     1            1           60m</span></span>
<span class="line"><span style="color:#DBD7CA;">stock     2/2     2            2           31m</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u67E5\u770Bpod\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka-0                   1/1     Running   5          2d16h</span></span>
<span class="line"><span style="color:#393A34;">eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#393A34;">eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#393A34;">gateway-8665d5d56-tx2m8    1/1     Running   2          112m</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-cp5d6     1/1     Running   4          107m</span></span>
<span class="line"><span style="color:#393A34;">product-77c8bb6847-vbxnr   1/1     Running   2          59m</span></span>
<span class="line"><span style="color:#393A34;">stock-6cf98bb445-mxf7b     1/1     Running   0          30m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770Bdeployment\u8D44\u6E90\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get deploy -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">gateway   1/1     1            1           22h</span></span>
<span class="line"><span style="color:#393A34;">order     1/1     1            1           108m</span></span>
<span class="line"><span style="color:#393A34;">product   1/1     1            1           60m</span></span>
<span class="line"><span style="color:#393A34;">stock     2/2     2            2           31m</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-8-\u4F7F\u7528\u811A\u672C\u90E8\u7F72portal\u524D\u7AEF\u9996\u9875" tabindex="-1">4.8.\u4F7F\u7528\u811A\u672C\u90E8\u7F72Portal\u524D\u7AEF\u9996\u9875 <a class="header-anchor" href="#_4-8-\u4F7F\u7528\u811A\u672C\u90E8\u7F72portal\u524D\u7AEF\u9996\u9875" aria-hidden="true">#</a></h3><h4 id="_4-8-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" tabindex="-1">4.8.1.\u7F16\u5199\u8D44\u6E90\u90E8\u7F72YAML\u6587\u4EF6 <a class="header-anchor" href="#_4-8-1-\u7F16\u5199\u8D44\u6E90\u90E8\u7F72yaml\u6587\u4EF6" aria-hidden="true">#</a></h4><div class="language-yaml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim portal-deploy.yaml </span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Ingress</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">rules</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">host</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal.jiangxl.com</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">http</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">paths</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">path</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">/</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">backend</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">serviceName</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">servicePort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Service</span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#A1B567;">---</span></span>
<span class="line"><span style="color:#429988;">apiVersion</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">apps/v1</span></span>
<span class="line"><span style="color:#429988;">kind</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Deployment</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">namespace</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple-ms</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">replicas</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">selector</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">matchLabels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#429988;">template</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">metadata</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">labels</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">project</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">simple</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">app</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#429988;">spec</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">imagePullSecrets</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">registry-pull-secret</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#429988;">containers</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">name</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">portal</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">image</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">192.168.20.11/simple-microservice/portal-service:v1</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">imagePullPolicy</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">Always</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">ports</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#858585;">-</span><span style="color:#DBD7CA;"> </span><span style="color:#429988;">protocol</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">TCP</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">containerPort</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">resources</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">requests</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">0.5</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">256Mi</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">limits</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">cpu</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">1</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">memory</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">1Gi</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">readinessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#429988;">livenessProbe</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">tcpSocket</span><span style="color:#858585;">:</span></span>
<span class="line"><span style="color:#DBD7CA;">            </span><span style="color:#429988;">port</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">8080</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">initialDelaySeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">60</span></span>
<span class="line"><span style="color:#DBD7CA;">          </span><span style="color:#429988;">periodSeconds</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">10</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim portal-deploy.yaml </span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">extensions/v1beta1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Ingress</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">rules</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">host</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal.jiangxl.com</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">http</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">paths</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">path</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">/</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">backend</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">serviceName</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">servicePort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Service</span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#6C7834;">---</span></span>
<span class="line"><span style="color:#2F8A89;">apiVersion</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">apps/v1</span></span>
<span class="line"><span style="color:#2F8A89;">kind</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Deployment</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">namespace</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple-ms</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">replicas</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">selector</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">matchLabels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#2F8A89;">template</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">metadata</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">labels</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">project</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">simple</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">app</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#2F8A89;">spec</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">imagePullSecrets</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">registry-pull-secret</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#2F8A89;">containers</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">name</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">portal</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">image</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">192.168.20.11/simple-microservice/portal-service:v1</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">imagePullPolicy</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">Always</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">ports</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#8E8F8B;">-</span><span style="color:#393A34;"> </span><span style="color:#2F8A89;">protocol</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">TCP</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">containerPort</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">resources</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">requests</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">0.5</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">256Mi</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">limits</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">cpu</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">1</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">memory</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">1Gi</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">readinessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#2F8A89;">livenessProbe</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">tcpSocket</span><span style="color:#8E8F8B;">:</span></span>
<span class="line"><span style="color:#393A34;">            </span><span style="color:#2F8A89;">port</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">8080</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">initialDelaySeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">60</span></span>
<span class="line"><span style="color:#393A34;">          </span><span style="color:#2F8A89;">periodSeconds</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">10</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h4 id="_4-8-2-\u5728k8s\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719Fportal\u5B58\u670D\u52A1" tabindex="-1">4.8.2.\u5728K8S\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719FPortal\u5B58\u670D\u52A1 <a class="header-anchor" href="#_4-8-2-\u5728k8s\u96C6\u7FA4\u4E2D\u719F\u4E0D\u719Fportal\u5B58\u670D\u52A1" aria-hidden="true">#</a></h4><p><strong>1.\u4F7F\u7528\u811A\u672C\u5728K8S\u96C6\u7FA4\u4E2D\u90E8\u7F72portal\u670D\u52A1</strong></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> sh deploy_k8s.sh portal-service</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> sh deploy_k8s.sh portal-service</span></span>
<span class="line"></span></code></pre></div><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/c452fabffdb24a97b0ec5dbfc8dbe6b5.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p><strong>2.\u67E5\u770B\u7A0B\u5E8F\u8D44\u6E90\u7684\u72B6\u6001</strong></p><p>\u5230\u6B64\u4E3A\u6B62\uFF0C\u6240\u6709\u7684simple\u7535\u5546\u5E73\u53F0\u7684\u5FAE\u670D\u52A1\u7A0B\u5E8F\u4EE5\u53CA\u5168\u90E8\u90E8\u7F72\u5B8C\u6BD5\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">1.\u67E5\u770B\u6240\u6709\u5FAE\u670D\u52A1\u7684\u7A0B\u5E8F</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-0                   1/1     Running   5          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/gateway-8665d5d56-tx2m8    1/1     Running   2          117m</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/order-6694f4c474-cp5d6     1/1     Running   4          112m</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/portal-d5d55b784-7kntp     1/1     Running   0          2m53s</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/product-77c8bb6847-vbxnr   1/1     Running   2          64m</span></span>
<span class="line"><span style="color:#DBD7CA;">pod/stock-6cf98bb445-mxf7b     1/1     Running   0          35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#858585;">(</span><span style="color:#DBD7CA;">S</span><span style="color:#858585;">)</span><span style="color:#DBD7CA;">    AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">service/eureka    ClusterIP   None         </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   2d18h</span></span>
<span class="line"><span style="color:#DBD7CA;">service/gateway   ClusterIP   10.0.0.188   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   22h</span></span>
<span class="line"><span style="color:#DBD7CA;">service/portal    ClusterIP   10.0.0.190   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">        8080/TCP   2m53s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/gateway   1/1     1            1           22h</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/order     1/1     1            1           112m</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/portal    1/1     1            1           2m53s</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/product   1/1     1            1           65m</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/stock     1/1     1            1           35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                                 DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/gateway-8665d5d56    1         1         1       117m</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/order-6694f4c474     1         1         1       112m</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/portal-d5d55b784     1         1         1       2m53s</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/product-77c8bb6847   1         1         1       64m</span></span>
<span class="line"><span style="color:#DBD7CA;">replicaset.apps/stock-6cf98bb445     1         1         1       35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">NAME                      READY   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">statefulset.apps/eureka   3/3     2d18h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">2.\u67E5\u770B\u6240\u6709\u5FAE\u670D\u52A1\u7684ingress\u8D44\u6E90</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   eureka.jiangxl.com    10.0.0.107   80      2d18h</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway   </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   gateway.jiangxl.com   10.0.0.107   80      22h</span></span>
<span class="line"><span style="color:#DBD7CA;">portal    </span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">none</span><span style="color:#CB7676;">&gt;</span><span style="color:#DBD7CA;">   portal.jiangxl.com    10.0.0.107   80      3m16s</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">1.\u67E5\u770B\u6240\u6709\u5FAE\u670D\u52A1\u7684\u7A0B\u5E8F</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get all -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                           READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-0                   1/1     Running   5          2d16h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-1                   1/1     Running   3          2d16h</span></span>
<span class="line"><span style="color:#393A34;">pod/eureka-2                   1/1     Running   2          2d16h</span></span>
<span class="line"><span style="color:#393A34;">pod/gateway-8665d5d56-tx2m8    1/1     Running   2          117m</span></span>
<span class="line"><span style="color:#393A34;">pod/order-6694f4c474-cp5d6     1/1     Running   4          112m</span></span>
<span class="line"><span style="color:#393A34;">pod/portal-d5d55b784-7kntp     1/1     Running   0          2m53s</span></span>
<span class="line"><span style="color:#393A34;">pod/product-77c8bb6847-vbxnr   1/1     Running   2          64m</span></span>
<span class="line"><span style="color:#393A34;">pod/stock-6cf98bb445-mxf7b     1/1     Running   0          35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME              TYPE        CLUSTER-IP   EXTERNAL-IP   PORT</span><span style="color:#8E8F8B;">(</span><span style="color:#393A34;">S</span><span style="color:#8E8F8B;">)</span><span style="color:#393A34;">    AGE</span></span>
<span class="line"><span style="color:#393A34;">service/eureka    ClusterIP   None         </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   2d18h</span></span>
<span class="line"><span style="color:#393A34;">service/gateway   ClusterIP   10.0.0.188   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   22h</span></span>
<span class="line"><span style="color:#393A34;">service/portal    ClusterIP   10.0.0.190   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">        8080/TCP   2m53s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                      READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/gateway   1/1     1            1           22h</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/order     1/1     1            1           112m</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/portal    1/1     1            1           2m53s</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/product   1/1     1            1           65m</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/stock     1/1     1            1           35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                                 DESIRED   CURRENT   READY   AGE</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/gateway-8665d5d56    1         1         1       117m</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/order-6694f4c474     1         1         1       112m</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/portal-d5d55b784     1         1         1       2m53s</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/product-77c8bb6847   1         1         1       64m</span></span>
<span class="line"><span style="color:#393A34;">replicaset.apps/stock-6cf98bb445     1         1         1       35m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">NAME                      READY   AGE</span></span>
<span class="line"><span style="color:#393A34;">statefulset.apps/eureka   3/3     2d18h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">2.\u67E5\u770B\u6240\u6709\u5FAE\u670D\u52A1\u7684ingress\u8D44\u6E90</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get ingress -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME      CLASS    HOSTS                 ADDRESS      PORTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   eureka.jiangxl.com    10.0.0.107   80      2d18h</span></span>
<span class="line"><span style="color:#393A34;">gateway   </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   gateway.jiangxl.com   10.0.0.107   80      22h</span></span>
<span class="line"><span style="color:#393A34;">portal    </span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">none</span><span style="color:#AB5959;">&gt;</span><span style="color:#393A34;">   portal.jiangxl.com    10.0.0.107   80      3m16s</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-9-\u67E5\u770Beureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F" tabindex="-1">4.9.\u67E5\u770BEureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F <a class="header-anchor" href="#_4-9-\u67E5\u770Beureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u5404\u4E2A\u5FAE\u670D\u52A1\u7684\u4FE1\u606F" aria-hidden="true">#</a></h3><p>\u6BCF\u4E2A\u5FAE\u670D\u52A1\u7A0B\u5E8F\u5747\u5728Eureka\u6CE8\u518C\u4E2D\u5FC3\u4E2D\u6CE8\u518C\u5B8C\u6210\u3002</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/feae01f050a440ed92aa5f948efd875f.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h3 id="_4-10-\u4F7F\u7528simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0" tabindex="-1">4.10.\u4F7F\u7528simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0 <a class="header-anchor" href="#_4-10-\u4F7F\u7528simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0" aria-hidden="true">#</a></h3><p>\u52304.8\u6B65\u9AA4\u4E4B\u540E\uFF0C\u6211\u4EEC\u7684simple\u5FAE\u670D\u52A1\u7535\u5546\u5E73\u53F0\u5DF2\u7ECF\u5168\u90E8\u90E8\u7F72\u5728K8S\u96C6\u7FA4\u4E86\uFF0C\u53EF\u4EE5\u5728\u672C\u673Ahosts\u91CC\u7ED1\u5B9Asimple\u5FAE\u670D\u52A1\u7684\u57DF\u540D\uFF0C\u64CD\u4F5C\u7535\u5546\u5E73\u53F0\u3002</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/11d0320836a54e1b96d6e6801bdb9f8b.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u8FD9\u4E2A\u5FAE\u670D\u52A1\u5E73\u53F0\u7684\u80CC\u666F\u56FE\u5176\u5B9E\u662F\u4EAC\u4E1C\u7684\u4E00\u5F20\u56FE\u800C\u5DF2\uFF0C\u662F\u4E0D\u53EF\u4EE5\u70B9\u7684\u3002</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/5de80a8717554409af8d9a14b6462e30.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u53EA\u80FD\u5728\u5546\u54C1\u670D\u52A1\u4E2D\u67E5\u8BE2\u80FD\u8D2D\u4E70\u7684\u5546\u54C1\uFF0C\u7136\u540E\u8FDB\u884C\u8D2D\u4E70\uFF0C\u6700\u540E\u5728\u8BA2\u5355\u670D\u52A1\u4E2D\u67E5\u8BE2\u3002</p><p>\u641C\u7D22\u5546\u54C1\u65F6\u4F1A\u8C03\u7528product\u5546\u54C1\u5FAE\u670D\u52A1\uFF0C\u4E0B\u5355\u540E\uFF0C\u67E5\u8BE2\u8BA2\u5355\u670D\u52A1\u65F6\u4F1A\u8C03\u7528order\u8BA2\u5355\u670D\u52A1\u3002</p><p>\u70B9\u51FB\u67E5\u8BE2\u5546\u54C1\u670D\u52A1\uFF0C\u6211\u4EEC\u6765\u4E0B\u5355\u4E00\u4E2A\u7F8E\u5973\u89C2\u5BDF\u4E00\u4E0B\u6548\u679C\uFF0C\u4E0B\u5355\u540E\u4F1A\u63D0\u793A\u4E0B\u5355\u6210\u529F\u3002</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/2776324a762543f5a9df8fc3fc0f6e19.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u70B9\u51FB\u67E5\u8BE2\u8BA2\u5355\u670D\u52A1\u5C31\u53EF\u4EE5\u770B\u5230\u6211\u5417\u4E0B\u7684\u8BA2\u5355\u4E86</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/91eee91044a3497986b5f0f788a95738.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><h2 id="_5-\u57FA\u4E8Ek8s\u96C6\u7FA4\u7684\u5FAE\u670D\u52A1\u7684\u6269\u5BB9\u4E0E\u5347\u7EA7" tabindex="-1">5.\u57FA\u4E8EK8S\u96C6\u7FA4\u7684\u5FAE\u670D\u52A1\u7684\u6269\u5BB9\u4E0E\u5347\u7EA7 <a class="header-anchor" href="#_5-\u57FA\u4E8Ek8s\u96C6\u7FA4\u7684\u5FAE\u670D\u52A1\u7684\u6269\u5BB9\u4E0E\u5347\u7EA7" aria-hidden="true">#</a></h2><h3 id="_5-1-\u5FAE\u670D\u52A1\u7684\u6269\u5BB9" tabindex="-1">5.1.\u5FAE\u670D\u52A1\u7684\u6269\u5BB9 <a class="header-anchor" href="#_5-1-\u5FAE\u670D\u52A1\u7684\u6269\u5BB9" aria-hidden="true">#</a></h3><p>\u5FAE\u670D\u52A1\u5728\u7269\u7406\u673A\u73AF\u5883\u8FD0\u884C\u65F6\uFF0C\u7F51\u7AD9\u5E76\u53D1\u91CF\u9AD8\u7684\u60C5\u51B5\u4E0B\uFF0C\u6269\u5BB9\u53EA\u80FD\u53BB\u8D2D\u4E70\u4E91\u670D\u52A1\u5668\uFF0C\u7136\u540E\u642D\u5EFA\u4E00\u5957\u4E00\u6A21\u4E00\u6837\u7684\u670D\u52A1\uFF0C\u624B\u52A8\u7EC4\u6210\u8D1F\u8F7D\u5747\u8861\u96C6\u7FA4\uFF0C\u589E\u52A0\u4E00\u53F0\u5176\u5B9E\u8FD8\u597D\uFF0C\u5982\u679C\u8981\u589E\u52A0\u51E0\u5341\u53F0\uFF0C\u592A\u8D39\u4EBA\u5DE5\u6210\u672C\u4E86\u3002</p><p>\u5F53\u5FAE\u670D\u52A1\u8FC1\u79FB\u5230K8S\u96C6\u7FA4\u4E4B\u540E\uFF0C\u6269\u5BB9\u5176\u5B9E\u53D8\u5F97\u975E\u5E38\u7B80\u5355\uFF0C\u53EA\u9700\u8981\u589E\u52A0\u7A0B\u5E8FPod\u7684\u526F\u672C\u6570\u5C31\u53EF\u4EE5\u5B8C\u6210\u7A0B\u5E8F\u7684\u6269\u5BB9\u3002</p><p>\u547D\u4EE4\u5982\u4E0B\uFF0C\u4EE5\u6269\u5C55order\u5546\u54C1\u5FAE\u670D\u52A1\u4E3A\u4F8B\u3002</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">\u5C06order\u5546\u54C1\u670D\u52A1\u7684\u526F\u672C\u6570\u8C03\u6574\u4E3A3\u4E2A\uFF0C\u539F\u672C\u662F1\u4E2A\uFF0C\u73B0\u5728\u6269\u5BB9\u52303\u4E2A</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl scale deploy order --replicas=3 -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/order scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u53EF\u4EE5\u770B\u5230order\u8BA2\u5355\u670D\u52A1\u76EE\u524D\u5DF2\u7ECF\u67093\u4E2Apod\u526F\u672C\u4E86</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-0                   1/1     Running   1          6m15s</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-1                   1/1     Running   0          7m59s</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-2                   1/1     Running   1          9m40s</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway-848874fc9d-pwp9w   1/1     Running   0          48m</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-cp5d6     1/1     Running   4          3h29m</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-kh8hm     1/1     Running   0          96s</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-rg7kw     1/1     Running   0          96s</span></span>
<span class="line"><span style="color:#DBD7CA;">portal-6fdcd765bd-mtq68    1/1     Running   1          24m</span></span>
<span class="line"><span style="color:#DBD7CA;">product-784d9f77b5-rxsf2   1/1     Running   0          64m</span></span>
<span class="line"><span style="color:#DBD7CA;">stock-6cf98bb445-l8gxb     1/1     Running   0          133m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u7F29\u5BB9\u4E5F\u5F88\u7B80\u5355\uFF0C\u5C06order\u7684\u526F\u672C\u6570\u7F29\u51CF\u62101\u4E2A</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl scale deploy order --replicas=1 -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">deployment.apps/order scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u6210\u529F\u7F29\u51CF\u52301\u4E2A\u526F\u672C</span></span>
<span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 </span><span style="color:#CB7676;">~</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#DBD7CA;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-0                   1/1     Running   1          9m24s</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-1                   1/1     Running   0          11m</span></span>
<span class="line"><span style="color:#DBD7CA;">eureka-2                   1/1     Running   1          12m</span></span>
<span class="line"><span style="color:#DBD7CA;">gateway-848874fc9d-pwp9w   1/1     Running   0          51m</span></span>
<span class="line"><span style="color:#DBD7CA;">order-6694f4c474-rg7kw     1/1     Running   0          4m45s</span></span>
<span class="line"><span style="color:#DBD7CA;">portal-6fdcd765bd-mtq68    1/1     Running   1          27m</span></span>
<span class="line"><span style="color:#DBD7CA;">product-784d9f77b5-rxsf2   1/1     Running   0          67m</span></span>
<span class="line"><span style="color:#DBD7CA;">stock-6cf98bb445-l8gxb     1/1     Running   0          136m</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">\u5C06order\u5546\u54C1\u670D\u52A1\u7684\u526F\u672C\u6570\u8C03\u6574\u4E3A3\u4E2A\uFF0C\u539F\u672C\u662F1\u4E2A\uFF0C\u73B0\u5728\u6269\u5BB9\u52303\u4E2A</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl scale deploy order --replicas=3 -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/order scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u53EF\u4EE5\u770B\u5230order\u8BA2\u5355\u670D\u52A1\u76EE\u524D\u5DF2\u7ECF\u67093\u4E2Apod\u526F\u672C\u4E86</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka-0                   1/1     Running   1          6m15s</span></span>
<span class="line"><span style="color:#393A34;">eureka-1                   1/1     Running   0          7m59s</span></span>
<span class="line"><span style="color:#393A34;">eureka-2                   1/1     Running   1          9m40s</span></span>
<span class="line"><span style="color:#393A34;">gateway-848874fc9d-pwp9w   1/1     Running   0          48m</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-cp5d6     1/1     Running   4          3h29m</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-kh8hm     1/1     Running   0          96s</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-rg7kw     1/1     Running   0          96s</span></span>
<span class="line"><span style="color:#393A34;">portal-6fdcd765bd-mtq68    1/1     Running   1          24m</span></span>
<span class="line"><span style="color:#393A34;">product-784d9f77b5-rxsf2   1/1     Running   0          64m</span></span>
<span class="line"><span style="color:#393A34;">stock-6cf98bb445-l8gxb     1/1     Running   0          133m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u7F29\u5BB9\u4E5F\u5F88\u7B80\u5355\uFF0C\u5C06order\u7684\u526F\u672C\u6570\u7F29\u51CF\u62101\u4E2A</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl scale deploy order --replicas=1 -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">deployment.apps/order scaled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u6210\u529F\u7F29\u51CF\u52301\u4E2A\u526F\u672C</span></span>
<span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 </span><span style="color:#AB5959;">~</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl get pod -n simple-ms</span></span>
<span class="line"><span style="color:#393A34;">NAME                       READY   STATUS    RESTARTS   AGE</span></span>
<span class="line"><span style="color:#393A34;">eureka-0                   1/1     Running   1          9m24s</span></span>
<span class="line"><span style="color:#393A34;">eureka-1                   1/1     Running   0          11m</span></span>
<span class="line"><span style="color:#393A34;">eureka-2                   1/1     Running   1          12m</span></span>
<span class="line"><span style="color:#393A34;">gateway-848874fc9d-pwp9w   1/1     Running   0          51m</span></span>
<span class="line"><span style="color:#393A34;">order-6694f4c474-rg7kw     1/1     Running   0          4m45s</span></span>
<span class="line"><span style="color:#393A34;">portal-6fdcd765bd-mtq68    1/1     Running   1          27m</span></span>
<span class="line"><span style="color:#393A34;">product-784d9f77b5-rxsf2   1/1     Running   0          67m</span></span>
<span class="line"><span style="color:#393A34;">stock-6cf98bb445-l8gxb     1/1     Running   0          136m</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-2-\u5FAE\u670D\u52A1\u7684\u5347\u7EA7" tabindex="-1">5.2.\u5FAE\u670D\u52A1\u7684\u5347\u7EA7 <a class="header-anchor" href="#_5-2-\u5FAE\u670D\u52A1\u7684\u5347\u7EA7" aria-hidden="true">#</a></h3><p>\u5FAE\u670D\u52A1\u5728\u7269\u7406\u673A\u73AF\u5883\u66F4\u65B0\u65F6\u53EA\u9700\u8981\u62C9\u53D6\u6700\u65B0\u7684\u4EE3\u7801\uFF0C\u7F16\u8BD1\u6210jar\u5305\uFF0C\u5728\u670D\u52A1\u5668\u4E0A\u90E8\u7F72\u5C31\u53EF\u4EE5\u4E86\uFF0C\u4F46\u662F\u5FAE\u670D\u52A1\u8FC1\u79FB\u5230K8S\u96C6\u7FA4\u4E4B\u540E\uFF0C\u66F4\u65B0\u8FC7\u7A0B\u5C31\u53D8\u5F97\u6BD4\u8F83\u590D\u6742\u4E86\uFF0C\u9996\u5148\u66F4\u65B0\u7684\u4EE3\u7801\uFF0C\u7136\u540E\u7F16\u8BD1\u6210jar\u5305\uFF0C\u518D\u901A\u8FC7Dockerfile\u5C06jar\u5305\u505A\u6210docker\u955C\u50CF\uFF0C\u7136\u540E\u5728k8s\u96C6\u7FA4\u4E2D\u90E8\u7F72\uFF0C\u5F53\u7136\u8FD9\u4E9B\u6D41\u7A0B\u53EF\u4EE5\u901A\u8FC7Jenkins\u5B9E\u73B0\u81EA\u52A8\u5316\u4E0A\u7EBF\u3002</p><h4 id="_5-2-1-\u5FAE\u8C03portal\u524D\u7AEF\u9996\u9875\u7684\u4EE3\u7801" tabindex="-1">5.2.1.\u5FAE\u8C03Portal\u524D\u7AEF\u9996\u9875\u7684\u4EE3\u7801 <a class="header-anchor" href="#_5-2-1-\u5FAE\u8C03portal\u524D\u7AEF\u9996\u9875\u7684\u4EE3\u7801" aria-hidden="true">#</a></h4><p>\u5C06\u5E73\u53F0\u7684\u8FD9\u4E9B\u6587\u4EF6\u4FEE\u6539\u6210jiangxl.com\u7684\u5185\u5BB9\u5B8C\u6210\u4E00\u6B21portal\u524D\u7AEF\u9996\u9875\u7684\u5347\u7EA7</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/6fff8cf3680744d9bd8f4340015acf60.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><p>\u9996\u5148\u627E\u5230\u8BB0\u5F55\u8FD9\u4E9B\u6587\u5B57\u7684\u6587\u4EF6</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/c8b660cdf01f4e92aed03aa0005f48a4.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;"># vim templates/index.ftl</span></span>
<span class="line"><span style="color:#758575;"># vim templates/orderList.ftl </span></span>
<span class="line"><span style="color:#758575;"># vim templates/productList.ftl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#DBD7CA;">\u8FDB\u5165\u6587\u4EF6\u540E\u5728\u672B\u884C\u6A21\u5F0F\u8F93\u5165\uFF1A</span></span>
<span class="line"><span style="color:#DBD7CA;">%s/\u5BB9\u5668\u5B66\u9662 www.ctnrs.com/jiangxl.com/g</span></span>
<span class="line"><span style="color:#DBD7CA;">%s/www.ctnrs.com/jiangxl.com/g</span></span>
<span class="line"><span style="color:#DBD7CA;">\u7136\u540E\u5C06\u6240\u6709\u7684\u5BB9\u5668\u5B66\u9662\u7684\u6587\u5B57\u5220\u9664</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;"># vim templates/index.ftl</span></span>
<span class="line"><span style="color:#A0ADA0;"># vim templates/orderList.ftl </span></span>
<span class="line"><span style="color:#A0ADA0;"># vim templates/productList.ftl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;">\u8FDB\u5165\u6587\u4EF6\u540E\u5728\u672B\u884C\u6A21\u5F0F\u8F93\u5165\uFF1A</span></span>
<span class="line"><span style="color:#393A34;">%s/\u5BB9\u5668\u5B66\u9662 www.ctnrs.com/jiangxl.com/g</span></span>
<span class="line"><span style="color:#393A34;">%s/www.ctnrs.com/jiangxl.com/g</span></span>
<span class="line"><span style="color:#393A34;">\u7136\u540E\u5C06\u6240\u6709\u7684\u5BB9\u5668\u5B66\u9662\u7684\u6587\u5B57\u5220\u9664</span></span>
<span class="line"></span></code></pre></div><h4 id="_5-2-2-\u7F16\u8BD1\u6700\u65B0\u4EE3\u7801" tabindex="-1">5.2.2.\u7F16\u8BD1\u6700\u65B0\u4EE3\u7801 <a class="header-anchor" href="#_5-2-2-\u7F16\u8BD1\u6700\u65B0\u4EE3\u7801" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 simple-microservice-dev1</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> mvn clean package -D maven.test.skip=true -P prod</span></span>
<span class="line"></span></code></pre></div><h4 id="_5-2-3-\u901A\u8FC7\u811A\u672C\u5C06protal\u6700\u65B0\u4EE3\u7801\u6253\u5305\u6210\u955C\u50CF" tabindex="-1">5.2.3.\u901A\u8FC7\u811A\u672C\u5C06Protal\u6700\u65B0\u4EE3\u7801\u6253\u5305\u6210\u955C\u50CF <a class="header-anchor" href="#_5-2-3-\u901A\u8FC7\u811A\u672C\u5C06protal\u6700\u65B0\u4EE3\u7801\u6253\u5305\u6210\u955C\u50CF" aria-hidden="true">#</a></h4><p>\u76F4\u63A5\u4F7F\u7528\u524D\u9762\u90E8\u7F72\u7A0B\u5E8F\u7684\u811A\u672C\u5373\u53EF</p><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> sh deploy_k8s.sh portal-service</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> sh deploy_k8s.sh portal-service</span></span>
<span class="line"></span></code></pre></div><h4 id="_5-2-4-\u5347\u7EA7k8s\u96C6\u7FA4\u4E2D\u7684protal\u5FAE\u670D\u52A1" tabindex="-1">5.2.4.\u5347\u7EA7K8S\u96C6\u7FA4\u4E2D\u7684Protal\u5FAE\u670D\u52A1 <a class="header-anchor" href="#_5-2-4-\u5347\u7EA7k8s\u96C6\u7FA4\u4E2D\u7684protal\u5FAE\u670D\u52A1" aria-hidden="true">#</a></h4><div class="language-sh"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@binary-k8s-master1 k8s</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> kubectl -n simple-ms </span><span style="color:#E0A569;">set</span><span style="color:#DBD7CA;"> image deployment portal portal=192.168.20.11/simple-microservice/portal-service:v1 --record</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@binary-k8s-master1 k8s</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> kubectl -n simple-ms </span><span style="color:#B58451;">set</span><span style="color:#393A34;"> image deployment portal portal=192.168.20.11/simple-microservice/portal-service:v1 --record</span></span>
<span class="line"></span></code></pre></div><p>\u7A0B\u5E8F\u66F4\u65B0\u5B8C\u6210\u540E\u5237\u65B0\u9875\u9762\u5C31\u53EF\u4EE5\u770B\u5230\u6211\u4EEC\u66F4\u65B0\u7684\u9875\u9762\u5185\u5BB9</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/others/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASmlhbmd4bH4=,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="\u5728\u8FD9\u91CC\u63D2\u5165\u56FE\u7247\u63CF\u8FF0"></p>`,286),e=[o];function c(r,t,y,i,A,D){return n(),a("div",null,e)}var C=s(l,[["render",c]]);export{d as __pageData,C as default};
