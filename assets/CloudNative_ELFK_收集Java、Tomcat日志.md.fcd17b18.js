import{_ as s,o as a,c as o,a as n}from"./app.1e6146c3.js";const B=JSON.parse('{"title":"\u6536\u96C6Java\u3001Tomcat\u65E5\u5FD7","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u901A\u8FC7 Logstash \u6536\u96C6 Tomcat \u65E5\u5FD7","slug":"\u901A\u8FC7-logstash-\u6536\u96C6-tomcat-\u65E5\u5FD7"},{"level":3,"title":"\u9884\u5148\u51C6\u5907","slug":"\u9884\u5148\u51C6\u5907"},{"level":3,"title":"\u6536\u96C6 tomcat \u65E5\u5FD7","slug":"\u6536\u96C6-tomcat-\u65E5\u5FD7"},{"level":2,"title":"\u65E5\u5FD7\u5408\u5E76-Multiline codec plugin","slug":"\u65E5\u5FD7\u5408\u5E76-multiline-codec-plugin"},{"level":2,"title":"\u53C2\u8003\u94FE\u63A5","slug":"\u53C2\u8003\u94FE\u63A5"}],"relativePath":"CloudNative/ELFK/\u6536\u96C6Java\u3001Tomcat\u65E5\u5FD7.md","lastUpdated":1657272051000}'),l={name:"CloudNative/ELFK/\u6536\u96C6Java\u3001Tomcat\u65E5\u5FD7.md"},p=n(`<h1 id="\u6536\u96C6java\u3001tomcat\u65E5\u5FD7" tabindex="-1">\u6536\u96C6Java\u3001Tomcat\u65E5\u5FD7 <a class="header-anchor" href="#\u6536\u96C6java\u3001tomcat\u65E5\u5FD7" aria-hidden="true">#</a></h1><h2 id="\u901A\u8FC7-logstash-\u6536\u96C6-tomcat-\u65E5\u5FD7" tabindex="-1">\u901A\u8FC7 Logstash \u6536\u96C6 Tomcat \u65E5\u5FD7 <a class="header-anchor" href="#\u901A\u8FC7-logstash-\u6536\u96C6-tomcat-\u65E5\u5FD7" aria-hidden="true">#</a></h2><h3 id="\u9884\u5148\u51C6\u5907" tabindex="-1">\u9884\u5148\u51C6\u5907 <a class="header-anchor" href="#\u9884\u5148\u51C6\u5907" aria-hidden="true">#</a></h3><p>\u5B89\u88C5\u914D\u7F6E<code>jdk</code>, <code>ELK</code>\u5728\u6B64\u4E0D\u518D\u8D58\u8FF0.</p><p>\u9996\u5148, \u51C6\u5907\u597D\u6D4B\u8BD5\u9875\u9762, \u786E\u4FDD\u6D4B\u8BD5\u9875\u9762\u53EF\u4EE5\u6B63\u5E38\u8BBF\u95EE, \u5728\u8FD9\u91CC\u6211\u51C6\u5907\u597D\u7684\u6D4B\u8BD5\u9875\u9762\u662F <a href="http://192.168.0.126:8080/test/" target="_blank" rel="noopener noreferrer">http://192.168.0.126:8080/test/</a></p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@master apache-tomcat-9.0.34</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> curl 192.168.0.126:8080/test/index.html</span></span>
<span class="line"><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">h</span><span style="color:#CB7676;">1&gt;</span><span style="color:#DBD7CA;">TEST PAGE</span><span style="color:#CB7676;">&lt;</span><span style="color:#DBD7CA;">/h</span><span style="color:#CB7676;">1&gt;</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@master apache-tomcat-9.0.34</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> curl 192.168.0.126:8080/test/index.html</span></span>
<span class="line"><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">h</span><span style="color:#AB5959;">1&gt;</span><span style="color:#393A34;">TEST PAGE</span><span style="color:#AB5959;">&lt;</span><span style="color:#393A34;">/h</span><span style="color:#AB5959;">1&gt;</span></span>
<span class="line"></span></code></pre></div><p>\u4FEE\u6539 tomcat \u7684\u65E5\u5FD7\u683C\u5F0F, \u5C06\u539F\u5148\u9ED8\u8BA4\u7684<code>.txt</code>\u683C\u5F0F\u6539\u4E3A<code>.json</code>\u683C\u5F0F, \u7F16\u8F91<code>/usr/local/apache-tomcat-9.0.34/conf/server.xml</code>:</p><div class="language-xml"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;">&lt;!-- \u5927\u6982\u5728164\u884C\u5DE6\u53F3 --&gt;</span></span>
<span class="line"><span style="color:#DBD7CA;">        </span><span style="color:#858585;">&lt;</span><span style="color:#429988;">Valve</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">className</span><span style="color:#DBD7CA;">=</span><span style="color:#C98A7D;">&quot;org.apache.catalina.valves.AccessLogValve&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">directory</span><span style="color:#DBD7CA;">=</span><span style="color:#C98A7D;">&quot;logs&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">               </span><span style="color:#E0A569;">prefix</span><span style="color:#DBD7CA;">=</span><span style="color:#C98A7D;">&quot;tomcat_access_log&quot;</span><span style="color:#DBD7CA;"> </span><span style="color:#E0A569;">suffix</span><span style="color:#DBD7CA;">=</span><span style="color:#C98A7D;">&quot;.log&quot;</span></span>
<span class="line"><span style="color:#DBD7CA;">               </span><span style="color:#E0A569;">pattern</span><span style="color:#DBD7CA;">=</span><span style="color:#C98A7D;">&quot;{</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">clientip</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%h</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">ClientUser</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%l</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">authenticated</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%u</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">AccessTime</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%t</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">method</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%r</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">status</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%s</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">SendBytes</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%b</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">Query?string</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%q</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">partner</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%{Referer}i</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">,</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">AgentVersion</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">:</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">%{User-Agent}i</span><span style="color:#858585;">&amp;</span><span style="color:#D4976C;">quot</span><span style="color:#858585;">;</span><span style="color:#C98A7D;">}&quot;</span><span style="color:#858585;">/&gt;</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">&lt;!-- \u5927\u6982\u5728164\u884C\u5DE6\u53F3 --&gt;</span></span>
<span class="line"><span style="color:#393A34;">        </span><span style="color:#8E8F8B;">&lt;</span><span style="color:#2F8A89;">Valve</span><span style="color:#393A34;"> </span><span style="color:#B58451;">className</span><span style="color:#393A34;">=</span><span style="color:#B56959;">&quot;org.apache.catalina.valves.AccessLogValve&quot;</span><span style="color:#393A34;"> </span><span style="color:#B58451;">directory</span><span style="color:#393A34;">=</span><span style="color:#B56959;">&quot;logs&quot;</span></span>
<span class="line"><span style="color:#393A34;">               </span><span style="color:#B58451;">prefix</span><span style="color:#393A34;">=</span><span style="color:#B56959;">&quot;tomcat_access_log&quot;</span><span style="color:#393A34;"> </span><span style="color:#B58451;">suffix</span><span style="color:#393A34;">=</span><span style="color:#B56959;">&quot;.log&quot;</span></span>
<span class="line"><span style="color:#393A34;">               </span><span style="color:#B58451;">pattern</span><span style="color:#393A34;">=</span><span style="color:#B56959;">&quot;{</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">clientip</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%h</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">ClientUser</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%l</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">authenticated</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%u</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">AccessTime</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%t</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">method</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%r</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">status</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%s</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">SendBytes</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%b</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">Query?string</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%q</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">partner</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%{Referer}i</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">,</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">AgentVersion</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">:</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">%{User-Agent}i</span><span style="color:#8E8F8B;">&amp;</span><span style="color:#A65E2B;">quot</span><span style="color:#8E8F8B;">;</span><span style="color:#B56959;">}&quot;</span><span style="color:#8E8F8B;">/&gt;</span><span style="color:#393A34;"> </span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u6269\u5C55: <code>&amp;quot;</code>\u8868\u793A\u7684\u662F<code>&quot;</code>\u82F1\u6587\u5F15\u53F7\u7684\u610F\u601D.</p></blockquote><p>\u4FEE\u6539\u5B8C\u914D\u7F6E\u6587\u4EF6\u4E4B\u540E, \u4FDD\u5B58\u9000\u51FA, \u5E76\u91CD\u542F tomcat \u670D\u52A1.</p><p>\u7136\u540E\u5728\u6D4F\u89C8\u5668\u6216\u8005\u4F7F\u7528<code>curl</code>\u547D\u4EE4\u6A21\u62DF\u8BBF\u95EE tomcat \u670D\u52A1, \u4F7F\u4E4B\u4EA7\u751F\u65E5\u5FD7\u6587\u4EF6.</p><p>\u67E5\u770B\u65E5\u5FD7\u6587\u4EF6:</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#858585;">[</span><span style="color:#DBD7CA;">root@master logs</span><span style="color:#858585;">]</span><span style="color:#D4976C;">\\#</span><span style="color:#DBD7CA;"> tail tomcat_access_log.2020-07-09.log</span></span>
<span class="line"><span style="color:#DBD7CA;">{</span><span style="color:#C98A7D;">&quot;clientip&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;192.168.0.125&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;ClientUser&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;authenticated&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AccessTime&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;[09/Jul/2020:09:29:15 -0400]&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;method&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;status&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;304&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;SendBytes&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;Query?string&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;partner&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AgentVersion&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36&quot;</span><span style="color:#DBD7CA;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">{</span><span style="color:#C98A7D;">&quot;clientip&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;192.168.0.125&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;ClientUser&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;authenticated&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AccessTime&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;[09/Jul/2020:09:29:24 -0400]&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;method&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;status&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;200&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;SendBytes&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;19&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;Query?string&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;partner&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AgentVersion&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;curl/7.55.1&quot;</span><span style="color:#DBD7CA;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">{</span><span style="color:#C98A7D;">&quot;clientip&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;192.168.0.125&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;ClientUser&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;authenticated&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AccessTime&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;[09/Jul/2020:09:29:24 -0400]&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;method&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;status&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;200&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;SendBytes&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;19&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;Query?string&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;partner&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AgentVersion&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;curl/7.55.1&quot;</span><span style="color:#DBD7CA;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">{</span><span style="color:#C98A7D;">&quot;clientip&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;192.168.0.125&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;ClientUser&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;authenticated&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AccessTime&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;[09/Jul/2020:09:29:27 -0400]&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;method&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;GET /test/fsdsd HTTP/1.1&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;status&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;404&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;SendBytes&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;723&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;Query?string&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;partner&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;-&quot;</span><span style="color:#DBD7CA;">,</span><span style="color:#C98A7D;">&quot;AgentVersion&quot;</span><span style="color:#DBD7CA;">:</span><span style="color:#C98A7D;">&quot;curl/7.55.1&quot;</span><span style="color:#DBD7CA;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">...</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#8E8F8B;">[</span><span style="color:#393A34;">root@master logs</span><span style="color:#8E8F8B;">]</span><span style="color:#A65E2B;">\\#</span><span style="color:#393A34;"> tail tomcat_access_log.2020-07-09.log</span></span>
<span class="line"><span style="color:#393A34;">{</span><span style="color:#B56959;">&quot;clientip&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;192.168.0.125&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;ClientUser&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;authenticated&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AccessTime&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;[09/Jul/2020:09:29:15 -0400]&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;method&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;status&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;304&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;SendBytes&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;Query?string&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;partner&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AgentVersion&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.106 Safari/537.36&quot;</span><span style="color:#393A34;">}</span></span>
<span class="line"><span style="color:#393A34;">{</span><span style="color:#B56959;">&quot;clientip&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;192.168.0.125&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;ClientUser&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;authenticated&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AccessTime&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;[09/Jul/2020:09:29:24 -0400]&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;method&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;status&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;200&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;SendBytes&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;19&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;Query?string&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;partner&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AgentVersion&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;curl/7.55.1&quot;</span><span style="color:#393A34;">}</span></span>
<span class="line"><span style="color:#393A34;">{</span><span style="color:#B56959;">&quot;clientip&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;192.168.0.125&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;ClientUser&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;authenticated&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AccessTime&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;[09/Jul/2020:09:29:24 -0400]&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;method&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;GET /test/ HTTP/1.1&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;status&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;200&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;SendBytes&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;19&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;Query?string&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;partner&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AgentVersion&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;curl/7.55.1&quot;</span><span style="color:#393A34;">}</span></span>
<span class="line"><span style="color:#393A34;">{</span><span style="color:#B56959;">&quot;clientip&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;192.168.0.125&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;ClientUser&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;authenticated&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AccessTime&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;[09/Jul/2020:09:29:27 -0400]&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;method&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;GET /test/fsdsd HTTP/1.1&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;status&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;404&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;SendBytes&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;723&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;Query?string&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;partner&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;-&quot;</span><span style="color:#393A34;">,</span><span style="color:#B56959;">&quot;AgentVersion&quot;</span><span style="color:#393A34;">:</span><span style="color:#B56959;">&quot;curl/7.55.1&quot;</span><span style="color:#393A34;">}</span></span>
<span class="line"><span style="color:#393A34;">...</span></span>
<span class="line"></span></code></pre></div><h3 id="\u6536\u96C6-tomcat-\u65E5\u5FD7" tabindex="-1">\u6536\u96C6 tomcat \u65E5\u5FD7 <a class="header-anchor" href="#\u6536\u96C6-tomcat-\u65E5\u5FD7" aria-hidden="true">#</a></h3><p>\u7F16\u8F91<code>logstash</code>\u7684 tomcat \u65E5\u5FD7\u6536\u96C6\u914D\u7F6E\u6587\u4EF6<code>config/java_tomcat.conf</code>, \u5185\u5BB9\u5927\u81F4\u5982\u4E0B:</p><div class="language-"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#dbd7ca;">input {</span></span>
<span class="line"><span style="color:#dbd7ca;">  file {</span></span>
<span class="line"><span style="color:#dbd7ca;">   path =&gt; &quot;/usr/local/logstash-7.7.1/logs/logstash-plain.log&quot;  #\u6536\u96C6java\u7684\u65E5\u5FD7\u6587\u4EF6\u76EE\u5F55</span></span>
<span class="line"><span style="color:#dbd7ca;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   stat_interval =&gt; 3</span></span>
<span class="line"><span style="color:#dbd7ca;">   type =&gt; &quot;java-log&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">  }</span></span>
<span class="line"><span style="color:#dbd7ca;"> </span></span>
<span class="line"><span style="color:#dbd7ca;">  file {</span></span>
<span class="line"><span style="color:#dbd7ca;">   path =&gt; &quot;/usr/local/apache-tomcat-9.0.34/logs/tomcat_access_log.*.log&quot;  # \u6536\u96C6tomcat\u65E5\u5FD7\u7684\u6587\u4EF6\u76EE\u5F55</span></span>
<span class="line"><span style="color:#dbd7ca;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   stat_interval =&gt; 3</span></span>
<span class="line"><span style="color:#dbd7ca;">   type =&gt; &quot;tomcat-access-log&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   codec =&gt; &quot;json&quot;  # \u8F93\u51FAtomcat \u7684json\u65E5\u5FD7\u683C\u5F0F</span></span>
<span class="line"><span style="color:#dbd7ca;">  }</span></span>
<span class="line"><span style="color:#dbd7ca;">}</span></span>
<span class="line"><span style="color:#dbd7ca;"> </span></span>
<span class="line"><span style="color:#dbd7ca;">output {</span></span>
<span class="line"><span style="color:#dbd7ca;">  if [type] == &quot;java-log&quot; {</span></span>
<span class="line"><span style="color:#dbd7ca;">   elasticsearch {</span></span>
<span class="line"><span style="color:#dbd7ca;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#dbd7ca;">   index =&gt; &quot;javalog-7-102-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   }</span></span>
<span class="line"><span style="color:#dbd7ca;">  }</span></span>
<span class="line"><span style="color:#dbd7ca;"> </span></span>
<span class="line"><span style="color:#dbd7ca;">  if [type] == &quot;tomcat-access-log&quot; {</span></span>
<span class="line"><span style="color:#dbd7ca;">   elasticsearch {</span></span>
<span class="line"><span style="color:#dbd7ca;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#dbd7ca;">   index =&gt; &quot;tomcat-access-log-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   }</span></span>
<span class="line"><span style="color:#dbd7ca;">  }</span></span>
<span class="line"><span style="color:#dbd7ca;">}</span></span>
<span class="line"><span style="color:#dbd7ca;"></span></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393a34;">input {</span></span>
<span class="line"><span style="color:#393a34;">  file {</span></span>
<span class="line"><span style="color:#393a34;">   path =&gt; &quot;/usr/local/logstash-7.7.1/logs/logstash-plain.log&quot;  #\u6536\u96C6java\u7684\u65E5\u5FD7\u6587\u4EF6\u76EE\u5F55</span></span>
<span class="line"><span style="color:#393a34;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#393a34;">   stat_interval =&gt; 3</span></span>
<span class="line"><span style="color:#393a34;">   type =&gt; &quot;java-log&quot;</span></span>
<span class="line"><span style="color:#393a34;">  }</span></span>
<span class="line"><span style="color:#393a34;"> </span></span>
<span class="line"><span style="color:#393a34;">  file {</span></span>
<span class="line"><span style="color:#393a34;">   path =&gt; &quot;/usr/local/apache-tomcat-9.0.34/logs/tomcat_access_log.*.log&quot;  # \u6536\u96C6tomcat\u65E5\u5FD7\u7684\u6587\u4EF6\u76EE\u5F55</span></span>
<span class="line"><span style="color:#393a34;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#393a34;">   stat_interval =&gt; 3</span></span>
<span class="line"><span style="color:#393a34;">   type =&gt; &quot;tomcat-access-log&quot;</span></span>
<span class="line"><span style="color:#393a34;">   codec =&gt; &quot;json&quot;  # \u8F93\u51FAtomcat \u7684json\u65E5\u5FD7\u683C\u5F0F</span></span>
<span class="line"><span style="color:#393a34;">  }</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;"> </span></span>
<span class="line"><span style="color:#393a34;">output {</span></span>
<span class="line"><span style="color:#393a34;">  if [type] == &quot;java-log&quot; {</span></span>
<span class="line"><span style="color:#393a34;">   elasticsearch {</span></span>
<span class="line"><span style="color:#393a34;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#393a34;">   index =&gt; &quot;javalog-7-102-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#393a34;">   }</span></span>
<span class="line"><span style="color:#393a34;">  }</span></span>
<span class="line"><span style="color:#393a34;"> </span></span>
<span class="line"><span style="color:#393a34;">  if [type] == &quot;tomcat-access-log&quot; {</span></span>
<span class="line"><span style="color:#393a34;">   elasticsearch {</span></span>
<span class="line"><span style="color:#393a34;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#393a34;">   index =&gt; &quot;tomcat-access-log-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#393a34;">   }</span></span>
<span class="line"><span style="color:#393a34;">  }</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;"></span></span></code></pre></div><p>\u542F\u52A8<code>logstash</code>:</p><div class="language-bash"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#DBD7CA;">bin/logstash -f config/java_tomcat.conf</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393A34;">bin/logstash -f config/java_tomcat.conf</span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u8FC7\u7A0B\u4E2D\u9047\u5230\u7684\u95EE\u9898: <code>logstash</code>\u65E0\u6CD5\u52A0\u8F7D\u5230<code>tomcat</code>\u7684\u65E5\u5FD7, \u539F\u56E0\u662F\u5982\u679C\u8FD0\u884C<code>logstash</code>\u7684\u7528\u6237\u4E3A\u666E\u901A\u7528\u6237, \u5219\u53EF\u80FD\u4F1A\u56E0\u4E3A\u6743\u9650\u95EE\u9898\u65E0\u6CD5\u8BBF\u95EE\u5230<code>tomcat</code>\u7684\u65E5\u5FD7, \u5728\u6B64\u9700\u8981\u7279\u522B\u6CE8\u610F.</p></blockquote><p>\u6253\u5F00\u6D4F\u89C8\u5668\u8BBF\u95EElogstash\u7684web\u7BA1\u7406\u9875\u9762, \u627E\u5230\u4EE5\u4E0B\u9875\u9762, \u5E76\u6DFB\u52A0\u4E00\u4E2A\u7D22\u5F15:</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/elk%20stack/log/java-tomcat-log-1.png" alt="" title="\u6DFB\u52A0\u7D22\u5F15"></p><p>\u968F\u540E\u6253\u5F00<code>Dashboard</code>\u8FDB\u884C\u67E5\u770B:</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/elk%20stack/log/java-tomcat-log-2.png" alt="" title="\u67E5\u770B"></p><p>\u5728<code>elasticsearch</code>\u7684web\u9762\u677F\u4E2D\u67E5\u770B:</p><p><img src="https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/elk%20stack/log/java-tomcat-log-3.png" alt="" title="es \u4E2D\u67E5\u770B"></p><h2 id="\u65E5\u5FD7\u5408\u5E76-multiline-codec-plugin" tabindex="-1">\u65E5\u5FD7\u5408\u5E76-Multiline codec plugin <a class="header-anchor" href="#\u65E5\u5FD7\u5408\u5E76-multiline-codec-plugin" aria-hidden="true">#</a></h2><p>\u672C\u7F16\u89E3\u7801\u5668\u7684\u6700\u521D\u76EE\u6807\u662F\u5141\u8BB8\u52A0\u5165\u591A\u884C\u6D88\u606F\u4ECE\u6587\u4EF6\u5230\u4E00\u4E2A\u5355\u72EC\u7684\u4E8B\u4EF6\u3002</p><p>\u793A\u4F8B<code>java</code>\u65E5\u5FD7\u914D\u7F6E\u6587\u4EF6(\u90E8\u5206):</p><div class="language-"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#dbd7ca;">input {</span></span>
<span class="line"><span style="color:#dbd7ca;">  file {</span></span>
<span class="line"><span style="color:#dbd7ca;">   path =&gt; &quot;/usr/local/logstash-7.7.1/logs/logstash-plain.log&quot;  # \u8981\u91C7\u96C6\u7684log\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#dbd7ca;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">      codec =&gt; multiline {</span></span>
<span class="line"><span style="color:#dbd7ca;">             pattern =&gt; &quot;^\\[&quot;  # \u4EE5[\u5F00\u5934\u5F00\u59CB\u5339\u914D</span></span>
<span class="line"><span style="color:#dbd7ca;">             negate =&gt; true</span></span>
<span class="line"><span style="color:#dbd7ca;">             what =&gt; &quot;previous&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">      }</span></span>
<span class="line"><span style="color:#dbd7ca;">   }</span></span>
<span class="line"><span style="color:#dbd7ca;">}</span></span>
<span class="line"><span style="color:#dbd7ca;">output {</span></span>
<span class="line"><span style="color:#dbd7ca;">   elasticsearch {</span></span>
<span class="line"><span style="color:#dbd7ca;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#dbd7ca;">   index =&gt; &quot;javalog-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#dbd7ca;">   }</span></span>
<span class="line"><span style="color:#dbd7ca;">  }</span></span>
<span class="line"><span style="color:#dbd7ca;"></span></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#393a34;">input {</span></span>
<span class="line"><span style="color:#393a34;">  file {</span></span>
<span class="line"><span style="color:#393a34;">   path =&gt; &quot;/usr/local/logstash-7.7.1/logs/logstash-plain.log&quot;  # \u8981\u91C7\u96C6\u7684log\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#393a34;">   start_position =&gt; &quot;beginning&quot;</span></span>
<span class="line"><span style="color:#393a34;">      codec =&gt; multiline {</span></span>
<span class="line"><span style="color:#393a34;">             pattern =&gt; &quot;^\\[&quot;  # \u4EE5[\u5F00\u5934\u5F00\u59CB\u5339\u914D</span></span>
<span class="line"><span style="color:#393a34;">             negate =&gt; true</span></span>
<span class="line"><span style="color:#393a34;">             what =&gt; &quot;previous&quot;</span></span>
<span class="line"><span style="color:#393a34;">      }</span></span>
<span class="line"><span style="color:#393a34;">   }</span></span>
<span class="line"><span style="color:#393a34;">}</span></span>
<span class="line"><span style="color:#393a34;">output {</span></span>
<span class="line"><span style="color:#393a34;">   elasticsearch {</span></span>
<span class="line"><span style="color:#393a34;">   hosts =&gt; [&quot;192.168.0.126:9200&quot;]</span></span>
<span class="line"><span style="color:#393a34;">   index =&gt; &quot;javalog-%{+YYYY.MM.dd}&quot;</span></span>
<span class="line"><span style="color:#393a34;">   }</span></span>
<span class="line"><span style="color:#393a34;">  }</span></span>
<span class="line"><span style="color:#393a34;"></span></span></code></pre></div><h2 id="\u53C2\u8003\u94FE\u63A5" tabindex="-1">\u53C2\u8003\u94FE\u63A5 <a class="header-anchor" href="#\u53C2\u8003\u94FE\u63A5" aria-hidden="true">#</a></h2><ul><li>codecs-multiline Documentations: <a href="https://www.elastic.co/guide/en/logstash/current/plugins-codecs-multiline.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/logstash/current/plugins-codecs-multiline.html</a></li></ul>`,31),t=[p];function e(c,r,y,u,q,A){return a(),o("div",null,t)}var D=s(l,[["render",e]]);export{B as __pageData,D as default};
